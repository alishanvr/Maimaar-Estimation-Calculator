(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55225,25898,e=>{"use strict";var t=e.i(95003);function s(e,t=2){return null==e?"—":e.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t})}function r(e,t,a,i=2){return null==e?"—":s(e*t,i)+" "+a}function a(e,t,r,i=2){return null==e?"—":s(e*t,i)+" "+r+"/MT"}function i(e,t=2){return s(e,t)+"%"}function l(){let{branding:e}=(0,t.useBranding)(),{display_currency:s,currency_symbol:i,exchange_rate:l}=e;return{currency:s,symbol:i,rate:l,convert:e=>e*l,format:(e,t=2)=>r(e,l,i,t),formatPerMT:(e,t=2)=>a(e,l,i,t),label:e=>`${e} (${i})`}}e.s(["formatCurrency",()=>r,"formatCurrencyPerMT",()=>a,"formatNumber",()=>s,"formatPct",()=>i],25898),e.s(["useCurrency",()=>l],55225)},1816,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(22016),i=e.i(40665),l=e.i(55225);let n={draft:"bg-gray-100 text-gray-700",calculated:"bg-green-100 text-green-700",finalized:"bg-primary/15 text-primary"};function d(){let e=(0,r.useSearchParams)().get("ids"),d=e?e.split(",").map(Number):[],{symbol:c}=(0,l.useCurrency)(),m=(0,s.useMemo)(()=>[{label:"Total Weight",key:"total_weight_mt",decimals:2,unit:"MT",getValue:e=>e.total_weight_mt},{label:"Total Price",key:"total_price_aed",decimals:0,unit:c,getValue:e=>e.total_price_aed},{label:"Price / MT",key:"price_per_mt",decimals:2,unit:c,getValue:e=>e.summary?.price_per_mt??null},{label:"FOB Price",key:"fob_price",decimals:0,unit:c,getValue:e=>e.summary?.fob_price_aed??null},{label:"Steel Weight",key:"steel_weight_kg",decimals:0,unit:"kg",getValue:e=>e.summary?.steel_weight_kg??null},{label:"Panels Weight",key:"panels_weight_kg",decimals:0,unit:"kg",getValue:e=>e.summary?.panels_weight_kg??null}],[c]),[x,o]=(0,s.useState)([]),[u,g]=(0,s.useState)(!0),[h,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(2!==d.length){p("Please select exactly 2 estimations to compare."),g(!1);return}(0,i.compareEstimations)(d).then(o).catch(e=>{p(e?.response?.data?.message||"Failed to load comparison data.")}).finally(()=>g(!1))},[e]);let y=(e,t=2)=>null==e?"—":e.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t});if(u)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("p",{className:"text-gray-400",children:"Loading comparison..."})});if(h)return(0,t.jsxs)("div",{className:"max-w-xl mx-auto mt-12 text-center",children:[(0,t.jsx)("div",{className:"bg-red-50 text-red-700 rounded-lg p-4 border border-red-200 mb-4",children:h}),(0,t.jsx)(a.default,{href:"/estimations",className:"text-primary hover:underline text-sm",children:"← Back to Estimations"})]});let[f,b]=x,j=(()=>{if(x.length<2)return[];let e=x[0].input_data||{},t=x[1].input_data||{},s=new Set([...Object.keys(e),...Object.keys(t)]),r=[];for(let a of s)JSON.stringify(e[a])!==JSON.stringify(t[a])&&r.push(a);return r.sort()})();return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(a.default,{href:"/estimations",className:"text-gray-400 hover:text-gray-600 transition text-sm",children:"← Back to Estimations"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mt-1",children:"Estimation Comparison"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,t.jsx)("div",{className:"col-span-1"}),[f,b].map((e,s)=>(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:["Estimation ",s+1]}),(0,t.jsx)("span",{className:`inline-block px-2 py-0.5 rounded-full text-[10px] font-medium ${n[e.status]}`,children:e.status})]}),(0,t.jsx)("p",{className:"font-mono text-sm font-medium text-gray-900",children:e.quote_number||"—"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.building_name||"Untitled"}),e.revision_no&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Rev: ",e.revision_no]})]},e.id))]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6",children:[(0,t.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Key Metrics"})}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left px-4 py-2 font-medium text-gray-500",children:"Metric"}),(0,t.jsx)("th",{className:"text-right px-4 py-2 font-medium text-gray-500",children:f.quote_number||`#${f.id}`}),(0,t.jsx)("th",{className:"text-right px-4 py-2 font-medium text-gray-500",children:b.quote_number||`#${b.id}`}),(0,t.jsx)("th",{className:"text-right px-4 py-2 font-medium text-gray-500",children:"Delta"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-100",children:m.map(e=>{let s=e.getValue(f),r=e.getValue(b),a=((e,t)=>{if(null===e||null===t)return{value:null,pct:null};let s=t-e;return{value:s,pct:0!==e?s/e*100:null}})(s,r);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-4 py-2 font-medium text-gray-700",children:e.label}),(0,t.jsxs)("td",{className:"px-4 py-2 text-right font-mono text-xs",children:[y(s,e.decimals)," ",e.unit]}),(0,t.jsxs)("td",{className:"px-4 py-2 text-right font-mono text-xs",children:[y(r,e.decimals)," ",e.unit]}),(0,t.jsx)("td",{className:"px-4 py-2 text-right font-mono text-xs",children:null!==a.value?(0,t.jsxs)("span",{className:a.value>0?"text-red-600":a.value<0?"text-green-600":"text-gray-400",children:[a.value>0?"+":"",y(a.value,e.decimals),null!==a.pct&&(0,t.jsxs)("span",{className:"ml-1 text-[10px]",children:["(",a.pct>0?"+":"",a.pct.toFixed(1),"%)"]})]}):"—"})]},e.key)})})]})]}),j.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("h3",{className:"font-medium text-gray-900",children:["Input Differences (",j.length,")"]})}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,t.jsx)("th",{className:"text-left px-4 py-2 font-medium text-gray-500",children:"Field"}),(0,t.jsx)("th",{className:"text-right px-4 py-2 font-medium text-gray-500",children:f.quote_number||`#${f.id}`}),(0,t.jsx)("th",{className:"text-right px-4 py-2 font-medium text-gray-500",children:b.quote_number||`#${b.id}`})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-100",children:j.map(e=>{let s=f.input_data?.[e],r=b.input_data?.[e],a=e=>null==e?"—":"object"==typeof e?JSON.stringify(e):String(e);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-4 py-2 font-mono text-xs text-gray-700",children:e}),(0,t.jsx)("td",{className:"px-4 py-2 text-right text-xs text-gray-600",children:a(s)}),(0,t.jsx)("td",{className:"px-4 py-2 text-right text-xs text-gray-600",children:a(r)})]},e)})})]})]}),0===j.length&&(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center text-gray-400",children:"No input differences found between these estimations."})]})}e.s(["default",()=>d])}]);