olevba 0.60.2 on Python 3.9.1 - http://decalage.info/python/oletools
===============================================================================
FILE: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO frmProgressBar.vba 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/frmProgressBar'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Activate()
    Call CreateReport
End Sub


-------------------------------------------------------------------------------
VBA MACRO UserForm1.vba 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub btnEnter_Click()
    UserForm1.Hide
    If Active = True Then
        Sheet1.Visible = xlSheetVisible
        Sheet2.Visible = xlSheetVisible
        Sheet3.Visible = xlSheetVisible
        Sheet4.Visible = xlSheetVisible
        Sheet6.Visible = xlSheetVisible
        Sheet7.Visible = xlSheetVisible
        Sheet8.Visible = xlSheetVisible
        Sheet9.Visible = xlSheetVisible
        Sheet10.Visible = xlSheetVisible
        Sheet11.Visible = xlSheetVisible
        Sheet12.Visible = xlSheetVisible
        Sheet13.Visible = xlSheetVisible
        Sheet14.Visible = xlSheetHidden
        Sheet1.Activate
    Else
        Call Get_Environmental_Variable
        ActivationDetails.txtAuthorizationCode.Text = A
        ActivationDetails.txtUserName.Text = sUserName
        ActivationDetails.txtDepartment = sHostName2
        ActivationDetails.Show
    End If
End Sub

Private Sub UserForm_Activate()
    Label7.Caption = Sheet11.Range("J1").Value
End Sub

Private Sub UserForm_Terminate()
    If Active = False Then
        'close the workbook without saving
        ThisWorkbook.Close SaveChanges:=True
    End If
End Sub



 


-------------------------------------------------------------------------------
VBA MACRO ShippingLoad.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/ShippingLoad'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Formatting.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Formatting'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Renumbers the item column in the "Detail" sheet
Sub RenumberItems(ByVal Target As Range)

'    For Each Cells In Sheet2.Rows
'    '[ statements ]
'    '[ Continue For ]
'    '[ statements ]
'    '[ Exit For ]
'    '[ statements ]
'    Next [ element ]


'    Do
'
'    Loop Until Sheet2.Range.Name = "ItemMark"


'
'    Do While IsEmpty(ActiveCell.Offset(0, 1)) = False
'
'    ActiveCell.FormulaR1C1 = "=Average(RC[-1],RC[-2])"
'
'    ActiveCell.Offset(1, 0).Select
'
'    Loop
'
'    Sheet2.Range("ItemMark").Offset(-1, 0) = Sheet2.Range("ItemMark").Offset(-2, 0) + 1

End Sub

'This is a procedure that adds formatting to the newly created table
Sub FormatCells()
    'Worksheets("RawMat").Activate
    
    Worksheets("RawMat").Columns("A:B").HorizontalAlignment = xlLeft
    
    Worksheets("RawMat").Columns("D:G").HorizontalAlignment = xlCenter
    
    Worksheets("RawMat").Rows("11:11").HorizontalAlignment = xlCenter
    Worksheets("RawMat").Rows("11:11").VerticalAlignment = xlCenter
    Worksheets("RawMat").Rows("11:11").Font.Bold = True
        
    Call FormatSheet
      
    Worksheets("RawMat").Columns("A:A").ColumnWidth = 9.43
    Worksheets("RawMat").Columns("B:B").ColumnWidth = 8.43
    Worksheets("RawMat").Columns("C:C").ColumnWidth = 58.43
    Worksheets("RawMat").Columns("D:D").ColumnWidth = 4.29
    Worksheets("RawMat").Columns("E:E").ColumnWidth = 12.57
    Worksheets("RawMat").Columns("F:F").ColumnWidth = 12.29
    Worksheets("RawMat").Columns("G:G").ColumnWidth = 8.43
    
    Worksheets("RawMat").Range("C:C").Columns.AutoFit
    
    Worksheets("RawMat").Rows("1:1").RowHeight = 18
    Worksheets("RawMat").Range("A1:G1").HorizontalAlignment = xlCenter
    Worksheets("RawMat").Range("A1:G1").VerticalAlignment = xlCenter
    Worksheets("RawMat").Range("A1:G1").Merge
    Worksheets("RawMat").Range("A1:G1").Font.Bold = True
    Worksheets("RawMat").Range("A1:G1").Font.Name = "Arial"
    Worksheets("RawMat").Range("A1:G1").Font.Size = 14

End Sub

Sub FormatPUTable()
    
    Worksheets("RawMat").Activate
    
    Range("J12:L12").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With
    Selection.Merge
    Range("J13:L13").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 5
    Range("J14:J29").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With
    Range("K14:L29").Select
    Selection.NumberFormat = "0.000"
    Range("L14:L29").Select
    Selection.NumberFormat = "0.00"
    Range("J12:L29").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Range("J12:L12").Select
    Selection.Font.Bold = True
    With Selection.Interior
        .ColorIndex = 6
        .Pattern = xlSolid
    End With
    
    Range("K29:L29,K27:L27,K25:L25").Select
    Range("K25").Activate
    With Selection.Interior
        .ColorIndex = 34
        .Pattern = xlSolid
    End With
    
    
End Sub

Sub FormatSheet()
    Worksheets("RawMat").Activate
    
    Columns("E:F").Select
    Range("E2").Activate
    With Selection
        .HorizontalAlignment = xlRight
    End With
    Columns("E:E").Select
    Range("E2").Activate
    Selection.NumberFormat = "#,##0.00"
    Columns("F:F").Select
    Range("F2").Activate
    Selection.NumberFormat = "#,##0"
    Range("B2:F7").Select
    Selection.Font.Bold = True
    Range("B2:B5,E2:E7").Select
    Range("E2").Activate
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
    End With
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlBottom
    End With
    Range("C2:C5,F2:F5").Select
    Range("F2").Activate
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
    End With
    Selection.Font.ColorIndex = 5
    Selection.Font.Italic = True
    Range("F6:F7").Select
    Selection.Font.ColorIndex = 3
    Range("C2,F7").Select
    Range("F7").Activate
    Selection.NumberFormat = "m/d/yyyy"
    Range("C8").Select
    With Selection.Font
        .Name = "Arial"
        .Size = 8
    End With
    Selection.Font.ColorIndex = 50
    Rows("9:9").Select
    Selection.RowHeight = 25.5
    Range("A9:G9").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    Range("A2:G7").Select
    With Selection.Interior
        .ColorIndex = 34
        .Pattern = xlSolid
    End With
    Range("A2:B5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("C2:C5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("D2:E5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F2:G5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("A6:G7").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("A9:G10").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    
    Range("A9:G10").Borders(xlInsideVertical).LineStyle = xlContinuous
    Range("A9:G10").Borders(xlInsideVertical).weight = xlThin
    Range("A9:G10").Borders(xlInsideVertical).ColorIndex = xlAutomatic
    Range("A9:G10").Borders(xlInsideHorizontal).LineStyle = xlContinuous
    Range("A9:G10").Borders(xlInsideHorizontal).weight = xlThin
    Range("A9:G10").Borders(xlInsideHorizontal).ColorIndex = xlAutomatic
    Range("A11:G11").Borders(xlEdgeLeft).LineStyle = xlContinuous
    Range("A11:G11").Borders(xlEdgeLeft).weight = xlThin
    Range("A11:G11").Borders(xlEdgeLeft).ColorIndex = xlAutomatic
    Range("A11:G11").Borders(xlEdgeTop).LineStyle = xlContinuous
    Range("A11:G11").Borders(xlEdgeTop).weight = xlThin
    Range("A11:G11").Borders(xlEdgeTop).ColorIndex = xlAutomatic
    Range("A11:G11").Borders(xlEdgeBottom).LineStyle = xlContinuous
    Range("A11:G11").Borders(xlEdgeBottom).weight = xlHairline
    Range("A11:G11").Borders(xlEdgeBottom).ColorIndex = xlAutomatic
    Range("A11:G11").Borders(xlEdgeRight).LineStyle = xlContinuous
    Range("A11:G11").Borders(xlEdgeRight).weight = xlThin
    Range("A11:G11").Borders(xlEdgeRight).ColorIndex = xlAutomatic
    Range("A11:G11").Borders(xlInsideVertical).LineStyle = xlContinuous
    Range("A11:G11").Borders(xlInsideVertical).weight = xlThin
    Range("A11:G11").Borders(xlInsideVertical).ColorIndex = xlAutomatic
    
    Range("F6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With
    Range("F7").Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
    End With
End Sub

Sub FormatSummaryRows(rowNumber As Integer)
    
    Worksheets("RawMat").Activate
    
    Range("C" + CStr(rowNumber + 2)).Font.Bold = True
    Range("C" + CStr(rowNumber + 2)).Font.Size = 12
    Range("F" + CStr(rowNumber + 2)).Font.Bold = True
    Range("F" + CStr(rowNumber + 2)).Font.Size = 12
    Range("C" + CStr(rowNumber + 4)).Font.Bold = True
    Range("F" + CStr(rowNumber + 4)).Font.Bold = True
    Range("C" + CStr(rowNumber + 2)).HorizontalAlignment = xlRight
    Range("C" + CStr(rowNumber + 4)).HorizontalAlignment = xlRight
    Range("A" + CStr(rowNumber + 2) + ":G" + CStr(rowNumber + 2)).Borders(xlEdgeTop).LineStyle = xlContinuous
    Range("A" + CStr(rowNumber + 2) + ":G" + CStr(rowNumber + 2)).Borders(xlEdgeTop).weight = xlThin
    Range("A" + CStr(rowNumber + 2) + ":G" + CStr(rowNumber + 2)).Borders(xlEdgeTop).ColorIndex = xlAutomatic
    Range("A" + CStr(rowNumber + 2) + ":G" + CStr(rowNumber + 2)).Borders(xlEdgeBottom).LineStyle = xlDouble
    Range("A" + CStr(rowNumber + 2) + ":G" + CStr(rowNumber + 2)).Borders(xlEdgeBottom).weight = xlThick
    Range("A" + CStr(rowNumber + 2) + ":G" + CStr(rowNumber + 2)).Borders(xlEdgeBottom).ColorIndex = xlAutomatic

End Sub

-------------------------------------------------------------------------------
VBA MACRO GenerateReport.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/GenerateReport'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Text Comparison(Case insensitive comparison)
Option Compare Text

'Created by: Hezron Arandela
'Date Created: February 11, 2010
'Description: Creates a RawMat sheet table on new workbook

Public noData As Boolean
Public wsht As Worksheet
Public wt As Double

Sub AddPhaseNumber()

    Dim rowNumber As Integer
    Dim address As String, cellValue As String, erpCode As String
    Dim myRange As Range
    
    rowNumber = 10
  
    Set myRange = Worksheets("MBSDB").Range("MakDB_PN")
    
    Do
        
        'look for the corresponding phase number from "MAKDB" sheet
        rowNumber = rowNumber + 1
        address = Worksheets("RawMat").Cells(rowNumber, 1).Text
        If address <> "" Then
            erpCode = Application.WorksheetFunction.VLookup(address, myRange, 18, False)
            Worksheets("RawMat").Cells(rowNumber, 8) = erpCode
        End If
    
    Loop Until address = ""
    
    Worksheets("RawMat").Columns("H").AutoFit
    
End Sub

'This is a procedure that checks for the blank entry in "Detail" sheet at column T
Sub CheckBlankEntry()

    Dim cellValue As Variant
    Dim rowNumber As Integer
    rowNumber = 12
    
    'Get the last row in the "sheet2PhaseNumber" range from "Detail" sheet
    lastRow = Sheet2.Range("sheet2PhaseNumber").Rows.Count
        
    'Check whether there's a value to display. If there is none, then
    'alert the user to provide some value
    Do
        'Store the cell value on a variable
        cellValue = Sheet2.Cells(rowNumber, 20).Text

        'Insert a blank row before item2
        If cellValue = "" Then
            'Get the row number of cell in RawMat sheet
            rowNumber = rowNumber + 1
            If rowNumber = lastRow Then
                MsgBox "Please provide phase number on Detail sheet at column-T to generate the table", _
                                                                                vbExclamation, "QuickEst"
                Exit Sub
            End If
        Else
            Exit Do
        End If
    Loop Until rowNumber >= lastRow
    
'    Call CreateNewFile
    
    'Clear the contents of "RawMat" sheet
    'Worksheets("RawMat").Columns("A:H").Clear
    Worksheets("RawMat").Cells.Clear

    Call CreateRawMatSheet
        
End Sub

Sub CreateRawMatSheet()
    frmProgressBar.Show
End Sub

'This procedure create a report in the new sheet generated and then
'finally calls a procedure that sorts the items on this table generated
Sub CreateReport()
 
    Worksheets("RawMat").Activate
       
    'set the value for CCust dbcode in "DB" sheet
    Worksheets("DB").Range("SSkinLoads").Value = "=(RawMat!L30)/(34.3*35)"
    
    Dim pctCnt As Integer
    Dim Completed1 As Single
    Dim Completed As String
    Application.ScreenUpdating = False
    pctCnt = 1
    
    Dim sheet6RowNumber, rowNumber As Integer
    Dim phaseNumber, quickEstCode, description, unit, totalWeight As Variant
    sheet6RowNumber = 7
    rowNumber = 11
    
    'Write title block
    Worksheets("RawMat").Cells(2, 3) = "=Input!C2"
    Worksheets("RawMat").Cells(3, 3) = "=Input!C3"
    Worksheets("RawMat").Cells(4, 3) = "=Input!C4"
    Worksheets("RawMat").Cells(5, 3) = "=Input!C5"
    Worksheets("RawMat").Cells(8, 3) = "=Input!C7"
    Worksheets("RawMat").Cells(2, 6) = "=Input!E2"
    Worksheets("RawMat").Cells(3, 6) = "=Input!E3"
    Worksheets("RawMat").Cells(4, 6) = "=Input!E4"
    Worksheets("RawMat").Cells(5, 6) = "=Input!E5"
    
    'Write the header in a new table
    Worksheets("RawMat").Cells(1, 1) = "Raw Material List"
    Worksheets("RawMat").Cells(2, 2) = "Date:"
    Worksheets("RawMat").Cells(3, 2) = "Building Name:"
    Worksheets("RawMat").Cells(4, 2) = "Project Name:"
    Worksheets("RawMat").Cells(5, 2) = "Customer Name:"
    
    Worksheets("RawMat").Cells(2, 5) = "Revision No:"
    Worksheets("RawMat").Cells(3, 5) = "Bldg No:"
    Worksheets("RawMat").Cells(4, 5) = "Project No:"
    Worksheets("RawMat").Cells(5, 5) = "By:"
    Worksheets("RawMat").Cells(6, 5) = "Based on Buiding Revision Number: "
    Worksheets("RawMat").Cells(7, 5) = "Building Revision Date: "
    
    Worksheets("RawMat").Cells(9, 1) = "QuickEst Code"
    Worksheets("RawMat").Cells(9, 2) = "ERP Code"
    Worksheets("RawMat").Cells(9, 3) = "Description"
    Worksheets("RawMat").Cells(9, 4) = "Unit"
    Worksheets("RawMat").Cells(9, 5) = "Total Units"
    Worksheets("RawMat").Cells(9, 6) = "Total Weight"
    Worksheets("RawMat").Cells(9, 7) = "Phase Number"
        
    'Insert a table on the new sheet generated
    Do
        'Get the row number of cell in RawMat sheet
        sheet6RowNumber = sheet6RowNumber + 1

        'Get the cell value on each cell
'        PhaseNumber = Sheet2.Cells(sheet6RowNumber, 20).Text
        phaseNumber = Sheet2.Cells(sheet6RowNumber, 20).Text
        quickEstCode = Sheet2.Cells(sheet6RowNumber, 2).Text
        description = Sheet2.Cells(sheet6RowNumber, 5).Text
        unit = Sheet2.Cells(sheet6RowNumber, 7).Text
        
        If unit = "M" Then
            Dim A As Variant
            A = CDbl(Sheet2.Cells(sheet6RowNumber, 6)) * CDbl(Sheet2.Cells(sheet6RowNumber, 8)) 'modified by hezron on 08/18/2010(.text has been removed)
            totalUnit = CStr(A)
'        ElseIf unit = "kg" Then
'            totalUnit = "-"
        Else
            totalUnit = Sheet2.Cells(sheet6RowNumber, 8).Text
        End If
        
        
        totalWeight = Sheet2.Cells(sheet6RowNumber, 11).Text
        
        If quickEstCode <> "" Then  'new
            'If cell is not empty, write the items in a new table
            If phaseNumber <> "" Then
                rowNumber = rowNumber + 1
                Worksheets("RawMat").Cells(rowNumber, 1) = quickEstCode
                Worksheets("RawMat").Cells(rowNumber, 3) = description
                Worksheets("RawMat").Cells(rowNumber, 4) = unit
                Worksheets("RawMat").Cells(rowNumber, 5) = totalUnit
                Worksheets("RawMat").Cells(rowNumber, 6) = totalWeight
                Worksheets("RawMat").Cells(rowNumber, 7) = "'" + phaseNumber
                
                'Draw border around the cells
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeLeft).LineStyle = xlContinuous
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeLeft).weight = xlThin
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeLeft).ColorIndex = xlAutomatic
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeTop).LineStyle = xlContinuous
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeTop).weight = xlHairline
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeTop).ColorIndex = xlAutomatic
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeBottom).LineStyle = xlContinuous
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeBottom).weight = xlHairline
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeBottom).ColorIndex = xlAutomatic
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeRight).LineStyle = xlContinuous
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeRight).weight = xlThin
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlEdgeRight).ColorIndex = xlAutomatic
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlInsideVertical).LineStyle = xlContinuous
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlInsideVertical).weight = xlThin
                Range("A" + CStr(rowNumber) + ":G" + CStr(rowNumber)).Borders(xlInsideVertical).ColorIndex = xlAutomatic
            End If
        End If
        
        'Generate a work progress in percentage
        pctCnt = pctCnt + 1
        Completed1 = Round(100 * (pctCnt / 5000), 0)
        Completed = CStr("Completed - " & Completed1 & "%")
        frmProgressBar.LabelProgress.Caption = Completed
        DoEvents
    Loop Until sheet6RowNumber >= 5000

    
    'Add the total weight
    Worksheets("RawMat").Cells(rowNumber + 2, 3) = "Total Weight (kg)"
    Worksheets("RawMat").Cells(rowNumber + 2, 6) = "=SUM(F10:F" + CStr(rowNumber) + ")"
    
    'wt = Worksheets("RawMat").Cells(rowNumber + 2, 6)
    
    Worksheets("RawMat").Cells(rowNumber + 4, 6) = "=TotalWeight-F" + CStr(rowNumber + 2)
    Item = Worksheets("RawMat").Cells(rowNumber + 4, 6)
    If Item = 0 Then
        Worksheets("RawMat").Cells(rowNumber + 4, 3) = ""
    Else
        Worksheets("RawMat").Cells(rowNumber + 4, 3) = "Unknown Items (kg)"
    End If
    
    'Format the last row
    Call FormatSummaryRows(rowNumber)
    
    'Format the created table
    Call FormatCells
    
    'Sorts the table according to phase number
    Range(Cells(11, 1), Cells(rowNumber, 7)).Select
    Selection.Sort Key1:=Range("G12"), Order1:=xlAscending, Header:=xlGuess, _
    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
    DataOption1:=xlSortNormal
        
    'Find and delete duplicate entries
    Call DeleteDuplicate
    
    '-----------------------------------------------------------------------------------
    'Sorts the table according to quickest code
    Range(Cells(11, 1), Cells(rowNumber, 7)).Select
    Selection.Sort Key1:=Range("A12"), Order1:=xlAscending, Header:=xlGuess, _
    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
    DataOption1:=xlSortNormal

    'Find and delete duplicate entries
    Call DeleteDuplicate
    '-----------------------------------------------------------------------------------
    
    'Add the weight of the same items
    'Call AddWeight
    
    'Insert a blank row at every occurence of unique entries
    Call InsertBlankRow
    
    'Terminate the progress bar
    Unload frmProgressBar
    
    Call WritePUTable
    
    'Delete the total units value for kg
    Call DeleteKg
    
    Call AddPhaseNumber
    
    'set the value for CCust dbcode in "DB" sheet
    Worksheets("DB").Range("SSkinLoads").Value = "=(RawMat!L30)/(34.3*35)"
    
End Sub

Sub WritePUTable()

    Dim address As String, address2 As String
    Dim upperAddress As String, lowerAddress As String
    
    Worksheets("RawMat").Columns("J:L").ColumnWidth = 12
    
    Worksheets("RawMat").Cells(12, 10) = "Polyurethane Core Breakdown"
    Worksheets("RawMat").Cells(13, 10) = "Item"
    Worksheets("RawMat").Cells(13, 11) = "Kg/M2"
    Worksheets("RawMat").Cells(13, 12) = "Weight(Kg)"
    
    Worksheets("RawMat").Cells(14, 10) = "Core35BPro"
    address = Worksheets("RawMat").Cells(14, 10).address
    Worksheets("RawMat").Cells(14, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(14, 11).address
    Worksheets("RawMat").Cells(14, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    upperAddress = Worksheets("RawMat").Cells(14, 12).address
    
    Worksheets("RawMat").Cells(15, 10) = "Core50BPro"
    address = Worksheets("RawMat").Cells(15, 10).address
    Worksheets("RawMat").Cells(15, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(15, 11).address
    Worksheets("RawMat").Cells(15, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2

    Worksheets("RawMat").Cells(16, 10) = "Core75BPro"
    address = Worksheets("RawMat").Cells(16, 10).address
    Worksheets("RawMat").Cells(16, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(16, 11).address
    Worksheets("RawMat").Cells(16, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2

    Worksheets("RawMat").Cells(17, 10) = "Core100BPro"
    address = Worksheets("RawMat").Cells(17, 10).address
    Worksheets("RawMat").Cells(17, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(17, 11).address
    Worksheets("RawMat").Cells(17, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2

    Worksheets("RawMat").Cells(18, 10) = "Core35CPro"
    address = Worksheets("RawMat").Cells(18, 10).address
    Worksheets("RawMat").Cells(18, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(18, 11).address
    Worksheets("RawMat").Cells(18, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(19, 10) = "Core50CPro"
    address = Worksheets("RawMat").Cells(19, 10).address
    Worksheets("RawMat").Cells(19, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(19, 11).address
    Worksheets("RawMat").Cells(19, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(20, 10) = "Core75CPro"
    address = Worksheets("RawMat").Cells(20, 10).address
    Worksheets("RawMat").Cells(20, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(20, 11).address
    Worksheets("RawMat").Cells(20, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(21, 10) = "Core100CPro"
    address = Worksheets("RawMat").Cells(21, 10).address
    Worksheets("RawMat").Cells(21, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(21, 11).address
    Worksheets("RawMat").Cells(21, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(22, 10) = "Core35BEco"
    address = Worksheets("RawMat").Cells(22, 10).address
    Worksheets("RawMat").Cells(22, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(22, 11).address
    Worksheets("RawMat").Cells(22, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(23, 10) = "Core50BEco"
    address = Worksheets("RawMat").Cells(23, 10).address
    Worksheets("RawMat").Cells(23, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(23, 11).address
    Worksheets("RawMat").Cells(23, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(24, 10) = "Core75BEco"
    address = Worksheets("RawMat").Cells(24, 10).address
    Worksheets("RawMat").Cells(24, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(24, 11).address
    Worksheets("RawMat").Cells(24, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(25, 10) = "Core100BEco"
    address = Worksheets("RawMat").Cells(25, 10).address
    Worksheets("RawMat").Cells(25, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(25, 11).address
    Worksheets("RawMat").Cells(25, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(26, 10) = "Core35CEco"
    address = Worksheets("RawMat").Cells(26, 10).address
    Worksheets("RawMat").Cells(26, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(26, 11).address
    Worksheets("RawMat").Cells(26, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(27, 10) = "Core50CEco"
    address = Worksheets("RawMat").Cells(27, 10).address
    Worksheets("RawMat").Cells(27, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(27, 11).address
    Worksheets("RawMat").Cells(27, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(28, 10) = "Core75CEco"
    address = Worksheets("RawMat").Cells(28, 10).address
    Worksheets("RawMat").Cells(28, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(28, 11).address
    Worksheets("RawMat").Cells(28, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    
    Worksheets("RawMat").Cells(29, 10) = "Core100CEco"
    address = Worksheets("RawMat").Cells(29, 10).address
    Worksheets("RawMat").Cells(29, 11) = "=VLOOKUP(" & address & ",MakDB,6,FALSE)"
    address2 = Worksheets("RawMat").Cells(29, 11).address
    Worksheets("RawMat").Cells(29, 12) = "=SUMIF(DBCodes," & address & ",Units)*" & address2
    lowerAddress = Worksheets("RawMat").Cells(29, 12).address
    
    'calculate the sum of weights
    Worksheets("RawMat").Cells(30, 12) = "=SUM(" & upperAddress & ":" & lowerAddress & ")"
    
    Call FormatPUTable

End Sub

'This is a procedure that deletes duplicate entries
Sub DeleteDuplicate()

    'Worksheets("RawMat").Activate
    
    Dim i As Integer
    i = 0
    Dim pn1, pn2, qc1, qc2, wt1, wt2 As Variant 'pn-phase number, qc-quickest code
    
    'Set the rowNumber variable to 1
    rowNumber = 10
    
    'Loop thru the items to find a duplicate entries
    Do
        'Start the rowNumber count
        rowNumber = rowNumber + 1

        'Store the cell value of the base item
        pn1 = Cells(rowNumber, 7).Text
        qc1 = Cells(rowNumber, 1).Text
        u1 = Cells(rowNumber, 5).Text
        w1 = Cells(rowNumber, 6).Text
        
        'Store the cell value of the succeeding duplicate
        pn2 = Cells(rowNumber + 1, 7).Text
        qc2 = Cells(rowNumber + 1, 1).Text
        u2 = Cells(rowNumber + 1, 5).Text
        w2 = Cells(rowNumber + 1, 6).Text
        
        'If the base item is equal to the succeeding item, add the weight
        'to the base item and delete the entire row of the succeeding item
        If pn1 = pn2 And qc1 = qc2 Then
        
            'Add the weight of succeeding item to the base item
            On Error GoTo ErrHandler:
            w1 = CDbl(w1) + CDbl(w2)
            u1 = CDbl(u1) + CDbl(u2)
ErrHandler:
            If Err.Number = 13 Then
                w1 = w2
                u1 = u2
                Resume Next
            End If

            'Store the weight of the succeeding item on the base item
            Cells(rowNumber, 5).Value = u1
            Cells(rowNumber, 6).Value = w1
            
            'Delete the entire row of the succeeding item
            Rows(rowNumber + 1).EntireRow.Delete

            'Reset the rowNumber variable to 11
            rowNumber = 10
          
        End If
        
    Loop Until pn2 = "" And qc2 = ""  'Loop until an empty cell is encountered

End Sub

'This procedure deletes the total unit value adjacent to columns having kg unit
Sub DeleteKg()
    'Worksheets("RawMat").Activate
    
    rowNumber = 11
    
    Do
        'Start the rowNumber count
        rowNumber = rowNumber + 1

        'Store the cell value of the total units column
        tuCol = Cells(rowNumber, 5).Text
        
        'Store the cell value of the unit column
        uCol = Cells(rowNumber, 4).Text
        
        'Check if the unit column is equal to kg
        If uCol = "kg" Then
            'Delete the value of total unit
            Cells(rowNumber, 5).Value = "-"
        End If
        
    Loop Until tuCol = ""  'Loop until an empty cell is encountered for total units column

End Sub


'This is a procedure that inserts a blank row at every occurence of unique entries
Sub InsertBlankRow()

    Dim columnIndex As Integer
    Dim cellValue1, cellValue2 As Variant
    'Set to 1st row
    rowNumber = 10
    
    'Set columnIndex to phase number column
    columnIndex = 7 '1

    'Check whether item 1 matches item 2, if not insert a blank row before item2
    Do
        'Get the row number of cell in RawMat sheet
        rowNumber = rowNumber + 1

        'Store the cell value on a variable
        cellValue1 = Cells(rowNumber, columnIndex).Text
        cellValue2 = Cells(rowNumber + 1, columnIndex).Text

    ' TO DO - uncomment this item if you want to insert a blank row between two different items
    '------------------------------------------------------------------------------------------
'        'Insert a blank row before item2
'        If cellValue1 <> cellValue2 Then
'            Rows(rowNumber + 1).EntireRow.Select
'            Selection.Insert Shift:=xlDown
'            rowNumber = rowNumber + 1
'        End If
    '------------------------------------------------------------------------------------------
    
    Loop Until cellValue2 = ""
    
    'Format the last row with color
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Interior.ColorIndex = 34
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Interior.Pattern = xlSolid
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeLeft).LineStyle = xlContinuous
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeLeft).weight = xlThin
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeLeft).ColorIndex = xlAutomatic
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeTop).LineStyle = xlContinuous
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeTop).weight = xlHairline
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeTop).ColorIndex = xlAutomatic
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeBottom).LineStyle = xlContinuous
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeBottom).weight = xlThin
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeBottom).ColorIndex = xlAutomatic
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeRight).LineStyle = xlContinuous
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeRight).weight = xlThin
    Range("A" + CStr(rowNumber + 1) + ":G" + CStr(rowNumber + 1)).Borders(xlEdgeRight).ColorIndex = xlAutomatic
    
End Sub

-------------------------------------------------------------------------------
VBA MACRO AddRoofMonitor.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/AddRoofMonitor'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Dated:          August 19, 2010
'Description:    Bill out for Roof Monitor
'Developed by:   Hezron Arandela

Private purlinSize As Double

Dim ts As Double 'half the opening width
Dim screwFactor As Double
Dim foamClosureFactor As Integer
Dim Hs As Double 'height of roof monitor along slope
Dim W As Double 'total width
Dim hw As Double 'wall sheeting height
Private Ls As Double 'sloping length

Private monitorCount As Integer, salesCode As Integer
Dim profileWidth As Double, openingWidth As Double
Private monitorFrameLength As Double, monitorLength As Double
Private roofSheeting As String, wallSheeting As String
Dim foamClosure As String, ridgePanel As String, curvePanel As String
Dim peakBox As String, sheetingScrew1 As String, sheetingScrew2 As String
Private monitorDescription  As String, monitorType As String, baySpacing As String
Dim dripTrim As String, gableTrim As String, curveTrim As String, closureTrim As String

Sub GetGeneralInput()
    monitorDescription = CStr(Sheet1.Range("MonDes"))
    monitorType = Sheet1.Range("MonDes").Offset(1, 0)
    baySpacing = Sheet1.Range("MonDes").Offset(2, 0)
    monitorLength = GetBuildingDimension(baySpacing)
    monitorCount = noOfSideWallBays + 1
    openingWidth = Sheet1.Range("MonDes").Offset(3, 0)
    roofSheeting = Sheet1.Range("MonDes").Offset(4, 0)
    wallSheeting = Sheet1.Range("MonDes").Offset(5, 0)
    salesCode = Sheet1.Range("MonDes").Offset(0, 2)
    
    'Get the total length of roof monitor frame
    monitorFrameLength = Application.WorksheetFunction.RoundUp(GetFrameLength(Sheet1.Range("C11").Value, openingWidth, 200, _
                        Sheet1.Range("PurSize").Value, 500, monitorType), 0)
                        
    'Get the selected panel profile for foam closure billout
    If Sheet1.Range("E28").Value = "M45-250" Then
        foamClosure = "FMC1"
        profileWidth = 1
        screwFactor = 0.25
        foamClosureFactor = 1000
    Else
        foamClosure = "FMC2"
        profileWidth = 0.9
        screwFactor = 0.15
        foamClosureFactor = 900
    End If
    
    'get the ridge panel material used
    If InStr(roofSheeting, " AZ Steel 0.5") > 0 Then
        ridgePanel = "RPS"
    ElseIf InStr(roofSheeting, " AZ Steel 0.7") > 0 Then
        ridgePanel = "RPS1"
    ElseIf InStr(roofSheeting, " Aluminum 0.7") > 0 Then
        ridgePanel = "RPA"
    End If
    
    'get the trimming material used
    If InStr(wallSheeting, " AZ Steel 0.5") > 0 Then
        dripTrim = "DTS"
        gableTrim = "GTS"
        curvePanel = "CPSR"
        curveTrim = "CTS"
        closureTrim = "CLTS"
    ElseIf InStr(wallSheeting, " AZ Steel 0.7") > 0 Then
        dripTrim = "DTS1"
        gableTrim = "GTS1"
        curvePanel = "CPS1R"
        curveTrim = "CTS1"
        closureTrim = "CLTS1"
    ElseIf InStr(wallSheeting, " Aluminum 0.7") > 0 Then
        dripTrim = "DTA"
        gableTrim = "GTA"
        curvePanel = "CPAR"
        curveTrim = "CTA"
        closureTrim = "CLTA"
    End If
    
    'get the peak box material used
    If InStr(wallSheeting, "Aluminum") > 0 Then
        peakBox = "MPB2"
    Else
        peakBox = "MPB"
    End If
    
    'get the sheeting screw material used for sheeting
    If InStr(wallSheeting, "Aluminum") > 0 Then
        sheetingScrew1 = "SS2"
        sheetingScrew2 = "SS1"
    Else
        sheetingScrew1 = "CS2"
        sheetingScrew2 = "CS1"
    End If
    
End Sub

Public Sub AddRoofMonitor()
    
    'Disable the worksheet change event
    Application.EnableEvents = False
    'Call Activation(x)
    'Turn off Automatic Calculation
    Sheet2.EnableCalculation = False
    Sheet3.EnableCalculation = False
    Sheet4.EnableCalculation = False
    
    Sheet2.Activate

    Call GetGeneralInput
        
     Dim nBay As Variant
     Dim pSpaceMax As Double, nPurlins As Integer, nClips As Double
     Dim roofPanelArea As Double
     
     nBay = Split(baySpacing, "@")
     
    Select Case monitorType
        Case "Curve-CF"
            If openingWidth <= 1000 Then
            
                'Maximum purlin spacing

                pSpaceMax = Math.Round(0.5 * (Ls - 900), 0)
                
                'Number of purlins
                If pSpaceMax > 1550 Then
                nPurlins = 8
                Else
                nPurlins = 6
                End If
                
                'Number of girts
                Dim nGirts As Integer
                nGirts = 2
                
                'number of clips
                nClips = (nPurlins + nGirts) * (nBay(0) + 1)
    
                '--------------------------------------------------------------------------------------------------------
                'RMD001 & 003 | Curved Eave Roof Monitor (Cold Formed) Throat Width 1000 and upto 8000 mm bay spacing
                '--------------------------------------------------------------------------------------------------------
                Call InsCode("Roof Monitor - Curve Eave/Cold Formed", "C20G", salesCode, 1, monitorCount * 5.99) 'monitor frame
                Call InsCode("", "RMClip1", salesCode, 1, nClips) 'monitorCount * 1) 'Clips (New Item in MAKDB)
                Call InsCode("", "HSB12", salesCode, 1, monitorCount * 68) 'M12 bolts
                Call InsCode("", "LA", salesCode, 1, monitorLength * 4) 'bent angle
                Call BillOutPurlin(baySpacing, salesCode, 8 * nBay(0))
                Call InsCode("", "WRM", salesCode, 1, monitorLength * 1.7) 'wire mesh
                Call InsCode("", foamClosure, salesCode, 1, monitorLength * 2)
                Call InsCode("", "BM2", salesCode, 1, monitorLength * 2) 'bead mastic
                Call InsCode("", sheetingScrew1, salesCode, 1, (monitorLength * 18) / 0.25)
                Call InsCode("", ridgePanel, salesCode, 1, (monitorLength * 1) / profileWidth)
                Call InsCode("", curvePanel, salesCode, 1, (monitorLength * 2) / profileWidth) 'Curved Panel (New Item in MAKDB, Length = 1.56 m)
                Call InsCode("", dripTrim, salesCode, 1, monitorLength * 2)
                
                'Roof Panel Area
                roofPanelArea = Round((2 * (Ls - 750) * monitorLength) / 1000, 2)
                Call InsCode("", Sheet1.Range("RMRoofSheeting"), salesCode, 1, roofPanelArea)
                
                'Sidewall Panel Area
                Call InsCode("", Sheet1.Range("RMWallSheeting"), salesCode, 1, monitorLength * 1.3)
                
                'Endwall Panel Area
                Call InsCode("", Sheet1.Range("RMWallSheeting"), salesCode, 1, 7)
                
                Call InsCode("", gableTrim, salesCode, 1, 7)
                Call InsCode("", curveTrim, salesCode, 1, 4)
                Call InsCode("", peakBox, salesCode, 1, 2)
                Call InsCode("", "PRVS", salesCode, 1, 80)
                Call InsCode("", sheetingScrew2, salesCode, 1, 80)
                Call InsCode("", "FLM", salesCode, 1, 2) 'flowable mastic
                Call InsCode("", "FBA", salesCode, 1, 13) 'braced bay angle
                Call InsCode("", closureTrim, salesCode, 1, 1.8)
                Call InsCode("", "Gang", salesCode, 1, 3) 'gable angle
            Else
                MsgBox "Limitation for throat width has been exceeded,either reduce the throat width or use a hot-rolled section instead", vbCritical, "Limit Exceeded"
                Sheet1.Activate
                Exit Sub
            End If
        Case "Straight-CF"
            If openingWidth <= 1000 Then
            
                'Maximum purlin spacing
                pSpaceMax = Math.Round(0.5 * (Ls - 375), 0)

                'Number of purlins
                If pSpaceMax > 1550 Then
                nPurlins = 8
                Else
                nPurlins = 6
                End If
                
                'number of clips
                nClips = nPurlins * (nBay(0) + 1)
            
                '--------------------------------------------------------------------------------------------------------
                'RMD002 & 004 | Straight Eave Roof Monitor (Cold Formed) Throat Width 1000 and upto 8000 mm bay spacing
                '--------------------------------------------------------------------------------------------------------
                Call InsCode("Roof Monitor - Straight Eave/Cold Formed", "C20G", salesCode, 1, monitorCount * 4.22) 'monitor frame
                Call InsCode("", "RMClip2", salesCode, 1, nClips) 'monitorCount * 1) 'Clips (New Item in MAKDB)
                Call InsCode("", "HSB12", salesCode, 1, monitorCount * 44) 'M12 bolts
                Call InsCode("", "LA", salesCode, 1, monitorLength * 4) 'bent angle
                Call BillOutPurlin(baySpacing, salesCode, 4 * nBay(0))
                Call InsCode("", "WRM", salesCode, 1, monitorLength * 2.1) 'wire mesh
                Call InsCode("", foamClosure, salesCode, 1, monitorLength * 2)
                Call InsCode("", "BM2", salesCode, 1, monitorLength * 2) 'bead mastic
                Call InsCode("", sheetingScrew1, salesCode, 1, (monitorLength * 12) / 0.25)
                Call InsCode("", ridgePanel, salesCode, 1, (monitorLength * 1) / profileWidth)
                
                'Roof Panel Area
                roofPanelArea = Round((2 * (Ls - 80) * monitorLength) / 1000, 2)
                Call InsCode("", Sheet1.Range("RMRoofSheeting"), salesCode, 1, roofPanelArea)
    
                Call InsCode("", Sheet1.Range("RMWallSheeting"), salesCode, 1, 4.5) 'endwall
                Call InsCode("", gableTrim, salesCode, 1, 8.6)
                Call InsCode("", peakBox, salesCode, 1, 2)
                Call InsCode("", "PRVS", salesCode, 1, 80)
                Call InsCode("", sheetingScrew2, salesCode, 1, 80)
                Call InsCode("", "FBA", salesCode, 1, 13) 'braced bay angle
                Call InsCode("", closureTrim, salesCode, 1, 1.8)
                Call InsCode("", "Gang", salesCode, 1, 3) 'gable angle
            Else
                MsgBox "Limitation for throat width has been exceeded,either reduce the throat width or use a hot-rolled section instead", vbCritical, "Limit Exceeded"
                Sheet1.Activate
                Exit Sub
            End If
        Case "Curve-HR"
            Call GetCurveEaveRoofMonitorMaterials
        Case "Straight-HR"
            Call GetStraightEaveRoofMonitorMaterials
    End Select
    
    Call InsCode("", "-", salesCode, "", "")
    Call RecapInput("Monitor")
    
    'Turn ON Automatic Calculation
    Sheet2.EnableCalculation = True
    Sheet3.EnableCalculation = True
    Sheet4.EnableCalculation = True
    
    Sheet1.Activate
    
    'Disable the worksheet change event
    Application.EnableEvents = True
    
    Call QuickEstCalculations.GetPhaseNumberFromMAKDB
    
    Application.Calculation = xlAutomatic
    
End Sub

'Quantity for Curved Eave Roof Monitor (Hot-Rolled)
Private Sub GetCurveEaveRoofMonitorMaterials()

    'Maximum purlin spacing
    Dim pSpaceMax As Double
    pSpaceMax = Math.Round(0.5 * (Ls - 900), 0)

    'Number of purlins
    Dim nPurlins As Integer
    If pSpaceMax > 1550 Then
        nPurlins = 8
    Else
        nPurlins = 6
    End If
    
    'Number of girts
    Dim nGirts As Integer
    nGirts = 2

    'Total length of HR sections
    Dim monitorTotalFrameLength As Double
    monitorTotalFrameLength = (monitorFrameLength * monitorCount) / 1000
    Call InsCode("Roof Monitor - Curve Eave/Hot-Rolled", "IPEa", salesCode, 1, monitorTotalFrameLength)
    
    'Number of end bay purlin and girts
    Dim nEndBayPurlinGirts As Integer
    nEndBayPurlinGirts = (nPurlins + nGirts) * 2
    Call BillOutPurlin(baySpacing, salesCode, nEndBayPurlinGirts)
    
    'Number of interior bay purlin and girts
    Dim nInteriorBayPurlinGirts As Integer
    nInteriorBayPurlinGirts = (nPurlins + nGirts) * (monitorCount - 3)
    Call BillOutPurlin(baySpacing, salesCode, nInteriorBayPurlinGirts)
    
    'number of clips
    Dim clipWeight As Double
    clipWeight = (nPurlins + nGirts) * monitorCount
    Call InsCode("", "RMClip1", salesCode, 1, clipWeight)
    
    'Weight of stiffener
    Dim stiffenerWeight As Double
    stiffenerWeight = monitorCount * 8
    
    'Weight of connection bolts
    Dim nConnectionBolts As Double
    nConnectionBolts = ((6 * (nPurlins + nGirts)) + 24) * monitorCount
    Call InsCode("", "HSB12", salesCode, 1, nConnectionBolts) 'M12 bolts
    
    'Number of End Plates Rafter
    Dim nRafterPlate As Double
    nRafterPlate = 2 * monitorCount
    Call InsCode("", "RMC1", salesCode, 1, nRafterPlate)
    
    'Number of End Plates Stubs
    Dim nStubPlate As Double
    nStubPlate = 2 * monitorCount
    Call InsCode("", "RMC2", salesCode, 1, nStubPlate)
    
    'Length of Bent Angle
    Dim bentAngleLength As Double
    bentAngleLength = 4 * monitorLength
    Call InsCode("", "LA", salesCode, 1, bentAngleLength)
    
    'Roof Panel Area
    Dim roofPanelArea As Double
    roofPanelArea = Round((2 * (Ls - 750) * monitorLength) / 1000, 2)
    Call InsCode("", Sheet1.Range("RMRoofSheeting"), salesCode, 1, roofPanelArea)
    
    'Sidewall Panel Area
    Dim wallPanelArea As Double
    wallPanelArea = Round((2 * hw * monitorLength) / 1000, 2)
    Call InsCode("", Sheet1.Range("RMWallSheeting"), salesCode, 1, wallPanelArea)
    
    'Endwall Panel Area
    Dim endWallPanelarea As Double
    endWallPanelarea = Round((2 * Hs * W) / 1000 ^ 2, 2)
    Call InsCode("", Sheet1.Range("RMWallSheeting"), salesCode, 1, endWallPanelarea)
    
    'Curve Eave Panel
    Dim curveEavePanelQty As Double
    curveEavePanelQty = (2 * monitorLength) / profileWidth
    Call InsCode("", curvePanel, salesCode, 1, curveEavePanelQty)
    
    'Ridge Panel
    Dim ridgePanelQty As Double
    ridgePanelQty = (1 * monitorLength) / profileWidth
    Call InsCode("", ridgePanel, salesCode, 1, ridgePanelQty)
                
    'Bead Mastic
    Dim beadMasticQty As Double
    beadMasticQty = Round((4 * monitorLength * 1.219) / 9, 2)
    Call InsCode("", "BM2", salesCode, 1, beadMasticQty)
    
    'Screws (SDS 5.5x25)
    Dim screws1 As Double
    screws1 = (2 * (nPurlins + nGirts + 1) * monitorLength) / screwFactor
    Call InsCode("", sheetingScrew1, salesCode, 1, screws1)
    
    'Wire Mesh
    Dim wireMeshQty As Double
    wireMeshQty = 2 * (ts + 150 + 200) * monitorLength / 1000
    Call InsCode("", "WRM", salesCode, 1, wireMeshQty)
    
    'Length of Gable Trim
    Dim gableTrimLength As Double
    gableTrimLength = Round(2 * 2 * (ts + 150 + Ls - 500) / 1000, 2)
    Call InsCode("", gableTrim, salesCode, 1, gableTrimLength)
    
    'Number of curved corner trim
    Dim nCurveCornerTrim As Double
    nCurveCornerTrim = Round(2 * 500 * 3.1416 / 1000, 2)
    Call InsCode("", curveTrim, salesCode, 1, nCurveCornerTrim)
    
    'Closure Trim (406)
    Dim closureTrimQty As Double
    closureTrimQty = 4 * hw / 1000
    Call InsCode("", closureTrim, salesCode, 1, closureTrimQty)
    
    'SDS 4.8x20 (Steel or Aluminium)
    Dim screws2 As Double
    screws2 = Round((2 * 2 * 2 * (Hs + Ls) + (closureTrimQty)) / 300, 2)
    Call InsCode("", sheetingScrew2, salesCode, 1, screws2)
    
    'Pop Rivet
    Dim popRivetQty As Integer
    popRivetQty = 80
    Call InsCode("", "PRVS", salesCode, 1, popRivetQty)
    
    'Peak Box (Steel or Aluminium)
    Dim peakBoxQty As Integer
    peakBoxQty = 2
    Call InsCode("", peakBox, salesCode, 1, peakBoxQty)
    
    'Foam Closure @ Sidewall
    Dim swFoamClosureQty As Double
    swFoamClosureQty = (2 * monitorLength) / profileWidth
    'Foam Closure @ Endwall
    Dim ewFoamClosureQty As Double
    ewFoamClosureQty = 2 * 2 * 2 * (Hs + Ls) / foamClosureFactor
    Call InsCode("", foamClosure, salesCode, 1, swFoamClosureQty + ewFoamClosureQty)
    
    'Flowable Mastic
    Dim flowableMasticQty As Double
    flowableMasticQty = 2
    Call InsCode("", "FLM", salesCode, 1, flowableMasticQty)
    
    'Braced Bay Angle (40x40x4)
    Dim bracedBayAngleQty As Double
    bracedBayAngleQty = Round(8 * Hs * Sqr(2) / 1000, 2)
    Call InsCode("", "FBA", salesCode, 1, bracedBayAngleQty)
    
    'Gable Angle
    Dim gableAngleQty As Double
    gableAngleQty = Round(Ls * 2 / 1000, 2)
    Call InsCode("", "Gang", salesCode, 1, gableAngleQty)
    
End Sub

'Quantity for Straight Eave Roof Monitor (Hot-Rolled)
Private Sub GetStraightEaveRoofMonitorMaterials()

    'Maximum purlin spacing
    Dim pSpaceMax As Double
    pSpaceMax = Math.Round(0.5 * (Ls - 375), 0)

    'Number of purlins
    Dim nPurlins As Integer
    If pSpaceMax > 1550 Then
        nPurlins = 8
    Else
        nPurlins = 6
    End If
    
    'Total length of HR sections
    Dim monitorTotalFrameLength As Double
    monitorTotalFrameLength = Round((monitorFrameLength * monitorCount) / 1000, 2)
    Call InsCode("Roof Monitor - Straight Eave/Hot-Rolled", "IPEa", salesCode, 1, monitorTotalFrameLength)

    'Number of end bay purlin and girts
    Dim nEndBayPurlin As Integer
    nEndBayPurlin = nPurlins * 2
    Call BillOutPurlin(baySpacing, salesCode, nEndBayPurlin)
    
    'Number of interior bay purlin and girts
    Dim nInteriorBayPurlinGirts As Integer
    nInteriorBayPurlinGirts = nPurlins * (monitorCount - 3)
    Call BillOutPurlin(baySpacing, salesCode, nInteriorBayPurlinGirts)
    
    'Roof monitor clips
    Dim clipWeight As Double
    clipWeight = nPurlins * monitorCount
    Call InsCode("", "RMClip2", salesCode, 1, clipWeight)
    
    'Weight of stiffener
    Dim stiffenerWeight As Double
    stiffenerWeight = monitorCount * 8
    
    'Weight of connection bolts
    Dim nConnectionBolts As Double
    nConnectionBolts = ((6 * nPurlins) + 24) * monitorCount
    Call InsCode("", "HSB12", salesCode, 1, nConnectionBolts)
    
    'Number of End Plates Rafter
    Dim nRafterPlate As Double
    nRafterPlate = 2 * monitorCount
    Call InsCode("", "RMC1", salesCode, 1, nRafterPlate)
    
    'Number of End Plates Stubs
    Dim nStubPlate As Double
    nStubPlate = 2 * monitorCount
    Call InsCode("", "RMC2", salesCode, 1, nStubPlate)
    
    'Length of Bent Angle
    Dim bentAngleLength As Double
    bentAngleLength = 4 * monitorLength
    Call InsCode("", "LA", salesCode, 1, bentAngleLength)
        
    'Roof Panel Area
    Dim roofPanelArea As Double
    roofPanelArea = Round((2 * (Ls - 80) * monitorLength) / 1000, 2)
    Call InsCode("", Sheet1.Range("RMRoofSheeting"), salesCode, 1, roofPanelArea)
    
    'Endwall Panel Area
    Dim endWallPanelarea As Double
    endWallPanelarea = Round((2 * Hs * W) / 1000 ^ 2, 2)
    Call InsCode("", Sheet1.Range("RMWallSheeting"), salesCode, 1, endWallPanelarea)
    
    'Ridge Panel
    Dim ridgePanelQty As Double
    ridgePanelQty = (1 * monitorLength) / profileWidth
    Call InsCode("", ridgePanel, salesCode, 1, ridgePanelQty)
    
    'Bead Mastic
    Dim beadMasticQty As Double
    beadMasticQty = Round((2 * monitorLength * 1.219) / 9, 2)
    Call InsCode("", "BM2", salesCode, 1, beadMasticQty)
    
    'Screws (SDS 5.5x25)
    Dim screws1 As Double
    screws1 = (2 * (nPurlins + 1) * monitorLength) / screwFactor
    Call InsCode("", sheetingScrew1, salesCode, 1, screws1)
    
    'Wire Mesh
    Dim wireMeshQty As Double
    wireMeshQty = 2 * Hs * monitorLength / 1000
    Call InsCode("", "WRM", salesCode, 1, wireMeshQty)
    
    'Length of Gable Trim
    Dim gableTrimLength As Double
    gableTrimLength = Round(4 * (Hs + Ls) / 1000, 2)
    Call InsCode("", gableTrim, salesCode, 1, gableTrimLength)
    
    'SDS 4.8x20 (Steel or Aluminium)
    Dim screws2 As Double
    screws2 = Round((8 * (Hs + Ls)) / 300, 2)
    Call InsCode("", sheetingScrew2, salesCode, 1, screws2)
    
    'Pop Rivet
    Dim popRivetQty As Integer
    popRivetQty = 80
    Call InsCode("", "PRVS", salesCode, 1, popRivetQty)
    
    'Peak Box (Steel or Aluminium)
    Dim peakBoxQty As Integer
    peakBoxQty = 2
    Call InsCode("", peakBox, salesCode, 1, peakBoxQty)
    
    'Foam Closure @ Sidewall
    Dim swFoamClosureQty As Double
    swFoamClosureQty = (2 * monitorLength) / profileWidth
    'Foam Closure @ Endwall
    Dim ewFoamClosureQty As Double
    ewFoamClosureQty = 8 * (Hs + Ls) / foamClosureFactor
    Call InsCode("", foamClosure, salesCode, 1, swFoamClosureQty + ewFoamClosureQty)
    
    'Flowable Mastic
    Dim flowableMasticQty As Double
    flowableMasticQty = 2
    Call InsCode("", "FLM", salesCode, 1, flowableMasticQty)
    
    'Braced Bay Angle (40x40x4)
    Dim bracedBayAngleQty As Double
    bracedBayAngleQty = Round(8 * Hs * Sqr(2) / 1000, 2)
    Call InsCode("", "FBA", salesCode, 1, bracedBayAngleQty)
    
    'Gable Angle
    Dim gableAngleQty As Double
    gableAngleQty = Round(Ls * 2 / 1000, 2)
    Call InsCode("", "Gang", salesCode, 1, gableAngleQty)
    
End Sub

Sub BillOutPurlin(baySpacing As String, salesCode As Integer, numberOfPurlinsPerBay As Integer)

    Dim Bays(100, 1) As Double
    Call GetList(baySpacing, Bays())
    nbays = 0
    
    For i = 1 To 100
      nbays = nbays + Bays(i, 0)
    Next i
    
    If nbays > 2 Then
        IntPurlinDes = "Interior Bay Purlins"
        For i = 1 To Bays(0, 0)
            PDCode = Sheet5.Range("PDCode")
            Psize = Bays(i, 1) + 0.107
            If Bays(i, 1) > 6.5 Then Psize = Psize + 0.599
            If Bays(i, 1) > 9# Then Psize = Psize + 0.706
            If Bays(i, 0) > 0 Then
                Select Case Sheet1.Range("E26").Value
                    Case 200
                        Call InsCode("", PDCode, salesCode, Psize, numberOfPurlinsPerBay) ' * Bays(i, 0))
                    Case 250
                        Call InsCode("", "250Z20G", salesCode, Psize, numberOfPurlinsPerBay) ' * Bays(i, 0))
                    Case 360
                        Call InsCode("", "M18G", salesCode, Psize, numberOfPurlinsPerBay) ' * Bays(i, 0))
                End Select
            End If
        Next i
    End If
    
End Sub



Private Function GetFrameLength(slopeFactor As Double, ByVal openingWidth As Double, sectionDepth As Double, _
                                purlinGirthDepth As Double, curveRadius As Double, monitorType As String)

    'Input variables
    Dim sf As Double 'slope factor
    Dim T As Double 'opening width
'    Dim ts As Double 'half the opening width
    ts = 0
    Dim d As Double 'section depth
    Dim p As Double 'purlin/girth depth
    Dim R As Double 'curve eave radius
    Dim e As Double 'extension of panel at eave
    
    'Initialize input variables
    sf = slopeFactor
    T = openingWidth
    ts = T / 2
    d = sectionDepth
    p = purlinGirthDepth
    R = curveRadius
    e = 100
    nFrames = 10 'number of frames
    
    'Curve/Straight Eave variables
'    Dim Hs As Double 'height of roof monitor along slope
    Hs = 0
    Dim hst As Double 'height of stub column
'    Dim hw As Double 'wall sheeting height
    hw = 0
    'Dim Ls As Double 'sloping length
    Ls = 0
    Dim Lr As Double 'rafter length
'    Dim W As Double 'total width
    W = 0
    Dim H As Double 'total height
    Dim bp As Double 'braced purlin location from peak
    
    'Calculate for frame length
    If InStr(monitorType, "Curve") > 0 Then
        'Curve Eave
        Hs = ts + 150 + R + e
        hst = Hs - d
        hw = Hs - d - ts
        Ls = Math.Sqr((ts ^ 2) + (ts * sf) ^ 2) + ((p + Hs) * sf) + (2 * p) + ts
        Lr = (Ls - p - (d * sf))
        W = 2 * Math.Sqr(Ls ^ 2 - (Ls * sf) ^ 2)
        H = Math.Sqr(Hs ^ 2 - (Hs * sf) ^ 2)
        bp = Math.Sqr(ts ^ 2 + (ts * sf) ^ 2) - d + (H + p) * sf
    Else
        'Straight Eave
        Hs = ts + 150 + p
        hst = Hs - d
        Ls = Math.Sqr((ts ^ 2) + (ts * sf) ^ 2) + ((p + Hs) * sf) + ts + 150
        Lr = Ls - (d * sf)
        W = 2 * Math.Sqr(Ls ^ 2 - (Ls * sf) ^ 2)
        H = Math.Sqr(Hs ^ 2 - (Hs * sf) ^ 2)
        bp = Math.Sqr(ts ^ 2 + (ts * sf) ^ 2) - d + (H + p) * sf
    End If
    
    'Get the frame length
    If InStr(monitorType, "HR") > 0 Then
        GetFrameLength = (2 * Lr) + (2 * hst) + 300
    Else
        GetFrameLength = (2 * Lr) + (2 * (hst + d))
    End If
        
End Function

-------------------------------------------------------------------------------
VBA MACRO QuickEstCalculations.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/QuickEstCalculations'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Text Comparison(Case insensitive comparison)
Option Compare Text

Public purlinClipQty As Integer
Public noOfSideWallBays As Integer
Public sideWallBaySpacing As Integer
Public mainFrameMinSpan As Double

Public Function GetDownspoutQty()

    'Declare variables
    Dim rainfallIntensity As Integer
    Dim width As Variant
    Dim width2 As Variant, baySpacing As Variant
    'Dim bldgLength As Variant
    Dim noOfBays As String, backEaveCondition As String, frontEaveCondition As String
    Dim backEaveDownSpoutSpacing As Double, frontEaveDownSpoutSpacing As Double, downSpoutSpacing As Double
        
    'get the rainfall intensity
    rainfallIntensity = Sheet1.Range("E24").Value

    'Calculate the building width
    width = Sheet1.bldgWidth 'GetBuildingDimension(Sheet1.Range("AreaDesc").Offset(1, 0).Value)'modified by hezron on 08/17/2010
    
    'Calculate the building length
'    baySpacing = Sheet1.Range("AreaDesc").Offset(3, 0).Value
'    baySpacing = Split(baySpacing, "@")
'    noOfBays = baySpacing(0)
    baySpacing = 10000 'baySpacing(1)
    'Sheet14.Range("E12").Value = baySpacing
    bldgLength = Sheet1.bldgLength 'CDbl(noOfBays) * CDbl(baySpacing)'modified by hezron on 08/17/2010
    
    'Calculate the eave condition
    backEaveCondition = Sheet1.Range("E13").Value
    frontEaveCondition = Sheet1.Range("E14").Value
    
    'Get the downspout spacing----------------------------------------------------------------------
    
    Dim downSpoutSpacing1 As Double, downSpoutSpacing2 As Double
    
    downSpoutSpacing1 = CalculateDownspoutQty(1, width / 2, width / 2, _
                        baySpacing, 1, "Interior", "Normal", rainfallIntensity) 'for eave gutter

    downSpoutSpacing2 = CalculateDownspoutQty(1, width / 2, width / 2, _
                        baySpacing, 2, "Interior", "Normal", rainfallIntensity) 'for valley gutter

    If backEaveCondition = frontEaveCondition Then
        If backEaveCondition = "Gutter+Dwnspts" Then
            downSpoutSpacing = downSpoutSpacing1
        Else
            downSpoutSpacing = downSpoutSpacing2
        End If
    Else
        If backEaveCondition = "Gutter+Dwnspts" And frontEaveCondition = "Curved+VGutter" Then
            downSpoutSpacing = Application.WorksheetFunction.Min(downSpoutSpacing1, downSpoutSpacing2)
        End If
        If backEaveCondition = "Curved+VGutter" And frontEaveCondition = "Gutter+Dwnspts" Then
            downSpoutSpacing = Application.WorksheetFunction.Min(downSpoutSpacing1, downSpoutSpacing2)
        End If

        If backEaveCondition = "Gutter+Dwnspts" Then
            If frontEaveCondition = "Eave Trim" Or frontEaveCondition = "Curved " Then
                downSpoutSpacing = downSpoutSpacing1
            End If
        End If
        If backEaveCondition = "Curved+VGutter" Then
            If frontEaveCondition = "Eave Trim" Or frontEaveCondition = "Curved " Then
                downSpoutSpacing = downSpoutSpacing2
            End If
        End If

        If frontEaveCondition = "Gutter+Dwnspts" Then
            If backEaveCondition = "Eave Trim" Or backEaveCondition = "Curved " Then
                downSpoutSpacing = downSpoutSpacing1
            End If
        End If
        If frontEaveCondition = "Curved+VGutter" Then
            If backEaveCondition = "Eave Trim" Or backEaveCondition = "Curved " Then
                downSpoutSpacing = downSpoutSpacing2
            End If
        End If
    End If

    '------------------------------------------------------------------------------------------------

    'Calculate the downspout quantity
    GetDownspoutQty = (bldgLength / downSpoutSpacing)

End Function


'This procedure inserts the sheeting code/description to the FCPBS sheet
'Target cells:F48,F49,F50,F51,F56,F57
Sub GetSheetingCode()
    
    Sheet4.Unprotect ("ResearcH[20.19.5.11.3.9.21.17]")
    'revert to original cell description
    Sheet4.Range("F48").Value = "Single Skin Panels (Aluminum)"
    Sheet4.Range("F49").Value = "Single Skin Panels (Steel)"
    Sheet4.Range("F50").Value = "Ridge panels, curved  Eaves (Aluminum)"
    Sheet4.Range("F51").Value = "Ridge panels, curved Eaves(Steel)"
    Sheet4.Range("F56").Value = "Sandwich Panels (Aluminum)"
    Sheet4.Range("F57").Value = "Sandwich Panels (Steel)"

    'Reflect the sheeting sizes on the FCPBS sheet
    '   Legend: R-roof,IS-inner skin,OS outer skin,
    '           RS-roof sheeting,WS-wall sheeting
    Dim RIS As String, RCore As String, ROS As String, RS As String
    Dim WIS As String, WCore As String, WOS As String, WS As String
    
        '--------------------------Wall Sheeting--------------------------
    'WIS = Sheet1.Range("C154").Value
    If InStr(Sheet1.Range("C154").Value, "AZ Steel 0.5") > 0 Then
        If InStr(Sheet1.Range("C154").Value, "Mill Finish") > 0 Then
            WIS = "0.5AZ MF"
        Else
            WIS = "0.5AZ PP"
        End If
    End If
    'added on august 16, 2010----------------------------------------
    If InStr(Sheet1.Range("C154").Value, "AZ Steel 0.7") > 0 Then
        If InStr(Sheet1.Range("C154").Value, "Mill Finish") > 0 Then
            WIS = "0.7AZ MF"
        Else
            WIS = "0.7AZ PP"
        End If
    End If
    '----------------------------------------------------------------
    
'    If InStr(Sheet1.Range("C154").Value, "AZ Steel 0.7") > 0 Then WIS = "0.7AZ PP" ''commenteded on august 16, 2010
    
    If InStr(Sheet1.Range("C154").Value, "Aluminum 0.7") > 0 Then
        If InStr(Sheet1.Range("C154").Value, "Mill Finish") > 0 Then
            WIS = "0.7AL MF"
        Else
            WIS = "0.7AL PP"
        End If
    End If
    
    WCore = Sheet1.Range("C155").Value
    If InStr(WCore, "PUCore 35") > 0 Then WCore = "-35-"
    If InStr(WCore, "PU Core 50") > 0 Then WCore = "-50-"
    If InStr(WCore, "PUCore 75") > 0 Then WCore = "-75-"
    If InStr(WCore, "PUCore 100") > 0 Then WCore = "-100-"
    WOS = Sheet1.Range("C156").Value
    If InStr(WOS, "AL Foil") > 0 Then WOS = "AlFoil"
    If InStr(WOS, "AZ Steel 0.5") > 0 Then WOS = "0.5AZ PP"
    If InStr(WOS, "GI") > 0 Then WOS = "0.4GI PP"
    If InStr(WOS, "Aluminum") > 0 Then WOS = "0.5AL PP"
    
    'Combine the code to one string
    WS = WIS + WCore + WOS
    
'    'Write the code to FCPBS sheet
    If InStr(WS, "AZ") > 0 Then 'check if aluzinc
        If Len(WS) > 10 Then 'check if sandwich panel
            WS = "Sandwich Panels (Steel)- " + WS
            Sheet4.Range("F57").Value = WS
        Else    'check if single skin
            'Sheet4.Range("F51").Value = "Ridge panels, curved Eaves(Steel)- " + WS
            WS = "Single Skin Panels (Steel)- " + WS
            Sheet4.Range("F49").Value = WS
            'If WS = "0.7AZ  " Then Sheet4.Range("F49").Value = RS + " / " + WS
        End If
    End If
        
    If InStr(WS, "0.7AL") > 0 Then 'check if aluminum
        If Len(WS) > 10 Then 'check if sandwich panel
            WS = "Sandwich Panels (Aluminum)- " + WS
            Sheet4.Range("F56").Value = WS
        Else    'check if single skin
            'Sheet4.Range("F50").Value = "Ridge panels, curved  Eaves (Aluminum)- " + WS
            WS = "Single Skin Panels (Aluminum)- " + WS
            Sheet4.Range("F48").Value = WS
        End If
    End If
    
    '--------------------------Roof Sheeting--------------------------
    'RIS = Sheet1.Range("C149").Value
    If InStr(Sheet1.Range("C150").Value, "AZ Steel 0.5") > 0 Then
        If InStr(Sheet1.Range("C150").Value, "Mill Finish") > 0 Then
            RIS = "0.5AZ MF"
        Else
            RIS = "0.5AZ PP"
        End If
    End If
    'added on august 16, 2010----------------------------------------
    If InStr(Sheet1.Range("C150").Value, "AZ Steel 0.7") > 0 Then
        If InStr(Sheet1.Range("C150").Value, "Mill Finish") > 0 Then
            RIS = "0.7AZ MF"
        Else
            RIS = "0.7AZ PP"
        End If
    End If
    '----------------------------------------------------------------
    'If InStr(RIS, "AZ Steel 0.7") > 0 Then RIS = "0.7AZ PP" 'commenteded on august 16, 2010
    
    If InStr(Sheet1.Range("C150").Value, "Aluminum 0.7") > 0 Then
        If InStr(Sheet1.Range("C150").Value, "Mill Finish") > 0 Then
            RIS = "0.7AL MF"
        Else
            RIS = "0.7AL PP"
        End If
    End If
    
    RCore = Sheet1.Range("C151").Value
    If InStr(RCore, "PUCore 35") > 0 Then RCore = "-35-"
    If InStr(RCore, "PU Core 50") > 0 Then RCore = "-50-"
    If InStr(RCore, "PUCore 75") > 0 Then RCore = "-75-"
    If InStr(RCore, "PUCore 100") > 0 Then RCore = "-100-"
    ROS = Sheet1.Range("C152").Value
    If InStr(ROS, "AL Foil") > 0 Then ROS = "AlFoil"
    If InStr(ROS, "AZ Steel 0.5") > 0 Then ROS = "0.5AZ PP"
    If InStr(ROS, "GI") > 0 Then ROS = "0.4GI PP"
    If InStr(ROS, "Aluminum") > 0 Then ROS = "0.5AL PP"
    
    'Combine the code to one string
    RS = RIS + RCore + ROS
    
    'Write the code to FCPBS sheet
    If InStr(RIS, "AZ") > 0 Then 'check if aluzinc
        If Len(RS) > 10 Then 'check if sandwich panel
            RS = "Sandwich Panels (Steel)- " + RS
            Sheet4.Range("F57").Value = RS
            Sheet4.Range("F51").Value = "Ridge panels, curved Eaves(Steel)- " + RIS
        Else    'check if single skin
            Sheet4.Range("F51").Value = "Ridge panels, curved Eaves(Steel)- " + RS
            RS = "Single Skin Panels (Steel)- " + RS
            Sheet4.Range("F49").Value = RS
            If WS = "0.7AZ  " Then Sheet4.Range("F49").Value = RS + " / " + WS
        End If
    End If
        
    If InStr(RIS, "0.7AL") > 0 Then 'check if aluminum
        If Len(RS) > 10 Then 'check if sandwich panel
            RS = "Sandwich Panels (Aluminum)- " + RS
            Sheet4.Range("F56").Value = RS
            Sheet4.Range("F50").Value = "Ridge panels, curved Eaves(Aluminum)- " + RIS
        Else    'check if single skin
            Sheet4.Range("F50").Value = "Ridge panels, curved  Eaves (Aluminum)- " + RS
            RS = "Single Skin Panels (Aluminum)- " + RS
            Sheet4.Range("F48").Value = RS
        End If
    End If
    
    Sheet4.Protect ("ResearcH[20.19.5.11.3.9.21.17]")
    
End Sub

'Calculate the beadmastic quantity base on rafter length and building height
Sub RoofSheetingBeadMasticQuantity(salesCode As Variant, rafterLenght As Variant, buildinglength As Variant)

    Dim rafterLength As Integer
    Dim nBM1Lines As Integer, nBM2Lines As Integer
    Dim nBM1Qty As Integer, nBM2Qty As Integer
    
    rafterLength = rafterLenght / 2
    
    'calculate the transverse beadmastic quantity
    nBM1Lines = 2 * (buildinglength + 1)
    nBM1Qty = (nBM1Lines * rafterLength) / 19
    
    'calculate the longitudinal beadmastic quantity
    nBM2Lines = ((rafterLength / 9) + 2) * 2
    nBM2Qty = (nBM2Lines * buildinglength * 1.219) / 9
  
    'bill out BM1
    Call InsCode("", "BM1", salesCode, 1, nBM1Qty)
  
    'bill out BM2
    Call InsCode("", "BM2", salesCode, 1, nBM2Qty)
    
End Sub

Public Function GetBuildingDimension(stringToProcess As String)

    Dim bay, bayNos, bayLength As Variant
    noOfSideWallBays = 0
    bayLength = 0
    Dim span() As Variant
    mainFrameMinSpan = 0
    
    'separate strings by identifying the separator to get the no of bays and bay spacing
    If InStr(stringToProcess, "+") > 0 Then
        bay = Split(stringToProcess, "+")
        ReDim Preserve span(UBound(bay))
        For i = 0 To UBound(bay)
            If (InStr(1, bay(i), "@") > 0) Then
                bayNos = Split(bay(i), "@")
                For j = 1 To CInt(bayNos(0))
                    noOfSideWallBays = noOfSideWallBays + 1
                    bayLength = bayLength + bayNos(1)
                    span(i) = bayNos(1)
                Next
            Else
             noOfSideWallBays = noOfSideWallBays + 1
             bayLength = bayLength + bay(i)
            End If
        Next i
        GetBuildingDimension = bayLength
        Call Sort(span)
        mainFrameMinSpan = span(UBound(span)) 'get the maximum span
    ElseIf InStr(stringToProcess, "@") > 0 Then
        bay = Split(stringToProcess, "@")
        GetBuildingDimension = bay(0) * bay(1)
        noOfSideWallBays = bay(0)
        sideWallBaySpacing = bay(1)
        mainFrameMinSpan = bay(1)
    Else
        mainFrameMinSpan = stringToProcess
        'MsgBox "This format is not allowed", vbExclamation, "Invalid Format"
    End If
        
End Function

'Sorts an array of spans
Sub Sort(arr() As Variant)

    Dim Temp As Double
    Dim i As Long
    Dim j As Long
    
    For j = 2 To UBound(arr)
        Temp = arr(j)
        For i = j - 1 To 1 Step -1
            If (arr(i) <= Temp) Then GoTo 10
            arr(i + 1) = arr(i)
        Next i
        i = 0
10      arr(i + 1) = Temp
    Next j
    
End Sub

Function CalculateDownspoutQty(roofSlope As Integer, leftRoofWidth As Double, rightRoofWidth As Double, _
                          baySpacing As Variant, gutterType As Integer, downSpoutLocation As String, _
                          rainfallType As String, i As Integer)
    
    '===========Building Data===========
    Dim roofAngle As Double
    roofAngle = Tan(roofSlope / 10) * (180 / Worksheets.Application.WorksheetFunction.Pi())
            
    Dim R As Double  'total width to be drained
    R = (leftRoofWidth + rightRoofWidth) / Cos((roofAngle * Worksheets.Application.WorksheetFunction.Pi) / 180)
    
    Dim columnSpacing As Double
    columnSpacing = baySpacing
    
    '=======Gutter & Downspout Data======
    '(1 = Eave Gutter,2 = Common Eave Valley Gutter,3 = High / Low Valley Gutter)
       
    Dim d As Integer 'gutter depth
    Dim W As Integer 'average gutter width
    Dim A As Integer 'down spout area
    
    Select Case gutterType
        Case 1
            d = 160
            W = 168
            A = 7670
        Case 2
            d = 185
            W = 400
            A = 17671
        Case 3
            d = 185
            W = 370
            A = 17671
    End Select
        
    Dim T As Integer
    If downSpoutLocation = "End" Then
        T = 1
    Else
        T = 2
    End If
    
    Dim n As Integer 'number of downspouts
    n = 1
    
    '============Rainfall Data===========
    Dim C As Integer
    If rainfallType = "Normal" Then 'or "Heavy"
        C = 0.8 + (0.2 * 1)
    Else
        C = 0.8 + (0.2 * 2)
    End If
    
    'Determine down spout spacing based on Gutter Capacity
    Dim L1 As Double, L2 As Double
    
    L1 = 0.0585 * _
         ((W ^ (3 / 7) * d ^ (4 / 7) * (Cos((roofAngle * Application.WorksheetFunction.Pi) / 180) / (R * i)) ^ (5 / 14)) ^ (28 / 13)) * _
         (T / C)
        
    'Determine down spout spacing based on Downspout Capacity
    L2 = 4.39 * A * n * (Cos((roofAngle * Application.WorksheetFunction.Pi) / 180) / (C * i * R))
    
    CalculateDownspoutQty = Application.WorksheetFunction.Min(columnSpacing, L1, L2)
       
End Function

'Created by: Hezron Arandela
'Date Created: February 11, 2010
Sub GetPhaseNumberFromMAKDB()
'
'    Dim rowNumber As Integer, lastRow As Integer
'    Dim phaseNumber As String, erpCode As String
'    Dim address As String
'    Dim myRange As Range
'
'    rowNumber = 10
'
'    'Get the last row in the "sheet6PhaseNumber" range from "RawMat" sheet
'    lastRow = Sheet2.Range("DBCodes").Rows.Count + 7
'
'    Set myRange = Worksheets("MakDB").Range("MakDB_PN")
'
'    Do
'        'look for the corresponding phase number from "MAKDB" sheet
'        rowNumber = rowNumber + 1
'        address = Worksheets("Detail").Cells(rowNumber, 2).Text
'        If address <> "" Then
'            phaseNumber = Application.WorksheetFunction.VLookup(address, myRange, 17, False)
'            Worksheets("Detail").Cells(rowNumber, 20) = phaseNumber
'
'            erpCode = Application.WorksheetFunction.VLookup(address, myRange, 18, False)
'            Worksheets("Detail").Cells(rowNumber, 21) = erpCode
'        End If
'    Loop Until rowNumber = lastRow
    
End Sub


-------------------------------------------------------------------------------
VBA MACRO ProgramActivation.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/ProgramActivation'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Public Active As Boolean
Public AuthorizationCode, UserName, EmployeeNumber, Department, DivisionBranch As String
' Public A As Variant 'disk serial number
Dim serialKey As Long
Public isKeyRequestSentOnce As Boolean
Public sHostName As Variant
Public sHostName2 As String
Public sUserName As String

Sub OpenKeyFile()
    Dim sFile As String
    Dim inputLine As String
    Dim sText As String
    Dim iFileNum As Integer
    Dim fileExist As Boolean

    ' Use current folder to avoid Windows-only paths
    sFile = "ActivationKey.txt"

    ' Check if file exists
    fileExist = FileThere(sFile)

    If fileExist = True Then
        On Error GoTo ErrRead
        iFileNum = FreeFile
        Open sFile For Input As iFileNum
        Line Input #iFileNum, inputLine
        Close #iFileNum
        
        serialKey = Val(inputLine)
        
        ' Optional debug:
        ' MsgBox "Activation key loaded: " & serialKey
        
    Else
        On Error GoTo ErrWrite
        serialKey = 123456 ' Default key
        sText = CStr(serialKey)
        
        iFileNum = FreeFile
        Open sFile For Output As iFileNum
        Print #iFileNum, sText
        Close #iFileNum
        
        ' Optional debug:
        ' MsgBox "Activation key file created with: " & sText
    End If

    Exit Sub

' Error handling for read/write
ErrRead:
    MsgBox "Error reading activation file: " & Err.Description, vbCritical
    serialKey = 123456
    Exit Sub

ErrWrite:
    MsgBox "Error writing activation file: " & Err.Description, vbCritical
    Exit Sub
End Sub



Function FileThere(FileName As String) As Boolean
    FileThere = (Dir(FileName) <> "")
End Function


Sub GetDiskSerial()
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set d = fs.GetDrive(fs.GetDriveName("c:"))
    ' A = Abs(d.SerialNumber) + 100 * Abs(d.SerialNumber) + 9000000000#
End Sub

Sub CheckSerial()
    ' x = A - Int(A / 26628926) * 26628926
'    x = Int((a / (82465 - 20)) + (82465 - 20))
     
   Active = True
        
   Worksheets("Input").Visible = xlSheetVisible
   Worksheets("JAF").Visible = xlSheetVisible
   Worksheets("REV").Visible = xlSheetVisible
   Worksheets("BOQ").Visible = xlSheetVisible
   Worksheets("RawMat").Visible = xlSheetVisible
   Worksheets("Detail").Visible = xlSheetVisible
   Worksheets("SAL").Visible = xlSheetVisible
   Worksheets("FCPBS").Visible = xlSheetVisible
   Worksheets("DB").Visible = xlSheetHidden
   Worksheets("MBSDB").Visible = xlSheetVisible
   Worksheets("SSDB").Visible = xlSheetVisible
   Worksheets("Recap").Visible = xlSheetVisible
   Worksheets("Main").Visible = xlSheetHidden
   Worksheets("Input").Activate
   
   ActivationForm.Hide
   UserForm1.Hide
   
End Sub

' requires a reference to the Microsoft Outlook 8.0 Object Library
Sub SendAnEmailWithOutlook()
    MsgBox "Bypassed email sending."
End Sub



Sub Get_Environmental_Variable()
'    ' Get Host Name / Get Computer Name
'    sHostName = Environ$("computername")
'    sHostName = Split(sHostName, "-")
'    sHostName2 = sHostName(0) & "-" & sHostName(1)
'    ' Get Current User Name
'    sUserName = Environ$("username")
End Sub

-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function CodeOf(desc)
      Sheet7.Range("D1") = desc
      CodeOf = Sheet7.Range("A1")
End Function
Sub Activation(x)
'    Set fs = CreateObject("Scripting.FileSystemObject")
'    Set d = fs.GetDrive(fs.GetDriveName("c:"))
'    A = Abs(d.SerialNumber) + 100 * Abs(d.SerialNumber) + 9000000000#
'    x = A - Int(A / 36648936) * 36648936
'
'
'    'MsgBox x
'    RegDate = GetSetting("ClipArtx", "BackGround", "Color")
'    If RegDate = "" Then RegDate = "1"
'
'    'Activated???
'        If x <> Sheet1.Range("Activation") Then
'          MsgBox "Your QuickEst is not activated! Please Send the following number to the head office to obtain an activation key: " & A
'          Sheet1.Range("Activation") = A
'          End
'        End If
'
'    ' 6 months expried???
'        If Now > CDate("31-DEC-2010") Then
'          MsgBox "Your QuickEst is expired! Please Send the file to Quickest@mammut.ae to extend the use! "
'          End
'        End If
'
'
'    SaveSetting "ClipArtx", "BackGround", "Color", Now
'    Sheet1.Range("C7") = "Program Jun-10-Rev-00 Dated 01 Jun 2010"
End Sub
Sub RecapInput(RangeName As String)
    Sheet1.Range(RangeName).EntireRow.Copy
    Sheet8.Range("RecapMark").EntireRow.Insert
    Sheet8.Range("RecapMark").Offset(-1 * Sheet1.Range(RangeName).Rows.Count, 0).EntireRow.PasteSpecial xlPasteValues
    Sheet8.Range("RecapMark").EntireRow.ClearContents
    Sheet8.Range("RecapMark").Offset(0, 2) = "=Input!C7"
End Sub

Sub InsertItem(No, DBCode, salesCode, CostCode, desc$, Size, unit$, Qty, PWt, PPr, SArea)
Sheet2.Range("ItemMark").EntireRow.Insert
Sheet2.Range("record").Copy
Sheet2.Range("ItemMark").Offset(-1, 0).PasteSpecial (xlPasteFormulas)

Sheet2.Range("ItemMark").Offset(-1, 0) = Sheet2.Range("ItemMark").Offset(-2, 0) + 1
Sheet2.Range("ItemMark").Offset(-1, 1) = DBCode
Sheet2.Range("ItemMark").Offset(-1, 2) = salesCode
Sheet2.Range("ItemMark").Offset(-1, 3) = CostCode
Sheet2.Range("ItemMark").Offset(-1, 4) = desc$
Sheet2.Range("ItemMark").Offset(-1, 5) = Size
Sheet2.Range("ItemMark").Offset(-1, 6) = unit$
Sheet2.Range("ItemMark").Offset(-1, 7) = Qty
Sheet2.Range("ItemMark").Offset(-1, 8) = PWt
Sheet2.Range("ItemMark").Offset(-1, 10) = PPr
Sheet2.Range("ItemMark").Offset(-1, 12) = SArea
Sheet2.Range("ItemMark").EntireRow.ClearContents
End Sub
Sub InsCode(Des, Code, salesCode, Size, Qty)

    
  If Des <> "" Then
    Sheet2.Range("ItemMark").EntireRow.Insert
    
    'added by hezron(09.19.2011)
    '================================================================================================
    'Default to black color
    Sheet2.Range("ItemMark").Offset(-1, 4).Font.Color = RGB(0, 0, 0)
    Sheet2.Range("ItemMark").Offset(-1, 10).Font.Color = RGB(0, 0, 0)
    Sheet2.Range("ItemMark").Offset(-1, 17).Font.Color = RGB(0, 0, 0)
    '================================================================================================
    
    Sheet2.Range("ItemMark").Offset(-1, 0) = Sheet2.Range("ItemMark").Offset(-2, 0) + 1
    Sheet2.Range("ItemMark").Offset(-1, 2) = salesCode
    Sheet2.Range("ItemMark").Offset(-1, 4) = Des
    Sheet2.Range("ItemMark").Offset(-1, 4).Font.Bold = True
  End If
  If Code <> "" Then
      Sheet2.Range("ItemMark").EntireRow.Insert
    
    'added by hezron(09.19.2011)
    '================================================================================================
    'Default to black color
    Sheet2.Range("ItemMark").Offset(-1, 4).Font.Color = RGB(0, 0, 0)
    Sheet2.Range("ItemMark").Offset(-1, 10).Font.Color = RGB(0, 0, 0)
    Sheet2.Range("ItemMark").Offset(-1, 17).Font.Color = RGB(0, 0, 0)
    '================================================================================================
    
      Sheet2.Range("ItemMark").Offset(-1, 4).Font.Bold = False
    
      Sheet2.Range("record").Copy
      Sheet2.Range("ItemMark").Offset(-1, 0).PasteSpecial (xlPasteFormulas)
      Sheet2.Range("ItemMark").Offset(-1, 0) = Sheet2.Range("ItemMark").Offset(-2, 0) + 1
      Sheet2.Range("ItemMark").Offset(-1, 1) = Code
      Sheet2.Range("ItemMark").Offset(-1, 2) = salesCode
      Sheet2.Range("ItemMark").Offset(-1, 5) = Size
      Sheet2.Range("ItemMark").Offset(-1, 7) = Qty
      
      'added by hezron(07.13.2011)
      '================================================================================================
      If Code = "SS3PI" Or Code = "SSTLA" Or Code = "SSRTT" Or Code = "SSUTT" Or Code = "SSWLI" _
        Or Code = "SSBUSCR" Or Code = "SSHRSCR" _
        Or Code = "SSSPP" Or Code = "SSFC1" Or Code = "SSFC2" Or Code = "SSFC3" Or Code = "SSFC4" Or Code = "SSFC5" _
        Or Code = "SSSPS" Or Code = "SSGAL" Or Code = "SSFC6" _
        Or Code = "SSFRST" Or Code = "SSFRCL" Or Code = "SSFRMISC" Or Code = "SSMFG" Or Code = "SSWELD" _
        Or Code = "SSMCR" Or Code = "SSMSL" Or Code = "SSMBP" Or Code = "SSMMS" Or Code = "SSSHB" Or Code = "SSSWB" _
        Or Code = "SSCD" Or Code = "SSLCC" Or Code = "SSOC" Or Code = "SSPCK" Or Code = "SSTRAN" _
        Or Code = "SSHRSCR1" Or Code = "SSHRSCR2" Or Code = "SSHRSCR3" Or Code = "SSHRSCR4" Or Code = "SSHRSCR5" _
        Or Code = "SSHRSCW2" Or Code = "SSHRSCU2" Or Code = "SSHRSCH2" Or Code = "SSHRSCA2" Or Code = "SSHRSCP2" _
        Or Code = "SSTUSCR1" Or Code = "SSTUSCR2" Or Code = "SSTUSCR3" Or Code = "SSHRLSCR1" _
        Or Code = "SSHRLSCR2" Or Code = "SSHRLSCR3" Or Code = "SSTRSCR1" Or Code = "SSTRSCR2" _
        Or Code = "SSTRSCR3" Or Code = "SSTRSCR4" Or Code = "SSTRSCR5" Or Code = "SSTRSCR6" _
        Or Code = "SSMCSCR" _
        Or Code = "SSSTRSCR" Or Code = "SSTRDSCR" Or Code = "SSLADSCR" Or Code = "SSCHQSCR" _
        Or Code = "SSGRTSCR" Or Code = "SSDCKSCR" _
        Or Code = "SSBUSCR1" Or Code = "SSBUSCR2" Or Code = "SSBUSCR3" Or Code = "SSBUSCR4" _
        Or Code = "SSBUSCR5" _
        Or Code = "SSPLSCR1" Or Code = "SSPLSCR2" Or Code = "SSPLSCR3" Or Code = "SSPLSCR4" _
        Or Code = "SSPLSCR5" Then

        Sheet2.Range("ItemMark").Offset(-1, 10) = 0
      End If
      '================================================================================================
        Sheet2.Range("ItemMark").EntireRow.ClearContents 'why?
  End If
    
End Sub
Function FixSep(Texti As String)
  Texto = Texti
  Dim Location As Integer
  While InStr(1, Texto, ":", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, ":", vbTextCompare), 1) = "@"
  Wend
  While InStr(1, Texto, "+", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "+", vbTextCompare), 1) = ","
  Wend
  While InStr(1, Texto, ";", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, ";", vbTextCompare), 1) = ","
  Wend
  'While InStr(1, Texto, "-", vbTextCompare) > 0
   'Mid(Texto, InStr(1, Texto, "-", vbTextCompare), 1) = ","
  'Wend
  While InStr(1, Texto, "/", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "/", vbTextCompare), 1) = ","
  Wend
  While InStr(1, Texto, "\", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "\", vbTextCompare), 1) = ","
  Wend
  While InStr(1, Texto, "'", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "'", vbTextCompare), 1) = ","
  Wend
  While InStr(1, Texto, "&", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "&", vbTextCompare), 1) = ","
  Wend
  While InStr(1, Texto, "X", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "X", vbTextCompare), 1) = "@"
  Wend
  While InStr(1, Texto, "x", vbTextCompare) > 0
   Mid(Texto, InStr(1, Texto, "x", vbTextCompare), 1) = "@"
  Wend

  FixSep = Texto
End Function

Function ConType(wplm) As Integer
    Select Case wplm
        Case Is <= 20
           ConType = 1 'AB16
        Case Is < 40
           ConType = 2 'AB20
        Case Is < 80
           ConType = 3 'AB24
        Case Is < 120
           ConType = 4 'AB30
        Case Is >= 120
           ConType = 5 'AB36
    End Select
End Function

'This function returns the number of bolts and its diameter set as a thumbrule
Function FixedBaseType(buildingWidth) As Variant

    Dim baseInfo(2) As Variant '0-connection type,1-number of bolts,2-bolt diameter
    
    If buildingWidth <= 15 Then 'FC8-20-20
        baseInfo(0) = 2
        baseInfo(1) = 8
        baseInfo(2) = 20
    ElseIf buildingWidth > 15 And buildingWidth <= 25 Then 'FC8-24-20
        baseInfo(0) = 3
        baseInfo(1) = 8
        baseInfo(2) = 24
    ElseIf buildingWidth > 25 And buildingWidth <= 35 Then 'FC16-24-25
        baseInfo(0) = 3
        baseInfo(1) = 16
        baseInfo(2) = 24
    ElseIf buildingWidth > 35 And buildingWidth <= 45 Then 'FC16-30-25
        baseInfo(0) = 4
        baseInfo(1) = 16
        baseInfo(2) = 30
    ElseIf buildingWidth > 45 And buildingWidth <= 50 Then 'FC16-36-25
        baseInfo(0) = 5
        baseInfo(1) = 16
        baseInfo(2) = 36
    ElseIf buildingWidth > 50 And buildingWidth <= 60 Then 'FC32-30-30
        baseInfo(0) = 4
        baseInfo(1) = 32
        baseInfo(2) = 30
    ElseIf buildingWidth > 60 Then  'FC32-36-40
        baseInfo(0) = 5
        baseInfo(1) = 32
        baseInfo(2) = 36
    End If
    
    FixedBaseType = baseInfo
    
End Function

Sub GetList(Texti As String, List() As Double)
   Texto = " " + FixSep(Texti) + ","
   n = 1
   i = 0
   tn = 0
   While InStr(i + 1, Texto, ",", vbTextCompare) > 0
     k = InStr(i + 1, Texto, ",", vbTextCompare)
     M = InStr(i + 1, Texto, "@", vbTextCompare)
     If M > i And M < k Then
       List(n, 0) = val(Mid$(Texto, i + 1, M - i))
       List(n, 1) = val(Mid$(Texto, M + 1, k - M))
     Else
       List(n, 0) = 1
       List(n, 1) = val(Mid$(Texto, i + 1, k - i))
     End If
     i = k
     List(0, 0) = n
     tn = tn + List(n, 0)
     n = n + 1
   Wend
   List(0, 1) = tn
End Sub
Sub GetCode(Code$)
   Sheet5.Range("a5").Value = Code$
   DBCode = Code$
salesCode = 1
CostCode = ""
desc$ = Sheet5.Range("d5")
Size = 1
unit$ = Sheet5.Range("f5")
PWt = Sheet5.Range("g5")
PPr = ""
SArea = ""
Call InsertItem(No, DBCode, salesCode, CostCode, desc$, Size, unit$, Qty, PWt, PPr, SArea)
'
End Sub
Function weight(ByVal Code As String) As Double
  Sheet7.Range("Code") = Code
  weight = Sheet7.Range("Code").Offset(0, 5)
End Function
Function DField(ByVal Code As String, Column As Integer) As Variant
  Sheet7.Range("Code") = Code
  DField = Sheet7.Range("Code").Offset(0, Column - 1)
End Function

Sub ExpList(List() As Double, ExList() As Double)
   ij = 0
   ReDim ExList(List(0, 1))
   ExList(0) = List(0, 1)
   For i = 1 To List(0, 0)
     For j = 1 To List(i, 0)
       ExList(ij + j) = List(i, 1)
     Next j
     ij = ij + List(i, 0)
   Next i
End Sub

-------------------------------------------------------------------------------
VBA MACRO ActivationDetails.vba 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/ActivationDetails'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub btnSend_Click()
    
    'collect activation details
    AuthorizationCode = txtAuthorizationCode.Text
    UserName = txtUserName.Text
    EmployeeNumber = txtEmployeeNumber.Text
    Department = txtDepartment.Text
    DivisionBranch = txtDivision.Text
    
    If txtAuthorizationCode.Text = "" Or txtUserName.Text = "" Or _
        txtEmployeeNumber.Text = "" Or txtDepartment.Text = "" Or txtDivision.Text = "" Then
        MsgBox "Please fill all values"
    Else
        'send the disk serial number to MBS-PRD
        ' Call SendAnEmailWithOutlook(A)
        ActivationDetails.Hide
        ActivationForm.Show
    End If
    
End Sub

Private Sub UserForm_Terminate()
    ThisWorkbook.Close SaveChanges:=True
End Sub

-------------------------------------------------------------------------------
VBA MACRO ActivationForm.vba 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/ActivationForm'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub btnActivate_Click()
    'save the activation key to local directory
    If txtActivationKey.Text = "" Then
        MsgBox "Please provide a valid key", vbCritical, "Invalid key"
    Else
        Call WriteToATextFile
    End If
End Sub

Sub WriteToATextFile()
    
    isKeyRequestSentOnce = True
    
    'Dim sFile As String
    'Dim sText As Long
    'Dim iFileNum As Integer
    
    'first set a string which contains the path to the file you want to create.
    'this example creates one and stores it in the root directory
    'sFile = "C:\QuickEst\ActivationKey.txt"
    
    'get the activation key from the text box
    'On Error GoTo ErrHandler:
   ' sText = CLng(txtActivationKey.Value)
    
    'set and open file for output
    'iFileNum = FreeFile
    'Open sFile For Output As iFileNum
    
    'write project info
    'Write #iFileNum, sText
    
    'close the file
    'Close #iFileNum
    
    'Open key file and get the serial key
    'Call ProgramActivation.OpenKeyFile
    
    'get the serial number of hard disk
    'Call ProgramActivation.GetDiskSerial
    
    'Check if the serial key is valid
    Call ProgramActivation.CheckSerial
        
ErrHandler:
    If Err.Number = 13 Then
        MsgBox "Please provide a valid key", vbCritical, "Invalid key"
    End If

End Sub

Private Sub txtActivationKey_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)
    txtActivationKey.Text = ""
    txtActivationKey.ForeColor = black
End Sub

Private Sub UserForm_Terminate()
    If Active = True Then
        ActivationForm.Hide
        UserForm1.lblActivationStatus.Visible = False
        UserForm1.Show
    Else
        ThisWorkbook.Close SaveChanges:=True
    End If
End Sub

-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Workbook_Open()

'    'Call Sheet2.Activate
'    'Call Sheet1.InputExample
    
    'Call AddReference
    
    'isKeyRequestSentOnce = False

    'Open key file and get the serial key
    'Call ProgramActivation.OpenKeyFile

    'get the serial number of hard disk
    'Call ProgramActivation.GetDiskSerial

    'Check if the serial key is valid
    Call ProgramActivation.CheckSerial
    
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Call RemoveReference
End Sub

Private Sub AddReference()
'    On Error Resume Next

    'add outlook 2003 reference
    On Error GoTo loadRef
    ThisWorkbook.VBProject.References.AddFromGuid "{00062FFF-0000-0000-C000-000000000046}", 9, 2

    'add scripting reference
'    ThisWorkbook.VBProject.References.AddFromGuid "{420B2830-E718-11CF-893D-00A0C9054228}", 1, 0

loadRef:
    If Err.Number = 1004 Then
        MsgBox "Please select Tools\Macro\Security.Select the Trusted Publishers tab then check Trust access to Visual Basic Project checkbox then click Ok", vbInformation, "Macro Security Settings"
    End If
End Sub

Private Sub RemoveReference()
    Dim x As Object
    n = Application.VBE.ActiveVBProject.References.Count

    Do While Application.VBE.ActiveVBProject.References.Count > 0 And n > 0
        On Error Resume Next
        Set x = Application.VBE.ActiveVBProject.References.Item(n)
        Y = x.Name
        If Y = "Outlook" Then 'Or Y = "Scripting" Then 'Outlook,Scripting,MSForms,Excel,VBA
            Application.VBE.ActiveVBProject.References.Remove x
        End If
        n = n - 1
    Loop
End Sub

-------------------------------------------------------------------------------
VBA MACRO Sheet3.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub DeleteCode_Click()
 DelCode = InputBox("Enter Sales Code to Delete : ", "Delete Sales Code")
 If DelCode <> "" Then
   Sheet2.Activate
   Sheet2.Range("ItemStart").Offset(0, 2).ClearContents
   Sheet2.Range("ItemMark").Offset(0, 2).ClearContents
   Do Until Sheet2.Range("SalesCodes").Find(DelCode) Is Nothing
     Sheet2.Range("SalesCodes").Find(DelCode).EntireRow.Delete
   Loop
   Sheet3.Activate
 End If
End Sub



-------------------------------------------------------------------------------
VBA MACRO Sheet10.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet10'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet9.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet9'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Private Sub Worksheet_Activate()
'    ThisWorkbook.Names("MakDB").Delete
'End Sub
'
''Private Sub Worksheet_Change(ByVal Target As Range)
''    On Error GoTo ErrHandler
''    ThisWorkbook.Names("MakDB").Delete
''
''ErrHandler:
''    If Err.Number = 1004 Then
''        'ThisWorkbook.Close SaveChanges:=True
''    End If
''End Sub
'
'Private Sub Worksheet_Deactivate()
'    ThisWorkbook.Names.Add Name:="MakDB", RefersTo:=Worksheets("MakDB").Range("A5:P579")
'End Sub

-------------------------------------------------------------------------------
VBA MACRO Sheet7.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet7'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Private Sub Worksheet_Activate()
'    ThisWorkbook.Names("MakDB").Delete
'End Sub
'
''Private Sub Worksheet_Change(ByVal Target As Range)
''    On Error GoTo ErrHandler
''    ThisWorkbook.Names("MakDB").Delete
''
''ErrHandler:
''    If Err.Number = 1004 Then
''        'ThisWorkbook.Close SaveChanges:=True
''    End If
''End Sub
'
'Private Sub Worksheet_Deactivate()
'    ThisWorkbook.Names.Add Name:="MakDB", RefersTo:=Worksheets("MakDB").Range("A5:P579")
'End Sub

-------------------------------------------------------------------------------
VBA MACRO Sheet5.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet5'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet4.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'*****************************************************************************************************'
' Added by Gerwin - July 29, 2012

Dim isTrue As Boolean
Dim oValue As String




Private Sub Worksheet_SelectionChange(ByVal Target As Range)

    If Target.address = "$S$3" Then
        oValue = Worksheets("FCPBS").Range("S3").Value
    Else
        If oValue = "" Then
            oValue = Worksheets("FCPBS").Range("S3").Value
        Else
        
            If oValue <> Worksheets("FCPBS").Range("S3").Value Then
            
               If IsCellBlank = False Then
               
                    Dim cVal As Double
                    cVal = Worksheets("FCPBS").Range("Q22").Value
                    
                    If cVal <= 4410 Then
                         Worksheets("FCPBS").Range("S3").Value = oValue
                         MsgBox "The selling price is below USD 1200, please use higher markup!"
                    End If
                    
               End If
               
            End If
            
        End If
    End If
    
End Sub



Private Function checkValue() As Boolean
    Dim cellVal As Double
    
    If IsCellBlank = False Then
    
        cellVal = Worksheets("FCPBS").Range("Q22").Value
        
        If cellVal < 4410 Or cellVal = 4410 Then
            checkValue = True
        Else
            checkValue = False
        End If
    End If
     
End Function

Private Function IsCellBlank() As Boolean

    If IsEmpty(Worksheets("FCPBS").Range("Q22")) Then
        IsCellBlank = True
    ElseIf Worksheets("FCPBS").Range("Q22") = "" Then
        If Worksheets("FCPBS").Range("Q22").HasFormula Then
            IsCellBlank = True
        End If
    Else
        IsCellBlank = False
    End If
    
End Function

'*****************************************************************************************************'



Private Sub ExportToERP_Click()
On Error GoTo CloseFile
Dim FileName As String
Dim FDate As Date
Dim FYear As Integer, JobBldg As String, ContractDate As String, Job As String, ContractValue As String
Dim erpCode As Long, Qty As Double, Rate As Double, unit As String

'---------------------------------------
Dim Mat_Cost As Double
Dim Prod_Cost As Double
Dim OH_Cost As Double
Dim MQty As String

FileName = Range("H2").Value & "-" & Range("I2").Value & "-" & Range("L2").Value & "Rev" & Range("O4").Value & ".csv"
FileName = "c:\fcpbs\" & FileName

'Checking input conditions
    '1) Job_No
        If Not IsNumeric(Range("I2").Value) Then
            MsgBox "Job Number is not valid, Kindly check your FCPBS.Cell(""I2"")", vbCritical
            Range("I2").Select
            Exit Sub
        End If
    ' Building No
        If Not IsNumeric(Range("L2").Value) Then
            MsgBox "Building Number is not valid, Kindly check your FCPBS.Cell(""L2"")", vbCritical
            Range("L2").Select
            Exit Sub
        End If
    'Estimated Date
        If Not IsDate(Range("O2").Value) Then
            MsgBox "Estimated Date is not valid, Kindly check your FCPBS.Cell(""O2"")", vbCritical
            Range("O2").Select
            Exit Sub
        End If
    
'check filename exists on HDD or not
    If Dir(FileName) <> "" Then
         If MsgBox("This file name: " & FileName & " exists in Folder C:\FCPBS\.... ! Do you want to replace it? ", vbYesNo) = vbNo Then
            Exit Sub
        End If
    End If
    
Open FileName For Output As #1
FDate = CDate(Range("O2"))
FYear = Year(FDate)
A = Month(FDate)
If A < 4 Then FYear = FYear - 1
JobBldg = Left((Right(Range("I2"), 4) & "-" & Range("L2") & "          "), 10)
ContractDate = Format(FDate, "dd-mm-yyyy")
Job = Range("H2").Value & "-" & Range("I2").Value & "    "
Job = Left(Job, 9)
ContractValue = Format(CDbl(Range("ContractValue")), "000000000000.00")

'First Line
'1,Year_No,Job-Building,Date,Jobno,Total_Contract_Price

Print #1, "1,"; Format(FYear, "####"); ","; JobBldg; ","; ContractDate; ","; Job; ","; ContractValue

      'Process Each Line
        For i = 1 To 112
        erpCode = CLng(Range("E7").Offset(i, 0).Value)
        If erpCode > 0 Then
          Qty = CDbl(Range("H7").Offset(i, 0))
           
          If Qty > 0 Then
             Rate = CDbl(Range("Q7").Offset(i, 0))
                
                'added by Do Nguyen
                'add more code
                'Mat_Cost     =   Material Cost
                'Prod_Cost    =   Manufg Cost
                'OH_Cost      =   Overhead Cost
                SQty = Left(CStr(Format(Qty / 1000, "##,##0.000000")) & "                ", 15)
                Mat_Cost = CDbl(Range("J7").Offset(i, 0)) * 1000 / Qty
                Prod_Cost = CDbl(Range("K7").Offset(i, 0)) * 1000 / Qty
                OH_Cost = CDbl(Range("L7").Offset(i, 0)) * 1000 / Qty
                MQty = CStr(Range("G7").Offset(i, 0))
                   
          Else
             Qty = 1
             Rate = CDbl(Range("O7").Offset(i, 0))
                'added by Do Nguyen
                'add more code
                'Mat_Cost     =   Material Cost
                'Prod_Cost    =   Manufg Cost
                'OH_Cost      =   Overhead Cost
                SQty = Left(CStr(Qty) & "                ", 15)
                Mat_Cost = CDbl(Range("J7").Offset(i, 0))
                Prod_Cost = CDbl(Range("K7").Offset(i, 0))
                OH_Cost = CDbl(Range("L7").Offset(i, 0))
                MQty = CStr(Range("G7").Offset(i, 0))
                
          End If
          SRate = Left(CStr(Rate) & "                ", 15)
          SMat_Cost = Left(CStr(Mat_Cost) & "                ", 15)
          SProd_Cost = Left(CStr(Prod_Cost) & "                ", 15)
          SOH_Cost = Left(CStr(OH_Cost) & "                ", 15)
          SMQTY = Left(CStr(MQty) & "                ", 15)
          
          
          'second line
          '2,Year_no,Item_no,Qty,Price,Mat_Cost,Prod_Cost,OH_Cost,MQty
  
  If Rate > 0 Then Print #1, "2,"; Format(FYear, "####"); ","; Format(erpCode, "000000"); ","; SQty; ","; SRate; ","; SMat_Cost; ","; SProd_Cost; ","; SOH_Cost; ","; SMQTY
  
End If
Next i

CloseFile:
If Err Then
  MsgBox (Error(Err))
Else
  MsgBox "Exported to file: " & FileName
End If
Close #1
End Sub







-------------------------------------------------------------------------------
VBA MACRO Sheet8.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet8'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub DeleteRecap_Click()
Do Until Sheet8.Range("RecapMark").address = "$A$7"
 Sheet8.Range("RecapMark").Offset(-1, 0).EntireRow.Delete
Loop
End Sub

Private Sub TransferToOffer_Click()
      ' Variables.
      Dim WordRunning As Boolean
      Dim Word As Object
      
      ' Used for error trapping.
      On Error Resume Next
      Err.Clear
         ' Checks to see if Word is running.
         Set Word = GetObject(, "Word.Application.8")

         If Err.Number <> 0 Then
            WordRunning = False
         Else
            WordRunning = True
         End If

         ' Reset the error variable.
         Err.Clear

         ' Create a Word object.
         If WordRunning = False Then
            Set Word = CreateObject("Word.Application.8")
         End If

         If Err.Number <> 0 Then
            MsgBox "Unable to start Word. " _
               & "This Macro requires Microsoft Word " _
               & "Make sure Word is running correctly and " _
               & "then attempt to run the macro again. " _
               , vbCritical _
               , "Failed to launch Word"
            End
         End If

         ' Creates a new Word document based on normal.
        ' word.Documents.Add

         ' Copy all the organization chart text to Word.
            Word.Selection.TypeText Text:="Hi Baby"
         
            Word.Selection.TypeParagraph
         Word.Selection.Paste

      ' Make Word visible if not.
      If WordRunning = False Then
         Word.Application.Visible = True
      End If

      ' A message indicating the macro is finished running.
      MsgBox "Organization Chart text extracted " _
         & "to a Word document"

End Sub


-------------------------------------------------------------------------------
VBA MACRO Sheet38.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet38'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet2.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Text Comparison(Case insensitive comparison)
Option Compare Text

Dim Flag As Integer
Private Sub AddLine_DropButtonClick()
Call Activation(x)
If Flag = 1 Then
  If AddLine.Value <> "" Then
    Sheet2.Range("ItemMark").EntireRow.Insert
    Sheet2.Range("ItemMark").Offset(-1, 4).Font.Bold = False
    Sheet2.Range("record").Copy
    Sheet2.Range("ItemMark").Offset(-1, 0).PasteSpecial (xlPasteFormulas)
    Sheet2.Range("ItemMark").Offset(-1, 0) = Sheet2.Range("ItemMark").Offset(-2, 0) + 1
    Sheet2.Range("ItemMark").Offset(-1, 1) = AddLine.Value
    Sheet2.Range("ItemMark").EntireRow.ClearContents
  End If
  Flag = 0
Else
  Flag = 1
End If
End Sub

Private Sub btnCreatePhaseNumber_Click()
    Call QuickEstCalculations.GetPhaseNumberFromMAKDB
End Sub

Private Sub DelAll_Click()
 Del_All = MsgBox("This action will delete all areas and components in this estimate project. Are you sure you want to delete everything?", 305)
 If Del_All = 1 Then
 Sheet2.EnableCalculation = False
 Do Until Sheet2.Range("ItemMark").Name = "=Detail!$A$10"
   Sheet2.Range("ItemMark").Offset(-1, 0).EntireRow.Delete
 Loop
 Sheet2.EnableCalculation = True
 End If
 Do Until Sheet8.Range("RecapMark").address = "$A$7"
 Sheet8.Range("RecapMark").Offset(-1, 0).EntireRow.Delete
Loop

Sheet4.Unprotect ("ResearcH[20.19.5.11.3.9.21.17]")
    Sheet4.Range("F48").Value = "Single Skin Panels (Aluminum)"
    Sheet4.Range("F49").Value = "Single Skin Panels (Steel)"
    Sheet4.Range("F50").Value = "Ridge panels, curved  Eaves (Aluminum)"
    Sheet4.Range("F51").Value = "Ridge panels, curved Eaves(Steel)"
    Sheet4.Range("F56").Value = "Sandwich Panels (Aluminum)"
    Sheet4.Range("F57").Value = "Sandwich Panels (Steel)"
Sheet4.Protect ("ResearcH[20.19.5.11.3.9.21.17]")
End Sub

Private Sub ExportData_Click()
 FileName$ = "C:\FCPBS\" & InputBox("Name of Export Data File (*.csv):", "File Name", "QEData")
 Open FileName$ For Output As #1
 i = 0
 Do Until Range("ItemStart").Offset(i, 0).address = Range("ItemMark").address
 'MsgBox Range("ItemMark").Offset(i, 0).Address
  SrNo = Range("ItemStart").Offset(i, 0).Value
  DBCode = Range("ItemStart").Offset(i, 1).Value
  salesCode = Range("ItemStart").Offset(i, 2).Value
  description = Range("ItemStart").Offset(i, 4).Value
  Measure = Range("ItemStart").Offset(i, 5).Value
  Qty = Range("ItemStart").Offset(i, 7).Value
  Write #1, SrNo, DBCode, salesCode, description, Measure, Qty
  i = i + 1
 Loop
 Close #1
 
 
End Sub

Private Sub ImportData_Click()
Dim matType As String
Dim SrNo, DBCode, salesCode, description, Measure As Double, Qty As Double
Sheet2.EnableCalculation = False
 FileName$ = "C:\FCPBS\" & InputBox("Enter Name of Data File (*.csv):", "File Name", "QEData")
 
 NewSalesCode = InputBox("Enter New Sales Code (type * to keep Sales Codes as in imported file):", "Sales Code:", "*")
 Open FileName$ For Input As #1
        
        'Turn Off auto Calculation
        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False
                
 While Not EOF(1)
        'start importing
        DoEvents
        Input #1, SrNo, DBCode, salesCode, description, Measure, Qty
        If NewSalesCode <> "*" Then salesCode = NewSalesCode
        If DBCode = "" Then
         desc$ = description
        Else
         Call InsCode(desc$, DBCode, salesCode, Measure, Qty)
        
        Select Case DBCode
'added by hezron on 08/18/2010-----------------------------------------------------------------------------------------
            'outer skin
            Case "S5CT", "S5LZ", "S5STD", "S5OW", "S7CT", "S7OW", "S7STD"
                Sheet2.Range("ItemMark").Offset(-1, 3) = 20211
                matType = "AZ"
            Case "A7MF", "A7OW", "A7STD"
                Sheet2.Range("ItemMark").Offset(-1, 3) = 20111
                matType = "AL"
                
            'PU core
            Case "Core35BPro", "Core50BPro", "Core75BPro", "Core100BPro", "Core35CPro", "Core50CPro", "Core75CPro", "Core100CPro", _
            "Core35BEco", "Core50BEco", "Core75BEco", "Core100BEco", "Core35CEco", "Core50CEco", "Core75CEco", "Core100CEco", _
            "ISAF", "ISA5", "ISS5", "ISS4"
                If matType = "AZ" Then
                    Sheet2.Range("ItemMark").Offset(-2, 3) = 20411
                    Sheet2.Range("ItemMark").Offset(-1, 3) = 20411
                Else
                    Sheet2.Range("ItemMark").Offset(-2, 3) = 20311
                    Sheet2.Range("ItemMark").Offset(-1, 3) = 20311
                End If
        End Select
'----------------------------------------------------------------------------------------------------------------------
            
         desc$ = ""
        End If
 Wend
 Close #1
 
        'Turn ON auto Calculation
        Sheet2.EnableCalculation = True
        Sheet3.EnableCalculation = True
        Sheet4.EnableCalculation = True

End Sub

Private Sub btnGenerate_Click()
    Call CheckBlankEntry
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    'MsgBox "hi"
    'Formatting.RenumberItems (Target)
End Sub


-------------------------------------------------------------------------------
VBA MACRO Sheet17.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet17'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet11.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet11'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet1.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
 Dim ln(139) '91
Public bldgWidth As Variant
Public bldgLength As Variant

Public roofSWPCode As String 'added by hezron on 04/26/2012
Public wallSWPCode As String 'added by hezron on 04/26/2012

Public containerFactor As Double 'added by hezron on 05/20/2012
Public containerFactor1 As Double 'added by hezron on 05/20/2012
Public containerFactor2 As Double 'added by hezron on 05/20/2012

Dim coatableArea As Variant, roofCoatableArea As Variant, wallCoatableArea As Variant

 Sub InputExample() 'Declare and fills variables
    noData = True
    
    Sheet2.Activate
        
    Dim oFSO As New FileSystemObject
    Dim oFS As TextStream
    
    'Read text file
    Set oFS = oFSO.OpenTextFile("C:\ePIF-QuickEst\Input Variables.txt")

    'Declare a counter
    Dim i As Integer
    i = 0
    
    'Read every line in the text file and store it in a variable
    Do Until oFS.AtEndOfStream
        sText = oFS.ReadLine
        i = i + 1
        ln(i) = sText
    Loop

    'Closing the textStream and release the references
    oFS.Close
    Set oFSO = Nothing
    Set oFS = Nothing
    
    Sheet2.Range("E1").Value = ln(1)
    Sheet2.Range("E2").Value = ln(2)
    Sheet2.Range("E3").Value = ln(3)
    Sheet2.Range("F1").Value = ln(4)
    Sheet2.Range("F2").Value = ln(5)
    
    Call AddArea_Click
    Call AddGeneral_Click
    Call AddAcc_Click
    Call AddMezz_Click
    Call AddCrane_Click
    Call AddPartition_Click
    Call AddCanopy_Click
    
   'Call AddMonitor_Click (NOT INCLUDED)
   'Call MakeHTM
   
    noData = False
End Sub

Private Sub CommandButton2_Click()  '
    Call InputExample
End Sub

Private Sub Acc_Change()

End Sub

Private Sub AddAcc_Click()

Dim code2 As String

'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)
        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False
        
  Dim Code(5) As String, desc(5) As String, Qty(5) As Integer
  desc(0) = Sheet1.Range("AccDes")
  salesCode = Sheet1.Range("AccDes").Offset(0, 2)
  Sheet2.Activate
    For i = 1 To 5
     desc(i) = Sheet1.Range("AccDes").Offset(i, 0)
     Qty(i) = Sheet1.Range("AccDes").Offset(i, 2)
     If desc(i) <> "" And Qty(i) > 0 Then
      Sheet7.Range("D1") = desc(i)
      Code(i) = Sheet7.Range("A1")
      If Code(i) <> "" Then Call InsCode(desc(0), Code(i), salesCode, 1, Qty(i)): desc(0) = ""
     End If
    Next i
    
    '*********************added by hezron***********************************
    'GI Wiremesh
    For j = 1 To 5
        If InStr(Sheet1.Range("AccDes").Offset(j, 0).Value, " Skylight") > 0 Then
            Select Case Sheet1.Range("AccDes").Offset(j, 0).Value
              Case " Skylight 3250mm (GRP,Single Skin )", _
              " Skylight 3250mm (GRP, Double Skin 35 mm thk)", _
              " Skylight 3250mm (GRP, Double Skin 50 mm thk)", _
              " Skylight 3250mm (GRP, Double Skin 75 mm thk)", _
              " Skylight 3250mm (GRP, Double Skin 100 mm thk)"
                  Dim meshQty As Double
                  meshQty = Sheet1.Range("AccDes").Offset(j, 2).Value   'qty of Skylight
                  meshQty = meshQty * 3.8 * 1.219 'total area of Skylight
                  Call InsCode("", "WRM", 1, 1, Round(meshQty, 2))
            End Select
            Exit For
        End If
    Next
    
    '****************************added by hezron*********************************
    'get sliding door surface area & quantity
    Dim doorArea As Double
    
    'Generate Sandwich Panel Combination Database Record.
    WallTopSkin$ = Sheet1.Range("WallTopSkin")
    WallCore$ = Sheet1.Range("WallCore")
    WallBotSkin$ = Sheet1.Range("WallBotSkin")
    WSCode = WallTopSkin$
    
    WSCode = "PU" & WallTopSkin$ & WallCore$ & WallBotSkin$
    code2 = WSCode

    For j = 1 To 5
        If InStr(Sheet1.Range("AccDes").Offset(j, 0).Value, "Slide door") > 0 And Sheet1.Range("AccDes").Offset(j, 2).Value <> "" Then
            Select Case Sheet1.Range("AccDes").Offset(j, 0).Value
              Case "Slide door 3mX3m Steel Only with Framed Opening (Top Sliding)", "Slide door 3mX3m Steel Only with Framed Opening (Top Sliding) (35 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Top Sliding) (50 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Top Sliding) (75 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Top Sliding) (100 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Dual Sliding)", "Slide door 3mX3m Steel Only with Framed Opening (Dual Sliding) (35 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Dual Sliding) (50 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Dual Sliding) (75 SWP)", "Slide door 3mX3m Steel Only with Framed Opening (Dual Sliding) (100 SWP)"
                doorArea = 9 * Sheet1.Range("AccDes").Offset(j, 2).Value
              Case "Slide door 4mX4m Steel Only with Framed Opening (Top Sliding)", "Slide door 4mX4m Steel Only with Framed Opening (Top Sliding) (35 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Top Sliding) (50 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Top Sliding) (75 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Top Sliding) (100 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Dual Sliding)", "Slide door 4mX4m Steel Only with Framed Opening (Dual Sliding) (35 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Dual Sliding) (50 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Dual Sliding) (75 SWP)", "Slide door 4mX4m Steel Only with Framed Opening (Dual Sliding) (100 SWP)"
                doorArea = 16 * Sheet1.Range("AccDes").Offset(j, 2).Value
              Case "Slide door 5mX5m Steel Only with Framed Opening (Top Sliding)", "Slide door 5mX5m Steel Only with Framed Opening (Top Sliding) (35 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Top Sliding) (50 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Top Sliding) (75 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Top Sliding) (100 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Dual Sliding)", "Slide door 5mX5m Steel Only with Framed Opening (Dual Sliding) (35 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Dual Sliding) (50 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Dual Sliding) (75 SWP)", "Slide door 5mX5m Steel Only with Framed Opening (Dual Sliding) (100 SWP)"
                doorArea = 25 * Sheet1.Range("AccDes").Offset(j, 2).Value
              Case "Slide door 6mX6m Steel Only with Framed Opening (Top Sliding)", "Slide door 6mX6m Steel Only with Framed Opening (Top Sliding) (35 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Top Sliding) (50 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Top Sliding) (75 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Top Sliding) (100 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Dual Sliding)", "Slide door 6mX6m Steel Only with Framed Opening (Dual Sliding) (35 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Dual Sliding) (50 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Dual Sliding) (75 SWP)", "Slide door 6mX6m Steel Only with Framed Opening (Dual Sliding) (100 SWP)"
                doorArea = 36 * Sheet1.Range("AccDes").Offset(j, 2).Value
            End Select
                'bill out door sheeting
            If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
                Call InsCode("Door Sheeting", "-", 1, "", "")
                Call InsCode("Mammut SWP Code: " & code2, WallTopSkin$, 1, 1, doorArea)
                Call InsCode("", WallCore$, 1, 1, doorArea)
                Call InsCode("", WallBotSkin$, 1, 1, doorArea)
                Call InsCode("" & code2, "-", 1, "", "")
            Else
                Call InsCode("Door Sheeting", WallTopSkin$, 1, 1, doorArea)
            End If
            Exit For
        End If
    Next


'*****************************************************************************
    
    Call InsCode("", "-", salesCode, "", "")
    Call RecapInput("Accessories")
        
    Sheet2.EnableCalculation = True
    Sheet3.EnableCalculation = True
    Sheet4.EnableCalculation = True
    
    Sheet1.Activate
    
'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic

'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub


Private Sub AddArea_Click()
'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)


Sheet7.Unprotect ("prd82465")

'ERP Code of Sandwich Panels
Dim SWP_ERP_CODE As String
    SWP_ERP_CODE = ""
    
SP$ = Sheet1.Range("AreaDesc").Offset(1, 0)
by$ = Sheet1.Range("AreaDesc").Offset(3, 0)
SL$ = Sheet1.Range("AreaDesc").Offset(2, 0)
BEH = Sheet1.Range("AreaDesc").Offset(4, 0)
FEH = Sheet1.Range("AreaDesc").Offset(5, 0)
FrType$ = Sheet1.Range("AreaDesc").Offset(6, 0)
MinThick = CDbl(Sheet1.Range("AreaDesc").Offset(6, 2))
mwplm = Sqr(MinThick / 3.5) * 18.5
BaseType$ = Sheet1.Range("AreaDesc").Offset(7, 0)
DblWld$ = Sheet1.Range("AreaDesc").Offset(7, 2)
lewcs$ = Sheet1.Range("AreaDesc").Offset(8, 0)
LEType$ = Sheet1.Range("AreaDesc").Offset(8, 2)
rewcs$ = Sheet1.Range("AreaDesc").Offset(9, 0)
REType$ = Sheet1.Range("AreaDesc").Offset(9, 2)
NRSagRods = Sheet1.Range("AreaDesc").Offset(10, 2)
NWSagRods = Sheet1.Range("AreaDesc").Offset(11, 2)
'****************************added by hezron*********************************
roofSagRodDia = Sheet1.Range("AreaDesc").Offset(10, 4)
wallSagRodDia = Sheet1.Range("AreaDesc").Offset(11, 4)
'*****************************************************************************
BUFinish = Sheet1.Range("AreaDesc").Offset(1, 2)
CFFinish = Sheet1.Range("AreaDesc").Offset(2, 2)
BrType$ = Sheet1.Range("AreaDesc").Offset(3, 2)

If CStr(CFFinish) = "Alu/Zinc" Or CStr(CFFinish) = "Galvanized" Then
   Sheet5.Range("CFFinish") = 4
Else
   Sheet5.Range("CFFinish") = 3
End If

Dead = Sheet1.Range("AreaDesc").Offset(16, 0)
LiveP = Sheet1.Range("AreaDesc").Offset(17, 0)
LiveF = Sheet1.Range("AreaDesc").Offset(18, 0)
AddLoad = Sheet1.Range("AreaDesc").Offset(19, 0)
TLoadP = Dead + LiveP + AddLoad
TLoadF = Dead + LiveF + AddLoad
Wind = Sheet1.Range("AreaDesc").Offset(20, 0)
Wind = Wind ^ 2 / 20000
Dim Spans(100, 1) As Double, Bays(100, 1) As Double
Dim slopes(100, 2) As Double
Dim LWCS(100, 1) As Double, RWCS(100, 1) As Double
Dim ExList() As Double
Dim MFC(5) 'main frame connection counters
Dim MFB(5) 'Bolt size counter
Dim MFAB(5) 'Anchor Bolt Counter
Call GetList(SP$, Spans())
Call GetList(by$, Bays())
Call GetList(SL$, slopes())
Call GetList(lewcs$, LWCS())
Call GetList(rewcs$, RWCS())

wid = 0#
leng = 0#

Nspans = 0
nbays = 0
nlwcs = 0
nrwcs = 0

For i = 1 To 100
  wid = wid + Spans(i, 0) * Spans(i, 1)  'Area Width
  leng = leng + Bays(i, 0) * Bays(i, 1)  'Area Length
  Nspans = Nspans + Spans(i, 0)
  nbays = nbays + Bays(i, 0)
  nlwcs = nlwcs + LWCS(i, 0)
  nrwcs = nrwcs + RWCS(i, 0)
Next i
   
bldgWidth = wid 'add by hezron on 08/17/2010
bldgLength = leng 'add by hezron on 08/17/2010
    
Sleng = 0#
rafleng = 0#
EWArea = 0#
Peak = 0#
slopes(0, 2) = BEH
For i = 1 To 100
  If slopes(i, 0) = 1 Then slopes(i, 0) = wid / 2
  Sleng = Sleng + slopes(i, 0)
  rafleng = rafleng + Sqr(1 + slopes(i, 1) ^ 2) * slopes(i, 0)
  'calculate heights at slope changes [slopes(i,2)]
  slopes(i, 2) = slopes(i - 1, 2) + slopes(i, 0) * slopes(i, 1)
  If slopes(i, 2) > Peak Then Peak = slopes(i, 2)
  EWArea = EWArea + (slopes(i - 1, 2) + slopes(i, 2)) * slopes(i, 0) / 2
Next i

'match slopes and width, calculate last slope
n = slopes(0, 0)
If Sleng < wid Then
   n = n + 1
   slopes(0, 0) = n
   slopes(n, 0) = wid - Sleng
   slopes(n, 1) = (FEH - slopes(n - 1, 2)) / slopes(n, 0)
   slopes(n, 2) = FEH
   EWArea = EWArea + (slopes(n - 1, 2) + slopes(n, 2)) * slopes(n, 0) / 2
   rafleng = rafleng + Sqr(1 + slopes(n, 1) ^ 2) * slopes(n, 0)
End If
ReDim BaySize(nbays) As Double
ReDim MFWeight(nbays) As Double
ReDim inCol(Nspans, 1) As Double
ReDim LInCol(nlwcs, 1) As Double
ReDim RInCol(nrwcs, 1) As Double

'calculate Individual Bay Sizes
Call ExpList(Bays(), BaySize())

'calculate Main Frame Individual Spans
Call ExpList(Spans(), ExList())
For i = 1 To ExList(0)
  inCol(i, 0) = ExList(i)
Next i

'Left Endawall spans
Call ExpList(LWCS(), ExList())
For i = 1 To LWCS(0, 1)
     LInCol(i, 0) = ExList(i)
Next i

'Right Endwall Spans
Call ExpList(RWCS(), ExList())
For i = 1 To RWCS(0, 1)
     RInCol(i, 0) = ExList(i)
Next i
nslopes = slopes(0, 0)

'Calculate Main Frame Int. Column Heights (At Roof Steel line)
dspan = 0
For i = 1 To Nspans
  dspan = dspan + inCol(i, 0)
  dslope = 0
  For j = 1 To nslopes
    dslope = dslope + slopes(j, 0)
    If dspan <= dslope Then
      inCol(i, 1) = slopes(j, 2) - (dslope - dspan) * slopes(j, 1)
      A = 0
      Exit For
    End If
  Next j
Next i

'Calculate Left Endwall Column Heights
dspan = 0
For i = 1 To nlwcs
  dspan = dspan + LInCol(i, 0)
  dslope = 0
  For j = 1 To nslopes
    dslope = dslope + slopes(j, 0)
    If dspan <= dslope Then
      LInCol(i, 1) = slopes(j, 2) - (dslope - dspan) * slopes(j, 1)
      Exit For
    End If
  Next j
Next i

'Calculate Right Endwall Column Heights
dspan = 0
For i = 1 To nrwcs
  dspan = dspan + RInCol(i, 0)
  dslope = 0
  For j = 1 To nslopes
    dslope = dslope + slopes(j, 0)
    If dspan <= dslope Then
      RInCol(i, 1) = slopes(j, 2) - (dslope - dspan) * slopes(j, 1)
      Exit For
    End If
  Next j
Next i

'Calculate number of Peaks and Valleys
nPeaks = 0
nValeys = 0
For i = 1 To n - 1
  If n > 1 Then
   If slopes(i, 1) > slopes(i + 1, 1) Then nPeaks = nPeaks + 1
   If slopes(i, 1) < slopes(i + 1, 1) Then nValeys = nValeys + 1
  End If
Next i
'Read openings
TotOpWid = 0
Dim OpLoc(9), OpWid(9), OpHt(9), OpPur(9), OpBr(9)
FSWOpenings = 0#
BSWOpenings = 0#
LEWOpenings = 0#
REWOpenings = 0#
ROpenings = 0#
For i = 1 To 9
  OpLoc(i) = Sheet1.Range("Openings").Offset(i, 0)
  op$ = Sheet1.Range("Openings").Offset(i, 1)
  OpWid(i) = val(op$)
  OpHt(i) = val(Mid(op$, InStr(1, op$, "x", vbTextCompare) + 1, 100))
  If InStr(1, op$, "ful", vbTextCompare) > 0 Or InStr(1, op$, "x", vbTextCompare) > 0 Then
    Select Case OpLoc(i)
    Case "Front Sidewall"
    If OpWid(i) = 0 Then OpWid(i) = leng
    If OpHt(i) = 0 Then OpHt(i) = FEH
    Case "Back Sidewall"
    If OpWid(i) = 0 Then OpWid(i) = leng
    If OpHt(i) = 0 Then OpHt(i) = BEH
    Case "Left Endwall"
    If OpWid(i) = 0 Then OpWid(i) = wid
    If OpHt(i) = 0 Then OpHt(i) = Peak
    Case "Right Endwall"
    If OpWid(i) = 0 Then OpWid(i) = wid
    If OpHt(i) = 0 Then OpHt(i) = Peak
    End Select
  End If
  Select Case OpLoc(i)
    Case "Front Sidewall"
    FSWOpenings = FSWOpenings + OpWid(i) * OpHt(i)
    Case "Back Sidewall"
    BSWOpenings = BSWOpenings + OpWid(i) * OpHt(i)
    Case "Left Endwall"
    LEWOpenings = LEWOpenings + OpWid(i) * OpHt(i)
    Case "Right Endwall"
    REWOpenings = REWOpenings + OpWid(i) * OpHt(i)
  End Select
  OpPur(i) = Sheet1.Range("Openings").Offset(i, 2)
  OpBr(i) = Sheet1.Range("Openings").Offset(i, 3)
  WOLeng = WOLeng + OpWid(i)
Next i
aaa = bbb
If LEWOpenings > EWArea Then LEWOpenings = EWArea
If REWOpenings > EWArea Then REWOpenings = EWArea
If BSWOpenings > leng * BEH Then BSWOpenings = leng * BEH
If FSWOpenings > leng * FEH Then FSWOpenings = leng * FEH
If WOLeng > 2 * (leng + wid) Then WOLeng = 2 * (leng + wid)
'
'
'***************************************************************************
'******************  Write Estimate Records  *******************************
'***************************************************************************
Sheet2.EnableCalculation = False
Sheet3.EnableCalculation = False
Sheet4.EnableCalculation = False

'Sheet7.EnableCalculation = False
If Sleng > wid + 0.01 Or Abs(slopes(n, 2) - FEH) > 0.01 Then
  MsgBox ("Warning: Slopes and eave heights do not match! " + CStr(Sleng) + " " + CStr(slopes(n, 2)))
Else
Sheet2.Activate 'Activate Detail Sheet
'Description Line
salesCode = Sheet1.Range("AreaDesc").Offset(0, 2)
desc$ = Sheet1.Range("AreaDesc") + " (" + CStr(wid) + " X " + CStr(leng) + ")"
Call InsCode(desc$, "-", salesCode, "", "")
'
'Main Frame
'**************
nFrames = nbays - 1
If REType$ = "Main Frame" Or REType$ = "MF 1/2 Loaded" Then nFrames = nFrames + 1
If LEType$ = "Main Frame" Or LEType$ = "MF 1/2 Loaded" Then nFrames = nFrames + 1
'
'Caculate Frame Weights
FBIndex = 1
CFactor = 1 ' Purlin Continuity Factor
If nbays = 1 Then CFactor = 1#    'added by hezron 09/05/2010
If nbays = 2 Then CFactor = 1.25
If nbays = 3 Then CFactor = 1.08
If nbays = 4 Then CFactor = 1.03
If BaseType$ = "Fixed Base" And BEH > 0 Then FBIndex = (12 / BEH) ^ 0.15
MFWeight(0) = 0: MFWeight(1) = 0
For F = 1 To nbays - 1 ' loop frames
  FrWeight = 0
  TrBay = CFactor * (BaySize(F) / 2 + BaySize(F + 1) / 2)
  For i = 1 To Nspans  'Rafters
    MFLoad = TLoadF
    If 0.75 * (Wind - Dead) > TLoadF Then MFLoad = 0.75 * (Wind - Dead)
    wplm = (0.1 * MFLoad * TrBay + 0.3) * (2 * inCol(i, 0) - 9) 'weight per linear meter
    If wplm < mwplm Then wplm = mwplm
    FrWeight = FrWeight + inCol(i, 0) * wplm
    ' Rafter Connections
    nrc = 2 * CInt(inCol(i, 0) / 10)
    If nrc >= 2 Then nrc = nrc - 2
    ct = ConType(wplm)
    MFC(ct) = MFC(ct) + nrc
    MFB(ct) = MFB(ct) + nrc * (8 + 2 * (ct - 2)) / 2
  Next i
  
  FrWeight = FrWeight * rafleng / wid ' adjust weight due to sloped lenght
  excwplm = FrWeight / wid ' Use rafter weight/m for exterior column later
  FrameLength = rafleng - 0.4
  
    'number of interior column bolts
    Dim nIntColBolt As Integer 'added by hezron on 09/02/2010
    Dim fbt() As Variant 'added by hezron on 09/02/2010
    Dim nBoltsPerColumn As Integer, connectionType As Integer 'added by hezron on 09/02/2010
    
  For i = 1 To Nspans - 1 'Interior Columns
    wplm = 0.002 * FBIndex * (MFLoad * TrBay * (inCol(i, 0) + inCol(i + 1, 0)) / 2 * inCol(i, 1) ^ 2)
    If wplm < mwplm Then wplm = mwplm
    FrWeight = FrWeight + inCol(i, 1) * wplm
    FrameLength = FrameLength + inCol(i, 1) - 0.8
    'Interior Column Connections
    nrc = 3
    If inCol(i, 1) > 18 Then nrc = nrc + 2
    ct = (ConType(wplm))
    MFC(ConType(wplm)) = MFC(ConType(wplm)) + nrc
    MFB(ct) = MFB(ct) + (8 + 2 * (ct - 2)) * (nrc - 1) / 2
    
'-------------------------------added by hezron on 09/02/2010-------------------------------------
'    MFAB(ct) = MFAB(ct) + 4 'original code
'    If ct > 4 Then MFAB(ct) = MFAB(ct) + 2 'original code
'    If BaseType$ = "Fixed Base" Then MFAB(ct) = MFAB(ct) + 4 + 2 * Int(ct / 4) 'original code
    
    If BaseType$ = "Fixed Base" Then
        Call GetBuildingDimension(SP$)
        fbt = FixedBaseType(mainFrameMinSpan) 'get the fixed base details
        connectionType = fbt(0)
        nBoltsPerColumn = fbt(1)
        MFAB(connectionType) = MFAB(connectionType) + nBoltsPerColumn
    Else
        MFAB(ct) = MFAB(ct) + 4
        If ct > 4 Then MFAB(ct) = MFAB(ct) + 2
    End If
'-----------------------------------------------------------------------------------------------------

  Next i
  'exterior columns
  wplm = excwplm
  OPFactor = 1 + Sqr(BSWOpenings / leng / BEH) / 2
  FrWeight = FrWeight + BEH * wplm * FBIndex * OPFactor 'back exterior column
  FrameLength = FrameLength + BEH - 0.6
  OPFactor = 1 + Sqr(FSWOpenings / leng / FEH) / 2
  If FrType$ <> "Lean To" Then
    FrWeight = FrWeight + FEH * wplm * FBIndex * OPFactor 'front exterior column
    FrameLength = FrameLength + FEH - 0.6
  End If
  MFWeight(F) = CInt(FrWeight / 10) * 10
  'Exterior Column Connections
  NExCs = 1
  If FrType$ <> "Lean To" Then NExCs = 2
  nc = 3 * NExCs
  FBAB = 2 'modified by hezron(changed from value of 1 to value of 2)
  If BaseType$ <> "Fixed Base" Then
    nc = 2 * NExCs
    MFC(1) = MFC(1) + NExCs
    FBAB = 1 'modified by hezron(changed from value of 2 to value of 1)
  End If
   ct = ConType(wplm)
  MFC(ct) = MFC(ct) + nc
  MFB(ct) = MFB(ct) + (8 + 2 * (ct - 2)) * (nc - 1) / 2
  
  '----------------------added by hezron on 09/02/2010--------------------------
  ' MFAB(ct) = MFAB(ct) + (4 + 2 * Int(ct / 4)) * FBAB * NExCs 'original code
  
    If BaseType$ = "Pinned Base" Then
        MFAB(ct) = MFAB(ct) + (4 + 2 * Int(ct / 4)) * FBAB * NExCs
    Else
        Call GetBuildingDimension(SP$)
        fbt = FixedBaseType(mainFrameMinSpan) 'get the fixed base details
        connectionType = fbt(0)
        nBoltsPerColumn = fbt(1)
        MFAB(connectionType) = MFAB(connectionType) + (2 * nBoltsPerColumn)
    End If
  
  '-----------------------------------------------------------------------------
  
  'Peak and Valley Connections
  ct = ConType(wplm)
  MFC(ct) = MFC(ct) + 2 * nPeaks + 2 * nValeys
  MFB(ct) = MFB(ct) + (nPeaks + nValeys) * (8 + 2 * (ct - 2))
Next F

If LEType$ = "Main Frame" Then MFWeight(0) = MFWeight(1)
i = ConType(wplm)
If REType$ = "Main Frame" Then MFWeight(nbays) = MFWeight(nbays - 1)
hmf = 0.65
If hmf < mwplm / wplm Then hmf = mwplm / wplm
If LEType$ = "MF 1/2 Loded" Then MFWeight(0) = CInt(MFWeight(1) * hmf / 10) * 10
If LEType$ = "MF 1/2 Loded" Then MFWeight(nbays) = CInt(MFWeight(nbays - 1) * hmf / 10) * 10
ReDim MFQty(nbays)

'--------------------------------------------------------------------------
'Insert "Main Frames"
Dim Weight_of_MF As Double
Weight_of_MF = 0

Des$ = "Main Frames"
 For i = 0 To nbays 'group Frames by Weight
  Qty = 1
  For j = 0 To nbays
    If MFWeight(i) = MFWeight(j) Then
      If j < i Then Qty = 0
      MFQty(i) = MFQty(i) + 1
    End If
  Next j
  MFQty(i) = MFQty(i) * Qty
  If MFWeight(i) > 0 And MFQty(i) > 0 Then
    Call InsCode(Des$, "BU", salesCode, MFWeight(i), MFQty(i))
    Des$ = ""
    Weight_of_MF = Weight_of_MF + MFWeight(i) * MFQty(i)
  End If
Next i

If DblWld$ = "Yes" Then Call InsCode(Des$, "DSW", salesCode, 1, Int(nFrames * FrameLength))
Call InsCode(Des$, "BuLeng", salesCode, 1, Int(nFrames * FrameLength))

'--------------------------------------------
'Main Frame Connections
Des$ = "Main Frame Connections - Weight"
'MsgBox

Dim r_ As Double
If Nspans > 1 Then
    'Multi span
    If BaseType$ = "Pinned Base" Then
        'Pinned Base
        r_ = 14
    Else
        'Fixed Base
        r_ = 18
    End If
Else
    'Clear span
    If BaseType$ = "Pinned Base" Then
        'Pinned Base
        r_ = 17
    Else
        'Fixed Base
        r_ = 20
    End If
End If
Weight_of_MF = Weight_of_MF * r_ / 100

Call InsCode(Des & "(" & CStr(r_) + "%)", "ConPlates", salesCode, 1, Weight_of_MF)
'For i = 1 To 5
 ' MFC(0) = MFC(0) + MFC(i)
  'If MFC(i) > 0 Then
   'Call InsCode(Des, "MFC" & CStr(i), SalesCode, 1, MFC(i))
   'Des$ = ""
  'End If
'Next i
'-----------------------------------------------------

'Main Frame Bolts & Nuts
MFB(1) = 4 * CInt((MFB(1) + MFB(2) / 2 + MFB(3) / 4) / 4)
MFB(2) = 4 * CInt((MFB(2) / 2 + MFB(3) / 4) / 4)
MFB(3) = 4 * CInt((MFB(3) / 2 + MFB(4) / 4 + MFB(5) / 4) / 4)
MFB(4) = 4 * CInt((MFB(4) / 2 + MFB(5) / 2) / 4)
MFB(5) = 4 * CInt((MFB(5) / 2) / 4)
Des$ = "Main Frame Bolts"
If MFB(1) > 0 Then Call InsCode(Des, "HSB16", salesCode, 1, MFB(1)): Des$ = ""
If MFB(2) > 0 Then Call InsCode(Des, "HSB2060", salesCode, 1, MFB(2)): Des$ = "" 'changed from HSB2050 to HSB2060 9.22.11(hez)
If MFB(3) > 0 Then Call InsCode(Des, "HSB2480", salesCode, 1, MFB(3)): Des$ = "" 'changed from HSB2460 to HSB2480 9.22.11(hez)
If MFB(4) > 0 Then Call InsCode(Des, "HSB27", salesCode, 1, MFB(4)): Des$ = ""
If MFB(5) > 0 Then Call InsCode(Des, "HSB30", salesCode, 1, MFB(5)): Des$ = ""

'Flange Bracing
If wid > 50 Then
    FBQty = 2 * CInt(nFrames * (((BEH + FEH) / 1.5 + (wid) / 2) + 4 * Nspans) / 2) 'added by hezron
    FBQty = 2 * FBQty
Else
    FBQty = 2 * CInt(nFrames * (((BEH + FEH) / 1.5 + (wid) / 2) + 4 * Nspans) / 2) 'original code
End If

If FBQty > 0 Then
    If wid <= 35 Then
        Call InsCode("Flange Bracing", "FBA", salesCode, 1, FBQty) 'original code
    Else
        Call InsCode("Flange Bracing", "FBA2", salesCode, 1, FBQty) 'added by hezron
    End If
    
    Call InsCode("", "HSB12", salesCode, 1, 2 * FBQty)
End If

'Frames PPL
    'cancelled by Do Nguyen
    'Call InsCode("", "PPLBu", SalesCode, 1, Int(MFC(0) / 4) * 2)
'Anchor Bolts
Des$ = "Anchor Bolts"
If MFAB(1) > 0 Then Call InsCode(Des$, "AB16", salesCode, 1, MFAB(1)): Des$ = ""
If MFAB(2) > 0 Then Call InsCode(Des$, "AB20", salesCode, 1, MFAB(2)): Des$ = ""
If MFAB(3) > 0 Then Call InsCode(Des$, "AB24", salesCode, 1, MFAB(3)): Des$ = ""
If MFAB(4) > 0 Then Call InsCode(Des$, "AB30", salesCode, 1, MFAB(4)): Des$ = ""
If MFAB(5) > 0 Then Call InsCode(Des$, "AB36", salesCode, 1, MFAB(5)): Des$ = ""
'Bearing Frame
EWML = 0
Des$ = "Bearing Frame"
BFLoad = TLoadF
PPLBU = 0
PPLHR = 0
If TLoadF < Wind - Dead Then BFLoad = Wind - Dead
If LEType$ = "Bearing Frame" Or LEType$ = "False Rafter" Then
  For i = 1 To LWCS(0, 0)
    Sheet5.Range("EWCIndex") = BFLoad * LWCS(i, 1) ^ 2 * Bays(1, 1)
    Code = Sheet5.Range("EWCCode")
    If i > 1 Then Des$ = ""
    If Left$(Code, 2) = "BU" Then
      EWML = EWML + LWCS(i, 1) * LWCS(i, 0)
      PPLBU = PPLBU + LWCS(i, 0)
    Else
      PPLHR = PPLHR + LWCS(i, 0)
    End If
'****************************added by hezron*********************************
    Dim endPlateQTY As Integer
    If (wid / 2) > 12 Then endPlateQTY = 2 * 2 * Int((wid / 2) / 12)

    Call InsCode(Des$, Code, salesCode, LWCS(i, 1), LWCS(i, 0)) 'original code
    
    If (wid / 2) > 12 Then Call InsCode("", "MFC1", salesCode, 1, endPlateQTY)
'****************************************************************************
  Next i
End If
If REType$ = "Bearing Frame" Or REType$ = "False Rafter" Then
  For i = 1 To RWCS(0, 0)
    Sheet5.Range("EWCIndex") = BFLoad * RWCS(i, 1) ^ 2 * Bays(Bays(0, 0), 1)
    Code = Sheet5.Range("EWCCode")
    If i > 1 Then Des$ = ""
    If Left$(Code, 2) = "BU" Then
      EWML = EWML + RWCS(i, 1) * RWCS(i, 0)
      PPLBU = PPLBU + RWCS(i, 0)
    Else
      PPLHR = PPLHR + RWCS(i, 0)
    End If
'****************************added by hezron*********************************
Call InsCode(Des$, Code, salesCode, RWCS(i, 1), RWCS(i, 0)) 'original code

If (wid / 2) > 12 Then Call InsCode("", "MFC1", salesCode, 1, endPlateQTY)
'****************************************************************************

  Next i
End If
'Wind Columns
If LEType$ <> "False Rafter" Then
  desc$ = "Left Endwall Columns"
  For i = 1 To nlwcs - 1
    If i > 1 Then desc$ = ""
    EWCHt = LInCol(i, 1)
    EWCIndex = Wind * EWCHt ^ 2 * (LInCol(i, 0) + LInCol(i + 1, 0)) / 2
    Sheet5.Range("EWCIndex") = EWCIndex
    Code = Sheet5.Range("EWCCode")
    If Left$(Code, 2) = "BU" Then
      EWML = EWML + EWCHt
      PPLBU = PPLBU + 1
    Else
      PPLHR = PPLHR + 1
    End If
    Call InsCode(desc$, Code, salesCode, EWCHt, 1)
  Next i
  If LEType$ = "Bearing Frame" Then
    EWCIndex = Wind * BEH ^ 2 * LInCol(1, 0) / 2
    Sheet5.Range("EWCIndex") = EWCIndex
    Code = Sheet5.Range("EWCCode")
    If Left$(Code, 2) = "BU" Then
      EWML = EWML + BEH
      PPLBU = PPLBU + 1
    Else
      PPLHR = PPLHR + 1
    End If
    Call InsCode(desc$, Code, salesCode, BEH, 1)
    If FrType$ <> "Lean To" Then
      EWCIndex = Wind * FEH ^ 2 * LInCol(nlwcs, 0) / 2
      Sheet5.Range("EWCIndex") = EWCIndex
      Code = Sheet5.Range("EWCCode")
      If Left$(Code, 2) = "BU" Then
        EWML = EWML + FEH
        PPLBU = PPLBU + 1
      Else
        PPLHR = PPLHR + 1
      End If
      Call InsCode(desc$, Code, salesCode, FEH, 1)
    End If
  End If
End If
If REType$ <> "False Rafter" Then
  desc$ = "Right Endwall Columns"
  For i = 1 To nrwcs - 1
    If i > 1 Then desc$ = ""
    EWCHt = RInCol(i, 1)
    EWCIndex = Wind * EWCHt ^ 2 * (RInCol(i, 0) + RInCol(i + 1, 0)) / 2
    Sheet5.Range("EWCIndex") = EWCIndex
    Code = Sheet5.Range("EWCCode")
    If Left$(Code, 2) = "BU" Then
      EWML = EWML + EWCHt
      PPLBU = PPLBU + 1
    Else
      PPLHR = PPLHR + 1
    End If

    Call InsCode(desc$, Code, salesCode, EWCHt, 1)
  Next i
  If REType$ = "Bearing Frame" Then
    EWCIndex = Wind * BEH ^ 2 * RInCol(1, 0) / 2
    Sheet5.Range("EWCIndex") = EWCIndex
    Code = Sheet5.Range("EWCCode")
    If Left$(Code, 2) = "BU" Then
      EWML = EWML + BEH
      PPLBU = PPLBU + 1
    Else
      PPLHR = PPLHR + 1
    End If

    Call InsCode(desc$, Code, salesCode, BEH, 1)
    If FrType$ <> "Lean To" Then
      EWCIndex = Wind * FEH ^ 2 * RInCol(nlwcs, 0) / 2
      Sheet5.Range("EWCIndex") = EWCIndex
      Code = Sheet5.Range("EWCCode")
      If Left$(Code, 2) = "BU" Then
        EWML = EWML + FEH
        PPLBU = PPLBU + 1
      Else
        PPLHR = PPLHR + 1
      End If

      Call InsCode(desc$, Code, salesCode, FEH, 1)
    End If
  End If
End If
' Endwall Manufacturing
If EWML > 0 Then
  Call InsCode("Endwall Manufacturing", "BuLeng", salesCode, 1, EWML)
  If DblWld$ = "Yes" Then Call InsCode("", "DSW", salesCode, 1, EWML)
End If
    'cancelled by Do Nguyen
        'If PPLBU > 0 Then Call InsCode("", "PPLBu", SalesCode, 1, PPLBU)
        'If PPLHR > 0 Then Call InsCode("", "PPLHR", SalesCode, 1, PPLHR)
    'cancelled by Do Nguyen
'Bearing Frame Connections
EWC = 2 * nlwcs + 2 * nrwcs - 4
EWB = EWC * 4
If LEType$ <> "False Rafter" Then
  EWC = EWC + nlwcs - 1
  EWAB = 4 * nlwcs - 4
Else
  EWC = EWC + 2
End If
If REType$ <> "False Rafter" Then
  EWC = EWC + nrwcs - 1
  EWAB = EWAB + 4 * nrwcs - 4
Else
  EWC = EWC + 2
End If
If LEType$ = "Bearing Frame" Then EWC = EWC + 4: EWAB = EWAB + 4
If REType$ = "Bearing Frame" Then EWC = EWC + 4: EWAB = EWAB + 4
Des$ = "Bearing Frame Connections"
If EWC > 0 Then Call InsCode(Des$, "EWC", salesCode, 1, EWC): Des$ = ""
If EWB > 0 Then Call InsCode(Des$, "HSB1250", salesCode, 1, EWB): Des$ = ""
If EWAB > 0 Then Call InsCode(Des$, "AB16", salesCode, 1, EWAB): Des$ = ""

'
'Bracing
NBrBays = CInt(nbays / 5 + 1)
NBrPanels = CInt(BEH / 9 + 1) + CInt(wid / 6 + 2)
If FrType$ <> "Lean To" Then NBrPanels = NBrPanels + CInt(FEH / 9 + 1)
NBrP = NBrPanels
'Case 1: Bracing Type is Cables
If BrType$ = "Cables" Then
  Call InsCode("Bracing", "CBR", salesCode, 1, 4 * NBrBays)
  NBrP = NBrP - 4
  If NBrP > 4 Then
    Call InsCode("", "CBR", salesCode, 1, 4 * NBrBays)
  Else
    If NBrP > 0 Then Call InsCode("", "CBR", salesCode, 1, NBrP * NBrBays)
  End If
  NBrP = NBrP - 4
  If NBrP > 4 Then
    Call InsCode("", "CBR", salesCode, 1, 4 * NBrBays)
  Else
    If NBrP > 0 Then Call InsCode("", "CBR", salesCode, 1, NBrP * NBrBays)
  End If
  NBrP = NBrP - 4
  If NBrP > 0 Then
    Call InsCode("", "CBR", salesCode, 1, NBrP * NBrBays)
  End If
End If
'
'Case 2: Bricing Type is Rods.
If BrType$ = "Rods" Then
Call InsCode("Bracing", "RBR22", salesCode, 1, 4 * NBrBays)
  NBrP = NBrP - 4
  If NBrP > 4 Then
    Call InsCode("", "RBR22", salesCode, 1, 4 * NBrBays)
  Else
    If NBrP > 0 Then Call InsCode("", "RBR22", salesCode, 1, NBrP * NBrBays)
  End If
  NBrP = NBrP - 4
  If NBrP > 4 Then
    Call InsCode("", "RBR22", salesCode, 1, 4 * NBrBays)
  Else
    If NBrP > 0 Then Call InsCode("", "RBR22", salesCode, 1, NBrP * NBrBays)
  End If
  NBrP = NBrP - 4
  If NBrP > 0 Then
    Call InsCode("", "RBR22", salesCode, 1, NBrP * NBrBays)
  End If
End If
'
'Case 3: Bracing Type is Angles.
If BrType$ = "Angles" Then
  BrAngLen = Int(10 * Sqr((leng / nbays) ^ 2 + 36)) / 10
  Call InsCode("Wind Bracing", "FBA2", salesCode, 1, 4 * NBrBays * 2 * BrAngLen)
  NBrP = NBrP - 4
  If NBrP > 4 Then
    Call InsCode("", "FBA3", salesCode, 1, 4 * NBrBays * 2 * BrAngLen)
  Else
    If NBrP > 0 Then Call InsCode("", "FBA3", salesCode, 1, NBrP * NBrBays * 2 * BrAngLen)
  End If
  NBrP = NBrP - 4
  If NBrP > 4 Then
    Call InsCode("", "FBA3", salesCode, 1, 4 * NBrBays * 2 * BrAngLen)
  Else
    If NBrP > 0 Then Call InsCode("", "CRA", salesCode, 1, NBrP * NBrBays * 2 * BrAngLen)
  End If
  NBrP = NBrP - 4
  If NBrP > 0 Then
    Call InsCode("", "CRA", salesCode, 1, NBrP * NBrBays * 2 * BrAngLen)
  End If
  Call InsCode("", "BrGu", salesCode, 1, NBrPanels * NBrBays * 3 + 8)
  Call InsCode("", "HSB20", salesCode, 1, 14 * NBrPanels * NBrBays)
End If
'Wind Struts
StrutIndex = Wind * wid * BEH / NBrBays / 4
Do While StrutIndex > 4
  If StrutIndex < 10 Then StClip = StClip + 2
  If StrutIndex >= 10 And StrutIndex < 20 Then StPurlin = StPurlin + 2
  If StrutIndex >= 20 And StrutIndex < 30 Then ST125 = ST125 + 2
  If StrutIndex >= 30 And StrutIndex < 40 Then ST150 = ST150 + 2
  If StrutIndex >= 40 Then ST200 = ST200 + 2
  StrutIndex = StrutIndex - Wind * 12 * BEH / NBrBays / 4
Loop
StDes$ = "Wind Strut Members"
If ST200 > 0 Then Call InsCode(StDes$, "T200", salesCode, CInt(10 * leng / nbays) / 10, ST200 * NBrBays): StDes$ = ""
If ST150 > 0 Then Call InsCode(StDes$, "T150", salesCode, CInt(10 * leng / nbays) / 10, ST150 * NBrBays): StDes$ = ""
If ST125 > 0 Then Call InsCode(StDes$, "T125", salesCode, CInt(10 * leng / nbays) / 10, ST125 * NBrBays): StDes$ = ""
If Sheet5.Range("CFFinish") = 3 Then
  StPCode = "Z25P"
Else
  StPCode = "Z25G"
End If
If StPurlin > 0 Then Call InsCode(StDes$, StPCode, salesCode, CInt(10 * leng / nbays) / 10, StPurlin * NBrBays):: StDes$ = ""
If StPurlin + StClip > 0 Then Call InsCode(StDes$, "CFClip", salesCode, 1, 2 * NBrBays * (StClip + 2 * StPurlin)): StDes$ = ""
If ST200 + ST150 + ST125 > 0 Then Call InsCode(StDes$, "MFC1", salesCode, 1, 2 * (ST150 + ST200 + ST125) * NBrBays): StDes$ = ""
If ST150 + ST200 + ST125 > 0 Then Call InsCode("", "HSB16", salesCode, 1, 8 * (ST200 + ST150 + ST125) * NBrBays)
If StClip + StPurlin > 0 Then Call InsCode("", "HSB12", salesCode, 1, 8 * (StClip + StPurlin) * NBrBays)
PPLCF = PPLCF + weight(StPCode) * CInt(10 * leng / nbays) / 10 * StPurlin * NBrBays
'Portals
NPortal = 0
If Sheet1.Range("E32") = "Portal" Then NPortal = NPortal + 1
If Sheet1.Range("E33") = "Portal" Then NPortal = NPortal + 1
NPortal = NBrBays * NPortal
If NPortal > 0 Then
  WPortal = 40 * ((leng / nbays) + (BEH ^ 2 + FEH ^ 2) / 6) * EWArea * Wind / 200 / Sqr(NPortal)
  If WPortal < 25 * (leng / nbays + BEH + FEH) Then WPortal = 25 * (leng / nbays + BEH + FEH)
  ct = ConType(WPortal / (leng / nbays + BEH + FEH))
  Call InsCode("", "BUPortal", salesCode, 10 * CInt(WPortal / 10), NPortal)
  If DblWld$ = "Yes" Then Call InsCode(Des$, "DSW", salesCode, 1, Int(NPortal * (leng / nbays - 0.6 + BEH / 2 + FEH / 2)))
  Call InsCode("", "BuLeng", salesCode, 1, Int(NPortal * (leng / nbays - 0.6 + BEH / 2 + FEH / 2)))
  
        'cancelled by Do Nguyen
            'Call InsCode("", "PPLBu", SalesCode, 1, NPortal)
        'cancelled by Do Nguyen
        
  Call InsCode("", "MFC" & CStr(ct), salesCode, 1, 4 * NPortal)
  Call InsCode("", Choose(ct, "HSB16", "HSB20", "HSB24", "HSB27", "HSB30"), salesCode, 1, 16 * NPortal)
  Call InsCode("", "HSB16", salesCode, 1, NPortal * (8 + 4 * CInt(BEH / 2)))
End If
'Purlins

PGBolts = 0
LoadP = TLoadP
If Wind > TLoadP Then LoadP = Wind
'End Bays
PDIndex = 1.25 * LoadP * Bays(1, 1) ^ 2 ' Calculate Purlin Design Index
Sheet5.Range("PDIndex") = PDIndex
PDCode = Sheet5.Range("PDCode")
PLINES = CInt(wid / 1.5 + nPeaks + nValeys)
Qty = PLINES

Esqty = 2
Psize = Bays(1, 1) + 0.107
'****************************added by hezron*********************************
    Call QuickEstCalculations.GetBuildingDimension(Sheet1.Range("C12").Value)
    PClipQty = PLINES * (noOfSideWallBays + 1)
Dim purlinTapeLength As Double
purlinTapeLength = Bays(1, 1)
'*****************************************************************************
ESSize = Bays(1, 1)
If Bays(1, 1) > 6.5 Then Psize = Psize + 0.599
If Bays(1, 1) > 9 Then Psize = Psize + 0.706
If Bays(0, 0) = 1 And Bays(1, 0) > 1 Then Qty = 2 * Qty: Esqty = 4
If NRSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty + 1
If NRSagRods > 0 Then NSagRods = NSagRods + val(NRSagRods) * (Qty + 1)

'****************************added by hezron*********************************
    'Call InsCode("End Bay Purlins", PDCode, salesCode, Psize, Qty) 'original code
    If Sheet1.Range("E26").Value = 200 Then Call InsCode("End Bay Purlins", PDCode, salesCode, Psize, Qty)
    If Sheet1.Range("E26").Value = 250 Then Call InsCode("End Bay Purlins", "25Z25G", salesCode, Psize, Qty)
    If Sheet1.Range("E26").Value = 360 Then Call InsCode("End Bay Purlins", "M20G", salesCode, Psize, Qty)
'****************************************************************************
PPLCF = PPLCF + weight(PDCode) * Psize * Qty
'Eave strut is set off by Fawaz
'EScode = "ES20": If ESSize > 7.99 Then EScode = "ES25"
 'Eave strut is replaced with purlin and gable angle

'****************************added by hezron*********************************
    'Call InsCode("", PDCode, salesCode, Psize, Esqty) 'original code
    If Sheet1.Range("E26").Value = 200 Then Call InsCode("", PDCode, salesCode, Psize, Esqty)
    If Sheet1.Range("E26").Value = 250 Then Call InsCode("", "25Z25G", salesCode, Psize, Esqty)
    If Sheet1.Range("E26").Value = 360 Then Call InsCode("", "M20G", salesCode, Psize, Esqty)
'****************************************************************************
 EScode = "Gang"
Call InsCode("", EScode, salesCode, ESSize, Esqty)
PPLCF = PPLCF + weight(EScode) * ESSize * Esqty

'****************************added by hezron*********************************
Dim ebpPGBolts As Integer 'end bay purlin bolts
ebpPGBolts = Qty * 2
'****************************************************************************
PGBolts = PGBolts + Qty * 2
If Bays(0, 0) > 1 Then
  PDIndex = 1.25 * LoadP * Bays(Bays(0, 0), 1) ^ 2
  Sheet5.Range("PDIndex") = PDIndex
  PDCode = Sheet5.Range("PDCode")
  Psize = Bays(Bays(0, 0), 1) + 0.107
'****************************added by hezron*********************************
purlinTapeLength = Bays(Bays(0, 0), 1)
'****************************************************************************
  ESSize = Bays(Bays(0, 0), 1)
  If Bays(Bays(0, 0), 1) > 6.5 Then Psize = Psize + 0.599
  If Bays(Bays(0, 0), 1) > 9 Then Psize = Psize + 0.706
  
'****************************added by hezron*********************************
    'Call InsCode("", PDCode, salesCode, Psize, Qty) 'original code
    If Sheet1.Range("E26").Value = 200 Then Call InsCode("", PDCode, salesCode, Psize, Qty)
    If Sheet1.Range("E26").Value = 250 Then Call InsCode("", "25Z25G", salesCode, Psize, Qty)
    If Sheet1.Range("E26").Value = 360 Then Call InsCode("", "M20G", salesCode, Psize, Qty)
'****************************************************************************
  PPLCF = PPLCF + weight(PDCode) * Psize * Qty
  If NRSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty + 1
  If NRSagRods > 0 Then NSagRods = NSagRods + NRSagRods * (Qty + 1)
  'Eave strut is set off by Fawaz
  'EScode = "ES20": If ESSize > 7.99 Then EScode = "ES25"
  'Eave strut is replaced with purlin and gable angle
  
   
'****************************added by hezron*********************************
    'Call InsCode("", PDCode, salesCode, Psize, Esqty) 'original code
    If Sheet1.Range("E26").Value = 200 Then Call InsCode("", PDCode, salesCode, Psize, 2 * Bays(i, 0))
    If Sheet1.Range("E26").Value = 250 Then Call InsCode("", "25Z25G", salesCode, Psize, 2 * Bays(i, 0))
    If Sheet1.Range("E26").Value = 360 Then Call InsCode("", "M20G", salesCode, Psize, 2 * Bays(i, 0))
'****************************************************************************
  EScode = "Gang"
  Call InsCode("", EScode, salesCode, ESSize, 2)
  PPLCF = PPLCF + weight(EScode) * ESSize * 2

  ebpPGBolts = Qty * 2 'added by hezron

  PGBolts = PGBolts + Qty * 2
End If

'Interior Bay Purlins
If nbays > 2 Then
    IntPurlinDes = "Interior Bay Purlins"
    Bays(1, 0) = Bays(1, 0) - 1
    Bays(Bays(0, 0), 0) = Bays(Bays(0, 0), 0) - 1
    For i = 1 To Bays(0, 0)
        PDIndex = LoadP * Bays(i, 1) ^ 2
        Sheet5.Range("PDIndex") = PDIndex
        PDCode = Sheet5.Range("PDCode")
        Psize = Bays(i, 1) + 0.107
        purlinSize = Psize 'added by hezron on 08/22/2010 for roof monitor
        purlinTapeLength = Bays(i, 1) 'added by hezron
        If Bays(i, 1) > 6.5 Then Psize = Psize + 0.599
        If Bays(i, 1) > 9# Then Psize = Psize + 0.706
        purlinSize = Psize 'added by hezron on 08/22/2010 for roof monitor
        Qty = Bays(i, 0) * PLINES
        If Bays(i, 0) > 0 Then
            '****************************added by hezron*********************************
            'Call InsCode("", PDCode, salesCode, Psize, 2 * Bays(I, 0)) 'original code
            Select Case Sheet1.Range("E26").Value
                Case 200
                    Call InsCode(IntPurlinDes, PDCode, salesCode, Psize, Qty)
                Case 250
                    Call InsCode(IntPurlinDes, "250Z20G", salesCode, Psize, Qty)
                Case 360
                    Call InsCode(IntPurlinDes, "M18G", salesCode, Psize, Qty)
            End Select
            '****************************************************************************
            PPLCF = PPLCF + weight(PDCode) * Psize * Qty
            If NRSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty + 1
            If NRSagRods > 0 Then NSagRods = NSagRods + val(NRSagRods) * (Qty + 1)
            
            Dim ibpPGBolts As Integer 'added by hezron(interior bay purlin bolts)
            ibpPGBolts = Qty * 8 'added by hezron
            
            PGBolts = PGBolts + Qty * 8
            IntPurlinDes = ""
            'Eave strut is set off by Fawaz
            'EScode = "ES20": If Bays(i, 1) > 7.99 Then EScode = "ES25"
            'Eave strut is replaced with purlin and gable angle
            
            '****************************added by hezron*********************************
            'Call InsCode("", PDCode, salesCode, Psize, 2 * Bays(I, 0)) 'original code
            Select Case Sheet1.Range("E26").Value
                Case 200
                    Call InsCode("", PDCode, salesCode, Psize, 2 * Bays(i, 0))
                Case 250
                    Call InsCode("", "250Z20G", salesCode, Psize, 2 * Bays(i, 0))
                Case 360
                    Call InsCode("", "M18G", salesCode, Psize, 2 * Bays(i, 0))
            End Select
            '****************************************************************************
            EScode = "Gang"
            
            Dim eaveStrutQty As Integer 'added by hezron
            eaveStrutQty = Bays(i, 0) 'added by hezron
            Call InsCode("", EScode, salesCode, Bays(i, 1), 2 * Bays(i, 0))
            PPLCF = PPLCF + weight(EScode) * Bays(i, 1) * 2 * Bays(i, 0)
            eaveStrutQty = eaveStrutQty + Bays(i, 0) 'added by hezron
        End If
    Next i
    Bays(1, 0) = Bays(1, 0) + 1
    Bays(Bays(0, 0), 0) = Bays(Bays(0, 0), 0) + 1
End If

'Girts
'Sidewall Girts
'End Bays
PDIndex = 1.25 * Wind * Bays(1, 1) ^ 2  ' Calculate Girt Design Index
Sheet5.Range("PDIndex") = PDIndex

   Select Case Sheet1.Range("PurSize").Value
        Case "200"
            PDCode = Sheet5.Range("PDCode") 'original code
        Case "250"
            PDCode = "25Z25G"
        Case "360"
            PDCode = "M20G"
    End Select
    
GLines = CInt(BEH + FEH / 1.75)
Qty = CInt(GLines * (1 - (BSWOpenings + FSWOpenings) / (leng * BEH + leng * FEH)))
Psize = Bays(1, 1) + 0.107
If Bays(1, 1) > 6.5 Then Psize = Psize + 0.599
If Bays(1, 1) > 9 Then Psize = Psize + 0.706
If Bays(0, 0) = 1 And Bays(1, 0) > 1 Then Qty = 2 * Qty
If Qty > 0 Then Call InsCode("End Bay Sidewall Girts", PDCode, salesCode, Psize, Qty)
PPLCF = PPLCF + weight(PDCode) * Psize * Qty
'****************************edited by hezron*********************************
'calculate the girt clip quantity
SWGClipQty = 2 * CInt(BEH / 1.75) * (noOfSideWallBays + 1)

If roofSagRodDia = wallSagRodDia Then
    If NWSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty '(original code)
    If NWSagRods > 0 Then NSagRods = NSagRods + val(NWSagRods) * Qty '(original code)
Else
    If NWSagRods = "A" And Psize > 8.598 Then WSagRods = WSagRods + Qty
    If NWSagRods > 0 Then WSagRods = WSagRods + val(NWSagRods) * Qty
End If
'*****************************************************************************
SWGClipQtyEndBay = Qty

'****************************added by hezron*********************************
Dim ebswPGBolts As Integer 'end bay sidewall girts bolts
ebswPGBolts = Qty * 2
'****************************************************************************

PGBolts = PGBolts + Qty * 2
If Bays(0, 0) > 1 Then
  PDIndex = 1.25 * Wind * Bays(Bays(0, 0), 1) ^ 2
  
  Sheet5.Range("PDIndex") = PDIndex
    Select Case Sheet1.Range("PurSize").Value
        Case "200"
            PDCode = Sheet5.Range("PDCode") 'original code
        Case "250"
            PDCode = "25Z25G"
        Case "360"
            PDCode = "M20G"
    End Select
   
  Psize = Bays(Bays(0, 0), 1) + 0.107
  If Bays(Bays(0, 0), 1) > 6.5 Then Psize = Psize + 0.599
  If Bays(Bays(0, 0), 1) > 9 Then Psize = Psize + 0.706
  If Qty > 0 Then Call InsCode("", PDCode, salesCode, Psize, Qty)
  PPLCF = PPLCF + weight(PDCode) * Psize * Qty
    '****************************edited by hezron*********************************
    If roofSagRodDia = wallSagRodDia Then
        If NWSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty '(original code)
        If NWSagRods > 0 Then NSagRods = NSagRods + val(NWSagRods) * Qty '(original code)
    Else
        If NWSagRods = "A" And Psize > 8.598 Then WSagRods = WSagRods + Qty
        If NWSagRods > 0 Then WSagRods = WSagRods + val(NWSagRods) * Qty
    End If
    '*****************************************************************************
    SWGClipQtyEndBay = Qty
    ebswPGBolts = Qty * 2 'added by hezron
  PGBolts = PGBolts + Qty * 2
End If

'Interior Bays
If nbays > 2 Then
  IntGirtDes = "Interior Bay Sidewall Girts"
  Bays(1, 0) = Bays(1, 0) - 1
  Bays(Bays(0, 0), 0) = Bays(Bays(0, 0), 0) - 1
  For i = 1 To Bays(0, 0)
   PDIndex = Wind * Bays(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
  
   Select Case Sheet1.Range("PurSize").Value
    Case "200"
     PDCode = Sheet5.Range("PDCode") 'original code
    Case "250"
        PDCode = "250Z20G"
    Case "360"
        PDCode = "M18G"
   End Select
   
   Psize = Bays(i, 1) + 0.107
   If Bays(i, 1) > 6.5 Then Psize = Psize + 0.599
   If Bays(i, 1) > 9# Then Psize = Psize + 0.706
   Qty = CInt(Bays(i, 0) * GLines * (1 - (BSWOpenings + FSWOpenings) / (leng * BEH + leng * FEH)))
   If Bays(i, 0) > 0 Then
      If Qty > 0 Then Call InsCode(IntGirtDes, PDCode, salesCode, Psize, Qty)
      PPLCF = PPLCF + weight(PDCode) * Psize * Qty
    '****************************edited by hezron*********************************
    If roofSagRodDia = wallSagRodDia Then
        If NWSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty '(original code)
        If NWSagRods > 0 Then NSagRods = NSagRods + val(NWSagRods) * Qty '(original code)
    Else
        If NWSagRods = "A" And Psize > 8.598 Then WSagRods = WSagRods + Qty
        If NWSagRods > 0 Then WSagRods = WSagRods + val(NWSagRods) * Qty
    End If
    '*****************************************************************************
    SWGClipQtyInteriorBay = Qty + 1
    
'****************************added by hezron*********************************
Dim ibswPGBolts As Integer 'interior bay sidewall girts bolts
ibswPGBolts = Qty * 8
'****************************************************************************

      PGBolts = PGBolts + Qty * 8
      IntGirtDes = ""
   End If
  Next i
  Bays(1, 0) = Bays(1, 0) + 1
  Bays(Bays(0, 0), 0) = Bays(Bays(0, 0), 0) + 1
End If

'Endwall Girts
GClips = 0
Havg = EWArea / wid         'Calculate Average Height
EWGLines = CInt(Havg / 1.7) 'Calculate Number of Endwall girt lines
EWGirtDes = "End Wall Girts"

'Left Endwall
For i = 1 To LWCS(0, 0)
   PDIndex = 2.01 * Wind * LWCS(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
   PDCode = Sheet5.Range("PDCode")
   Psize = LWCS(i, 1)
   Qty = CInt(LWCS(i, 0) * EWGLines * (1 - LEWOpenings / EWArea))
   If Qty > 0 Then
      Call InsCode(EWGirtDes, PDCode, salesCode, Psize, Qty)
      PPLCF = PPLCF + weight(PDCode) * Psize * Qty
        '****************************edited by hezron*********************************
        If roofSagRodDia = wallSagRodDia Then
            If NWSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty '(original code)
            If NWSagRods > 0 Then NSagRods = NSagRods + val(NWSagRods) * Qty '(original code)
        Else
            If NWSagRods = "A" And Psize > 8.598 Then WSagRods = WSagRods + Qty
            If NWSagRods > 0 Then WSagRods = WSagRods + val(NWSagRods) * Qty
        End If
        '*****************************************************************************
      GClips = GClips + 2 * Qty
      LEWGClipQty = 2 * Qty
'****************************added by hezron*********************************
Dim lewPGBolts As Integer 'end bay sidewall girts bolts
lewPGBolts = Qty * 8
'****************************************************************************
      PGBolts = PGBolts + Qty * 8
      EWGirtDes = ""
   End If
Next i
'Right Endwall
For i = 1 To RWCS(0, 0)
   PDIndex = 2.01 * Wind * RWCS(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
   PDCode = Sheet5.Range("PDCode")
   Psize = RWCS(i, 1)
   Qty = CInt(RWCS(i, 0) * EWGLines * (1 - REWOpenings / EWArea))
   If Qty > 0 Then
      Call InsCode(EWGirtDes, PDCode, salesCode, Psize, Qty)
      PPLCF = PPLCF + weight(PDCode) * Psize * Qty
        '****************************edited by hezron*********************************
        If roofSagRodDia = wallSagRodDia Then
            If NWSagRods = "A" And Psize > 8.598 Then NSagRods = NSagRods + Qty '(original code)
            If NWSagRods > 0 Then NSagRods = NSagRods + val(NWSagRods) * Qty '(original code)
        Else
            If NWSagRods = "A" And Psize > 8.598 Then WSagRods = WSagRods + Qty
            If NWSagRods > 0 Then WSagRods = WSagRods + val(NWSagRods) * Qty
        End If
        '*****************************************************************************

      GClips = GClips + 2 * Qty
      REWGClipQty = 2 * Qty
'****************************added by hezron*********************************
Dim rewPGBolts As Integer 'right endwall girts bolts
rewPGBolts = Qty * 8
'****************************************************************************
      PGBolts = PGBolts + Qty * 8
      EWGirtDes = ""
   End If
Next i

'Purlin & Girt Connections

'****************************edited by hezron*********************************
Dim CFSize As String
CFSize = Sheet1.Range("PurSize").Value
If CFSize = "360" Then
    PGBolts = ebpPGBolts + ibpPGBolts + ebswPGBolts + ibswPGBolts
    Call InsCode("Purlin & Girt Connections", "HSB16", salesCode, 1, PGBolts * 1.66)
    PGBolts = lewPGBolts + rewPGBolts
    Call InsCode("", "HSB12", salesCode, 1, PGBolts * 1.66)
Else
    Call InsCode("Purlin & Girt Connections", "HSB12", salesCode, 1, PGBolts) 'original code
End If

If roofSagRodDia = wallSagRodDia Then
    If NSagRods > 0 Then Call InsCode("", "SR" + CStr(roofSagRodDia), salesCode, 1, NSagRods)
Else
    If NSagRods > 0 Then Call InsCode("", "SR" + CStr(roofSagRodDia), salesCode, 1, NSagRods)
    If NWSagRods > 0 Then Call InsCode("", "SR" + CStr(wallSagRodDia), salesCode, 1, WSagRods)
End If
'*****************************************************************************
      

'****************************edited by hezron*********************************joylene
'If GClips > 0 Then Call InsCode("", "CFClip", salesCode, 1, GClips)'original code
If CFSize = "200" Then
    Call InsCode("", "CFClip", salesCode, 1, PClipQty + SWGClipQty + LEWGClipQty + REWGClipQty)
End If
If CFSize = "250" Then
    Call InsCode("", "CFClip1", salesCode, 1, PClipQty + SWGClipQty)
    Call InsCode("", "CFClip", salesCode, 1, LEWGClipQty + REWGClipQty)
End If
If CFSize = "360" Then
    Call InsCode("", "CFClip2", salesCode, 1, PClipQty + SWGClipQty)
    Call InsCode("", "CFClip", salesCode, 1, LEWGClipQty + REWGClipQty)
End If
'*****************************************************************************

'Gable Angle/Base Angle
Call InsCode("", "Gang", salesCode, 1, 2 * CInt(10 * rafleng) / 10)
If WOLeng < 2 * (leng + wid) Then Call InsCode("", "Bang", salesCode, 1, 2 * (leng + wid) - WOLeng)
PPLCF = PPLCF + weight("Bang") * 2 * (leng + wid) - WOLeng
PPLCF = PPLCF + weight("Gang") * 2 * CInt(10 * rafleng) / 10
    'cancelled by Do Nguyen
        'If PPLCF > 0 Then Call InsCode("PPL Purlins & Girts", "PPLCF", SalesCode, 1, PPLCF)
    'cancelled by Do Nguyen
    
'************** Roof Sheeting ************************************************
'Generate Sandwich Panel Combination Database Record.
RoofTopSkin$ = Sheet1.Range("RoofTopSkin")
roofcore$ = Sheet1.Range("RoofCore")
RoofBotSkin$ = Sheet1.Range("RoofBotSkin")

roofSWPCode = "" 'added by hezron on 4/26/2012
RSCode = RoofTopSkin$
If roofcore$ <> "-" And RoofBotSkin$ <> "-" Then
  RSCode = "PU" & RoofTopSkin$ & roofcore$ & RoofBotSkin$
  
    roofSWPCode = RSCode 'added by hezron on 04/26/2012
    
  'commented by hezron
        '--------------------------------------------------------------------
        'Sandwich Panels code generate

        'put ERP Code -
        'Dim temp As String
        Temp = ""
        Temp = RSCode
        If Left(Temp, 3) = "PUS" Then
            SWP_ERP_CODE = 20411 'Steel
        Else
            SWP_ERP_CODE = 20311 'Aluminum
        End If
        '--------------------------------------------------------------------
End If

Code = RSCode
'****************************added by hezron******************************
'Tr$ = "S" '(original code)
Tr1$ = "S" 'use for DS & RS
trimsizes = Sheet1.Range("E23").Value
If trimsizes = "0.5 AZ" Then Tr$ = "S"
If trimsizes = "0.7 AZ" Then Tr$ = "S1"
'*************************************************************************
If Left$(RSCode, 1) = "A" Or Left$(RSCode, 3) = "PUA" Then Tr$ = "A"
If Left$(RSCode, 1) = "A" Or Left$(RSCode, 3) = "PUA" Then Tr1$ = "A"
If Left(Code, 4) <> "None" Then
        If (RoofBotSkin$ <> "-") And (roofcore$ <> "-") Then
            If Sheet1.Range("E28").Text = "M45-250" Then
                Call InsCode("Roof Sheeting", "-", salesCode, "", "")
                roofCoatableArea = 1.02 * rafleng * leng - ROpenings 'added by hezron on 10/04/2010
                Call InsCode("Mammut SWP Code: " & Code, RoofTopSkin$, salesCode, 1, Application.WorksheetFunction.Ceiling((1.02 * rafleng * leng - ROpenings), 1))
                    Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
                Call InsCode("", roofcore$, salesCode, 1, Application.WorksheetFunction.Ceiling((1.02 * rafleng * leng - ROpenings), 1))
                    Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
                Call InsCode("", RoofBotSkin$, salesCode, 1, Application.WorksheetFunction.Ceiling((1.02 * rafleng * leng - ROpenings), 1))
                    Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
                Call InsCode("" & Code, "-", salesCode, "", "")
            Else 'added by hezron
                Call InsCode("Roof Sheeting", "-", salesCode, "", "")
                roofCoatableArea = (1.02 * rafleng * leng - ROpenings) / 0.9 'added by hezron on 10/04/2010
                Call InsCode("Mammut SWP Code: " & Code, RoofTopSkin$, salesCode, 1, Application.WorksheetFunction.Ceiling(((1.02 * rafleng * leng - ROpenings) / 0.9), 1))
                    Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
                Call InsCode("", roofcore$, salesCode, 1, Application.WorksheetFunction.Ceiling((1.02 * rafleng * leng - ROpenings), 1))  'modified by hezron 07112012
                    Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
                Call InsCode("", RoofBotSkin$, salesCode, 1, Application.WorksheetFunction.Ceiling(((1.02 * rafleng * leng - ROpenings) / 0.9), 1))
                    Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
                Call InsCode("" & Code, "-", salesCode, "", "")
            End If
        Else
            If Sheet1.Range("E28").Text = "M45-250" Then
                roofCoatableArea = 1.02 * rafleng * leng - ROpenings 'added by hezron on 10/04/2010
                Call InsCode("Roof Sheeting", RoofTopSkin$, salesCode, 1, 1.02 * rafleng * leng - ROpenings)
            Else 'added by hezron
                roofCoatableArea = (1.02 * rafleng * leng - ROpenings) / 0.9 'added by hezron on 10/04/2010
                Call InsCode("Roof Sheeting", RoofTopSkin$, salesCode, 1, (1.02 * rafleng * leng - ROpenings) / 0.9)
            End If
        End If
    '****************************commented by hezron******************************
'    ScrewCode = "CS2"
'    Stitch = "CS1"
    '*****************************************************************************
  Sheet7.Range("D1") = Sheet1.Range("C23")  'get Roof Insulation input
  InCode = Sheet7.Range("A1")               'get Roof Insulation code
  If InCode <> "None" Then screwcode = "CS3"
  '****************************commented by hezron******************************
'  If InStr(Code, "A") > 0 Then ScrewCode = "SS2"
'  If InStr(Code, "PUS") > 0 Then ScrewCode = "CS4"
'  If InStr(Code, "PUA") > 0 Then ScrewCode = "SS4"
'  If InStr(Code, "A") > 0 Then Stitch = "SS1"
    '****************************added by hezron*********************************
        If InStr(1, Code, "S", vbTextCompare) = 1 Then  'single skin aluzinc
            If Sheet1.Range("C23") = "None" Then
                screwcode = "CS2"
            Else
                screwcode = "CS3"
            End If
            plugScrew = "ST1" '(11/03/2010)-hezron
            Stitch = "CS1"
        End If
        If InStr(1, Code, "PUS", vbTextCompare) = 1 Then    'swp aluzinc
            Select Case roofcore
               Case "Core35BPro", "Core35CPro", "Core35BEco", "Core35CEco"
                   screwcode = "CS4"
               Case "Core50BPro", "Core50CPro", "Core50BEco", "Core50CEco"
                   screwcode = "CS5"
               Case "Core75BPro", "Core75CPro", "Core75BEco", "Core75CEco"
                   screwcode = "CS6"
               Case "Core100BPro", "Core100CPro", "Core100BEco", "Core100CEco"
                   screwcode = "CS7"
            End Select
            plugScrew = "ST1" '(11/03/2010)-hezron
            Stitch = "CS1"
        End If
       
        If InStr(1, Code, "A", vbTextCompare) = 1 Then  'single skin aluminum
            If Sheet1.Range("C23") = "None" Then
                screwcode = "SS2"
            Else
                screwcode = "SS3"
            End If
            plugScrew = "ST2" '(11/03/2010)-hezron
            Stitch = "SS1"
        End If
        
        If InStr(1, Code, "PUA", vbTextCompare) = 1 Then    'swp aluminum
           Select Case roofcore
               Case "Core35BPro", "Core35CPro", "Core35BEco", "Core35CEco"
                   screwcode = "SS4"
               Case "Core50BPro", "Core50CPro", "Core50BEco", "Core50CEco"
                   screwcode = "SS5"
               Case "Core75BPro", "Core75CPro", "Core75BEco", "Core75CEco"
                   screwcode = "SS6"
               Case "Core100BPro", "Core100CPro", "Core100BEco", "Core100CEco"
                   screwcode = "SS7"
           End Select
            plugScrew = "ST2" '(11/03/2010)-hezron
           Stitch = "SS1"
        End If
    '*****************************************************************************
  Call InsCode("", screwcode, salesCode, 1, 3 * Int(wid * leng - ROpenings))
'  Call InsCode("", plugScrew, salesCode, 1, 3 * Int(wid * leng - ROpenings) * 0.01) '(11/03/2010)-hezron
  Call InsCode("", Stitch, salesCode, 1, 2 * Int(wid * leng - ROpenings))

'*********************************(11/03/2010)-hezron********************************************
  If Sheet1.Range("E13").Value = Sheet1.Range("E14").Value Then
    
    Select Case Sheet1.Range("E13").Value
      Case "Curved+VGutter"
          flatScrewLength = leng * 2 * 2  'valley gutter
      Case "Gutter+Dwnspts"
          flatScrewLength = leng * 2  'eave gutter
    End Select
    
    Call InsCode("", "SS8", salesCode, 1, flatScrewLength)
    
  End If

'************************************added by hezron*********************************************
'Call InsCode("", "BM2", salesCode, 1, Int(Wid * leng / 14.9) + 1)'original code
'bill out beadmastic quantity
Call QuickEstCalculations.RoofSheetingBeadMasticQuantity(salesCode, rafleng, leng)
'************************************************************************************************
  
If Left$(RSCode, 2) = "PU" Or Left$(RSCode, 2) = "SP" Then
   PPLPU = PPLPU + 1.02 * rafleng * leng - ROpenings
Else
   PPLSS = PPLSS + weight(RSCode) * 1.02 * rafleng * leng - ROpenings
End If

End If
'************** Roof Sheeting Ends ************************************************

'************** Wall Sheeting *****************************************************
'Generate Sandwich Panel Combination Database Record.
WallTopSkin$ = Sheet1.Range("WallTopSkin")
WallCore$ = Sheet1.Range("WallCore")
WallBotSkin$ = Sheet1.Range("WallBotSkin")
WSCode = WallTopSkin$

wallSWPCode = "" 'added by hezron on 4/26/2012
If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
  WSCode = "PU" & WallTopSkin$ & WallCore$ & WallBotSkin$
  
  wallSWPCode = WSCode 'added by hezron on 04/26/2012
  
    'commented by hezron
        '--------------------------------------------------------------------
    'Sandwich Panels code generate

        'put ERP Code -
        'Dim temp As String
        Temp = ""
        Temp = WSCode
        If Left(Temp, 3) = "PUS" Then
            SWP_ERP_CODE = 20411 'Steel
        Else
            SWP_ERP_CODE = 20311 'Aluminum
        End If
        '--------------------------------------------------------------------
End If

Code = WSCode
If Code <> "None" Then
wallCoatableArea = 0
  'Back SideWall
    If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
        If Sheet1.Range("E28").Text = "M45-250" Then
            Call InsCode("Sidewall Sheeting", "-", salesCode, "", "")
            wallCoatableArea = BEH * leng - BSWOpenings 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, BEH * leng - BSWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, BEH * leng - BSWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, BEH * leng - BSWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        Else 'added by hezron
            Call InsCode("Sidewall Sheeting", "-", salesCode, "", "")
            wallCoatableArea = (BEH * leng - BSWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, (BEH * leng - BSWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, (BEH * leng - BSWOpenings))   'modified by hezron 07112012
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, (BEH * leng - BSWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        
        End If
    Else
        If Sheet1.Range("E28").Text = "M45-250" Then
            wallCoatableArea = BEH * leng - BSWOpenings 'added by hezron on 10/04/2010
            Call InsCode("Sidewall Sheeting", WallTopSkin$, salesCode, 1, BEH * leng - BSWOpenings)
        Else 'added by hezron
            wallCoatableArea = (BEH * leng - BSWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("Sidewall Sheeting", WallTopSkin$, salesCode, 1, (BEH * leng - BSWOpenings) / 0.9)
        End If
    End If
    
    
  'Front Sidewall
    If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
        If Sheet1.Range("E28").Text = "M45-250" Then
            wallCoatableArea = wallCoatableArea + FEH * leng - FSWOpenings 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, FEH * leng - FSWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, FEH * leng - FSWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, FEH * leng - FSWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        Else 'added by hezron
            wallCoatableArea = wallCoatableArea + (FEH * leng - FSWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, (FEH * leng - FSWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, (FEH * leng - FSWOpenings)) 'modified by hezron 07112012
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, (FEH * leng - FSWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        
        End If
    Else
        If Sheet1.Range("E28").Text = "M45-250" Then
            wallCoatableArea = wallCoatableArea + FEH * leng - FSWOpenings 'added by hezron on 10/04/2010
            Call InsCode("", WallTopSkin$, salesCode, 1, FEH * leng - FSWOpenings)
        Else 'added by hezron
            wallCoatableArea = wallCoatableArea + (FEH * leng - FSWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("", WallTopSkin$, salesCode, 1, (FEH * leng - FSWOpenings) / 0.9)
        End If
    End If
    
  'Left Endwall
    If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
        If Sheet1.Range("E28").Text = "M45-250" Then
            Call InsCode("Endwall Sheeting", "-", salesCode, "", "")
            wallCoatableArea = wallCoatableArea + EWArea - LEWOpenings 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, EWArea - LEWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, EWArea - LEWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, EWArea - LEWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        Else 'added by hezron
            Call InsCode("Endwall Sheeting", "-", salesCode, "", "")
            wallCoatableArea = wallCoatableArea + (EWArea - LEWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, (EWArea - LEWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, (EWArea - LEWOpenings)) 'modified by hezron 07112012
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, (EWArea - LEWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        End If
    Else
        If Sheet1.Range("E28").Text = "M45-250" Then
            wallCoatableArea = wallCoatableArea + EWArea - LEWOpenings 'added by hezron on 10/04/2010
            Call InsCode("Endwall Sheeting", WallTopSkin$, salesCode, 1, EWArea - LEWOpenings)
        Else 'added by hezron
            wallCoatableArea = wallCoatableArea + (EWArea - LEWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("Endwall Sheeting", WallTopSkin$, salesCode, 1, (EWArea - LEWOpenings) / 0.9)
        End If
    End If
    
    'Right Endwall
    If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
        If Sheet1.Range("E28").Text = "M45-250" Then
            wallCoatableArea = wallCoatableArea + EWArea - REWOpenings 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, EWArea - REWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, EWArea - REWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, EWArea - REWOpenings)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        Else 'added by hezron
            wallCoatableArea = wallCoatableArea + (EWArea - REWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, (EWArea - REWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallCore$, salesCode, 1, (EWArea - REWOpenings))  'modified by hezron 07112012
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("", WallBotSkin$, salesCode, 1, (EWArea - REWOpenings) / 0.9)
                Sheet2.Range("ItemMark").Offset(-1, 3) = SWP_ERP_CODE
            Call InsCode("" & Code, "-", salesCode, "", "")
        End If
    Else
        If Sheet1.Range("E28").Text = "M45-250" Then
            wallCoatableArea = wallCoatableArea + EWArea - REWOpenings 'added by hezron on 10/04/2010
            Call InsCode("", Code, salesCode, 1, EWArea - REWOpenings)
        Else 'added by hezron
            wallCoatableArea = wallCoatableArea + (EWArea - REWOpenings) / 0.9 'added by hezron on 10/04/2010
            Call InsCode("", Code, salesCode, 1, (EWArea - REWOpenings) / 0.9)
        End If
    End If
  
  WShArea = (FEH + BEH) * leng + 2 * EWArea - BSWOpenings - FSWOpenings - LEWOpenings - REWOpenings
  screwcode = "CS2"
  Stitch = "CS1"
  Sheet7.Range("D1") = Sheet1.Range("C24")  'get Wall Insulation input
  InCode = Sheet7.Range("A1")               'get Wall Insulation code
  If InCode <> "None" Then screwcode = "CS3"
  '****************************commented by hezron*********************************
'  If InStr(Code, "A") > 0 Then ScrewCode = "SS2"
'  If InStr(Code, "PUS") > 0 Then ScrewCode = "CS4"
'  If InStr(Code, "PUA") > 0 Then ScrewCode = "SS4"
'  If InStr(Code, "A") > 0 Then Stitch = "SS1"
      '****************************added by hezron*********************************
        If InStr(1, Code, "S", vbTextCompare) = 1 Then  'single skin aluzinc
            If Sheet1.Range("C24") = "None" Then
                screwcode = "CS2"
            Else
                screwcode = "CS3"
            End If
            Stitch = "CS1"
        End If
        If InStr(1, Code, "PUS", vbTextCompare) = 1 Then    'swp aluzinc
            Select Case WallCore$
               Case "Core35BPro", "Core35CPro", "Core35BEco", "Core35CEco"
                   screwcode = "CS4"
               Case "Core50BPro", "Core50CPro", "Core50BEco", "Core50CEco"
                   screwcode = "CS5"
               Case "Core75BPro", "Core75CPro", "Core75BEco", "Core75CEco"
                   screwcode = "CS6"
               Case "Core100BPro", "Core100CPro", "Core100BEco", "Core100CEco"
                   screwcode = "CS7"
            End Select
            Stitch = "CS1"
        End If
       
        If InStr(1, Code, "A", vbTextCompare) = 1 Then  'single skin aluminum
            If Sheet1.Range("C24") = "None" Then
                screwcode = "SS2"
            Else
                screwcode = "SS3"
            End If
            Stitch = "SS1"
        End If
        If InStr(1, Code, "PUA", vbTextCompare) = 1 Then    'swp aluminum
           Select Case WallCore$
               Case "Core35BPro", "Core35CPro", "Core35BEco", "Core35CEco"
                   screwcode = "SS4"
               Case "Core50BPro", "Core50CPro", "Core50BEco", "Core50CEco"
                   screwcode = "SS5"
               Case "Core75BPro", "Core75CPro", "Core75BEco", "Core75CEco"
                   screwcode = "SS6"
               Case "Core100BPro", "Core100CPro", "Core100BEco", "Core100CEco"
                   screwcode = "SS7"
           End Select
           Stitch = "SS1"
        End If
    '*****************************************************************************
  Call InsCode("", screwcode, salesCode, 1, 3 * Int(WShArea))
  Call InsCode("", plugScrew, salesCode, 1, Round(((3 * Int(wid * leng - ROpenings)) + (3 * Int(WShArea))) * 0.01, 0)) '(11/03/2010)-hezron
  If Left$(Code, 2) = "PU" Then
     PPLPU = PPLPU + Int(WShArea)
  Else
     PPLSS = PPLSS + weight(Code) * Int(WShArea)
  End If
End If

'''****************************added by hezron*********************************
''    'get sliding door surface area & quantity
''    Dim doorArea As Double
''
''    For j = 1 To 5
''        If InStr(Sheet1.Range("AccDes").Offset(j, 0).Value, "Slide door") > 0 Then
''            Select Case Sheet1.Range("AccDes").Offset(j, 0).Value
''              Case "Slide door 3mX3m Steel Only with Framed Opening"
''                doorArea = 9 * Sheet1.Range("AccDes").Offset(j, 2).Value
''              Case "Slide door 4mX4m Steel Only with Framed Opening"
''                doorArea = 16 * Sheet1.Range("AccDes").Offset(j, 2).Value
''              Case "Slide door 5mX5m Steel Only with Framed Opening"
''                doorArea = 25 * Sheet1.Range("AccDes").Offset(j, 2).Value
''              Case "Slide door 6mX6m Steel Only with Framed Opening"
''                doorArea = 36 * Sheet1.Range("AccDes").Offset(j, 2).Value
''            End Select
''                'bill out door sheeting
''            If WallCore$ <> "-" And WallBotSkin$ <> "-" Then
''                Call InsCode("Door Sheeting", "-", salesCode, "", "")
''                Call InsCode("Mammut SWP Code: " & Code, WallTopSkin$, salesCode, 1, doorArea)
''                Call InsCode("", WallCore$, salesCode, 1, doorArea)
''                Call InsCode("", WallBotSkin$, salesCode, 1, doorArea)
''                Call InsCode("" & Code, "-", salesCode, "", "")
''            Else
''                Call InsCode("Door Sheeting", WallTopSkin$, salesCode, 1, doorArea)
''            End If
''            Exit For
''        End If
''    Next
''
''
'''*****************************************************************************

'Masonry Nails
If Sheet1.Range("C32").Value = "Full X Full" Then
    Call InsCode("", "Mnail", salesCode, 1, Round((2 * leng + 2 * wid) / 0.5, 0)) 'added by hezron
End If
    
'************** Wall Sheeting Ends**********************************************************

'Roof Liner
Sheet7.Range("D1") = Sheet1.Range("C21")  'get Roof Liner input
Code = Sheet7.Range("A1")                 'get Roof Liner code
RLarea = Sheet1.Range("E21")              'get Roof Linear Area
RLarea = val(RLarea) * 1.1
If val(RLarea) <= 0 Then RLarea = rafleng * leng * 1.12 - ROpenings
If Code <> "None" Then
    'Call InsCode("Roof Liner", Code, salesCode, 1, RLarea)
    Call InsCode("Roof Liner", Code, salesCode, 1, roofCoatableArea * 1.075) '11042010-hezron-modified
  screwcode = "CS2"
  Stitch = "CS1"
  If InStr(Code, "A") > 0 Then screwcode = "SS2"
  If InStr(Code, "PUS") > 0 Then screwcode = "CS4"
  If InStr(Code, "PUA") > 0 Then screwcode = "SS4"
  Call InsCode("", screwcode, salesCode, 1, 4 * Int(RLarea))
  If Left$(Code, 2) = "PU" Then
     PPLPU = PPLPU + Int(RLarea)
  Else
     PPLSS = PPLSS + weight(Code) * Int(RLarea)
  End If
End If
'Wall Liner
Sheet7.Range("D1") = Sheet1.Range("C22")  'get Wall Liner input
Code = Sheet7.Range("A1")                 'get Wall Liner code
WLArea = Sheet1.Range("E22")              'get Wall Linear Area
WLArea = val(WLArea) * 1.1
If val(WLArea) <= 0 Then WLArea = leng * (BEH + FEH) * 1.1 + 2 * EWArea * 1.1 - (LEWOpenings + REWOpenings + FSWOpenings + BSWOpenings)
If Code <> "None" Then
    'Call InsCode("Wall Liner", Code, salesCode, 1, WLArea)
    Call InsCode("Wall Liner", Code, salesCode, 1, wallCoatableArea * 1.075) '11042010-hezron-modified
  screwcode = "CS2"
  If InStr(Code, "A") > 0 Then screwcode = "SS2"
  If InStr(Code, "PUS") > 0 Then screwcode = "CS4"
  If InStr(Code, "PUA") > 0 Then screwcode = "SS4"
  If InStr(Code, "A") > 0 Then Stitch = "SS1"
  Call InsCode("", screwcode, salesCode, 1, 4 * Int(WLArea))
  If Left$(Code, 2) = "PU" Then
     PPLPU = PPLPU + Int(WLArea)
  Else
     PPLSS = PPLSS + weight(Code) * Int(WLArea)
  End If
End If

    'cancelled by Do Nguyen
        'If PPLPU > 0 Then Call InsCode("", "PPLPU", SalesCode, 1, PPLPU)
        'If PPLSS > 0 Then Call InsCode("", "PPLSS", SalesCode, 1, PPLSS)
    'cancelled by Do Nguyen
    
'Trims
PPLTR = 0
Dim peakBoxRF As String
 'get the peak box material used
    If InStr(wallSheeting, "Aluminum") > 0 Then
        peakBoxRF = "MPB2"
    Else
        peakBoxRF = "MPB"
    End If

Call InsCode("Trims:", peakBoxRF, salesCode, 1, 2) 'Ridge Sign
If RSCode <> "None" Then
  Call InsCode("", "GT" + Tr$, salesCode, 1, 2 * CInt(10 * rafleng) / 10) 'Rake Trim
  If nPeaks > 0 Then Call InsCode("", "RP" + Tr$, salesCode, 1, leng * nPeaks)
  If nValeys > 0 Then
     Call InsCode("", "VGG", salesCode, 1, (Int(leng / 5.5) + 1) * nValeys)
     
    '-------------------------------added by hezron-----------------------------
    Call InsCode("", "VGS", salesCode, 1, (Int(leng / 5.5) + 1) * nValeys * 3)
    Call InsCode("", "VGEC", salesCode, 1, nValeys * 2)
    '---------------------------------------------------------------------------

     
     Call InsCode("", "VGS", salesCode, 1, (Int(leng / 1.83) + 1) * nValeys)
     'Call InsCode("", "VGSPL", salesCode, 1, (Int(leng / 5.5) + 1) * nValeys)
     Call InsCode("", "VGEC", salesCode, 1, 2 * nValeys)
     Call InsCode("", "VGDS", salesCode, 1, nValeys * nbays * (BEH + FEH - 0.8) / 2)
     Call InsCode("", "VGDO", salesCode, 1, nValeys * (nbays + 1))
     Call InsCode("", "VGGas", salesCode, 1, nValeys * (nbays + 1))
     If BEH + FEH - 0.8 > 12 Then Call InsCode("", "VGDSJ", salesCode, 1, nValeys * (nbays + 1))
     Call InsCode("", "VGDB1", salesCode, 1, nValeys * (nbays + 1))
     Call InsCode("", "VGDB2", salesCode, 1, nValeys * (nbays + 1))
     'Call InsCode("", "VGDL", salesCode, 1, 1)
     PPLTR = PPLTR + ((Int(leng / 5.5) + 1) + (Int(leng / 5.5) + 1) + (Int(leng / 1.83) + 1)) * nValeys
     PPLTR = PPLTR + nValeys * (2 + nbays * (BEH + FEH - 0.8) / 2 + 4 * (nbays + 1))
  End If
  PPLTR = PPLTR + 2 * CInt(10 * rafleng) / 10 + leng * nPeaks  ' Rake Trim and ridge caps

  'solve eave condition
  CE = 0: VG = 0: EG = 0: ET = 0
  'Back Eave Condition
  BECon = Sheet1.Range("E13")
  If BECon = "Gutter+Dwnspts" Then EG = EG + 1
  If BECon = "Curved " Then CE = CE + 1
  If BECon = "Curved+VGutter" Then
    VG = VG + 1
    CE = CE + 1
  End If
  If BECon = "Eave Trim" Then ET = ET + 1
  'Front Eave Condition
  FECon = Sheet1.Range("E14")
    If FECon = "Gutter+Dwnspts" Then EG = EG + 1
  If FECon = "Curved " Then CE = CE + 1
  If FECon = "Curved+VGutter" Then
    VG = VG + 1
    CE = CE + 1
  End If
  If FECon = "Eave Trim" Then ET = ET + 1
  If ET > 0 Then Call InsCode("", "ET" + Tr$, salesCode, 1, leng * ET)
  If VG > 0 Then Call InsCode("", "VGG", salesCode, 1, (Int(leng / 5.5) + 1) * VG)
'-------------------------------added by hezron-----------------------------
If VG > 0 Then
    Call InsCode("", "VGS", salesCode, 1, (Int(leng / 5.5) + 1) * VG * 3)
    Call InsCode("", "VGEC", salesCode, 1, VG * 2)
End If
'---------------------------------------------------------------------------
  If CE > 0 Then Call InsCode("", "CP" + Tr$, salesCode, 1, leng * CE)
  If EG > 0 Then Call InsCode("", "EG" + Tr$, salesCode, 1, leng * EG)
  If EG > 0 Then Call InsCode("", "ET" + Tr$, salesCode, 1, leng * EG)
  If EG > 0 Then Call InsCode("", "GSTR", salesCode, 1, (Int(leng * 2) + 1) * EG)
  'DownSpouts
  If VG > 0 Then Call InsCode("", "VGDS", salesCode, (BEH + FEH) / 2, VG * CInt(leng / 9) + 1)
  '************************************edited by hezron*********************************************
'If EG > 0 Then Call InsCode("", "DS" + Tr$, SalesCode, (BEH + FEH) / 2, EG * CInt(Leng / 9) + 1)'original code
'If EG > 0 Then Call InsCode("", "RS" + Tr$, SalesCode, 1, EG * CInt(Leng / 9) + 1)'original code
  If EG > 0 Then Call InsCode("", "DS" + Tr1$, salesCode, (BEH + FEH) / 2, EG * CInt(leng / 9) + 1)
  If EG > 0 Then Call InsCode("", "RS" + Tr1$, salesCode, 1, EG * CInt(leng / 9) + 1)
  '*************************************************************************************************
  PPLTR = PPLTR + leng * ET + (Int(leng / 5.5) + 1) * VG + leng * CE + leng * EG
  PPLTR = PPLTR + ((BEH + FEH) / 2) * (VG * CInt(leng / 9) + 1) + ((BEH + FEH) / 2) * (EG * CInt(leng / 9) + 1)
  'If Leng > 120 Then Call InsCode("", "ETrim", sales, 1, BEH + FEH + RafLeng)
  
'************************************edited by hezron*********************************************
    'Drip Trims
    
    'Call InsCode("", "DT" + Tr$, salesCode, 1, (Wid + leng) * 2)'original code
    
    'get wall sheeting type
    Dim wallSheetType As String
    If Sheet1.Range("C155").Value = " " Then
    
    If InStr(1, Sheet1.Range("C154").Value, " AZ Steel 0.5X1219", vbTextCompare) > 0 Then Call InsCode("", "DTS", salesCode, 1, (wid + leng) * 2)
    If InStr(1, Sheet1.Range("C154").Value, " AZ Steel 0.7X1219", vbTextCompare) > 0 Then Call InsCode("", "DTS1", salesCode, 1, (wid + leng) * 2)
    If InStr(1, Sheet1.Range("C154").Value, " Aluminum 0.7X1219", vbTextCompare) > 0 Then Call InsCode("", "DTA", salesCode, 1, (wid + leng) * 2)
    
'        Select Case Sheet1.Range("C154").Value
'            Case " AZ Steel 0.5X1219 (Mill Finish)", " AZ Steel 0.5X1219 (RAL9002) Off white", _
'                 " AZ Steel 0.5X1219 (TBE)", " AZ Steel 0.5X1219 (RAL9002) Off white", " AZ Steel 0.5X1219 (RAL1001) Beige", _
'                 " AZ Steel 0.5X1219 (RAL5012) Blue", " AZ Steel 0.5X1219 (RAL6021) Green" '" AZ Steel 0.5X1219 (RAL1001, RAL5012, RAL6021)"
'                Call InsCode("", "DTS", salesCode, 1, (wid + leng) * 2)
'
'            Case " AZ Steel 0.7X1219  (RAL9002) Off white", " AZ Steel 0.7X1219 (TBE)", " AZ Steel 0.7X1219  (RAL9002) Off white", _
'                 " AZ Steel 0.7X1219 (RAL1001) Beige", " AZ Steel 0.7X1219 (RAL5012) Blue", " AZ Steel 0.7X1219 (RAL6021) Green" '" AZ Steel 0.7X1219 (RAL1001, RAL5012, RAL6021)"
'                Call InsCode("", "DTS1", salesCode, 1, (wid + leng) * 2)
'
'            Case " Aluminum 0.7X1219 (Mill Finish)", " Aluminum 0.7X1219  (RAL9002) Off white", _
'                 " Aluminum 0.7X1219 (TBE)", " Aluminum 0.7X1219  (RAL9002) Off white", _
'                 " Aluminum 0.7X1219 (RAL1001) Beige", " Aluminum 0.7X1219 (RAL5012) Blue", " Aluminum 0.7X1219 (RAL6021) Green" '" Aluminum 0.7X1219 (RAL1001, RAL5012, RAL6021)"
'                Call InsCode("", "DTA", salesCode, 1, (wid + leng) * 2)
'        End Select
    Else
        Select Case Sheet1.Range("C155").Value
            Case " PUCore 35 (35 kg/m3)  ProTec F (B3)", " PUCore 50 (35 kg/m3)  ProTec F (B3)", " PUCore 75 (35 kg/m3) ProTec F (B3)", _
             " PUCore 35 (40 kg/m3) ProTec F (B3)", " PU Core 50 (40 kg/m3) ProTec F (B3)", " PUCore 75 (40 kg/m3) ProTec F (B3)", _
             " PUCore 35 (35 kg/m3) EcoSafe E (B2)", " PUCore 50 (35 kg/m3) EcoSafe E (B2)", " PUCore 75 (35 kg/m3) EcoSafe E (B2)", _
             " PUCore 35 (40 kg/m3) EcoSafe E (B2)", " PU Core 50 (40 kg/m3) EcoSafe E (B2)", " PUCore 75 (40 kg/m3) EcoSafe E (B2)"
                If Sheet1.Range("J26").Value = "0.5 AZ" Then Call InsCode("", "DTSW", salesCode, 1, (wid + leng) * 2)
                If Sheet1.Range("J26").Value = "0.7 AZ" Then Call InsCode("", "DTSW1", salesCode, 1, (wid + leng) * 2)
                If Sheet1.Range("J26").Value = "0.7 AL" Then Call InsCode("", "DTASW", salesCode, 1, (wid + leng) * 2)
            Case " PUCore 100 (35 kg/m3) ProTec F (B3)", " PUCore 100 (40 kg/m3) ProTec F (B3)", _
            " PUCore 100 (35 kg/m3) EcoSafe E (B2)", " PUCore 100 (40 kg/m3) EcoSafe E (B2)"
                If Sheet1.Range("J26").Value = "0.5 AZ" Then Call InsCode("", "DTSW2", salesCode, 1, (wid + leng) * 2)
                If Sheet1.Range("J26").Value = "0.7 AZ" Then Call InsCode("", "DTSW3", salesCode, 1, (wid + leng) * 2)
                If Sheet1.Range("J26").Value = "0.7 AL" Then Call InsCode("", "DTASW1", salesCode, 1, (wid + leng) * 2)
        End Select
    End If

Call InsCode("", "SS8", salesCode, 1, 2 * (leng + wid)) 'flat screw for drip trim added by hezron(11/03/2010)

'DTSW    Drip Trim 35,50&75 SW Panel - 0.5 mm AZ Steel Painted (305)
'DTSW1   Drip Trim 35,50&75 SW Panel - 0.7 mm AZ Steel Painted (305)
'DTASW   Drip Trim 35,50&75 SW Panel - 0.7 mm Aluminum Painted (305)
'
'DTSW2   Drip Trim 100 SW Panel - 0.5 mm AZ Steel Painted (357)
'DTSW3   Drip Trim 100 SW Panel - 0.7 mm AZ Steel Painted (357)
'DTASW1  Drip Trim 100 SW Panel - 0.7 mm Aluminum Painted (357)
'******************************added by hezron****************************************************
  Call InsCode("", "CT" + Tr$, salesCode, 1, (BEH + FEH) * 2) 'original code
  
'  If Sheet1.Range("J26").Value = "0.5 AZ" Then Call InsCode("", "CTS", salesCode, 1, (BEH + FEH) * 2)
'  If Sheet1.Range("J26").Value = "0.7 AZ" Then Call InsCode("", "CTS1", salesCode, 1, (BEH + FEH) * 2)
'  If Sheet1.Range("J26").Value = "0.7 Al" Then Call InsCode("", "CTA", salesCode, 1, (BEH + FEH) * 2)
  
'*************************************************************************************************
End If
NExTrims = Int(leng / 110)
If RSCode <> "None" Then
  If NExTrims > 0 Then Call InsCode("", "EJ" + Tr$, salesCode, CInt(rafleng + BEH + FEH + 0.9), NExTrims)


  '************************************added by hezron*********************************************
    'Call InsCode("", "FMC1", salesCode, 1, 4 * leng + 2 * wid) 'original code
    If Sheet1.Range("E28").Value = "M45-250" Then Call InsCode("", "FMC1", salesCode, 1, 4 * leng + 2 * wid)
    If Sheet1.Range("E28").Value = "M45-150" Then Call InsCode("", "FMC2", salesCode, 1, 4 * leng + 2 * wid)
  
'Call InsCode("", "BM1", salesCode, 1, Int((Wid * leng + Wid * leng / 9) / 14) + 1) 'original code

Dim dSpoutQty As Integer, gutterQty1 As Integer, gutterQty2 As Integer
Dim flowableMasticQty As Double 'downspout
Dim beadMasticQty As Double 'gutter
Dim backEaveCondition As String, frontEaveCondition As String

backEaveCondition = Sheet1.Range("E13").Value
frontEaveCondition = Sheet1.Range("E14").Value

Dim DownspoutQty As Integer
DownspoutQty = QuickEstCalculations.GetDownspoutQty

'calculate gutter quantity
gutterQty1 = Int(leng / 4.2) + 1 'gutter + downspouts
gutterQty2 = Int(leng / 5.5) + 1 'curved + valley gutter

'--------eave gutter
'back eave gutter
If backEaveCondition = "Gutter+Dwnspts" Then
    flowableMasticQty = Round(((DownspoutQty * 0.34) / 6), 2)
    beadMasticQty = Round((gutterQty1 * 0.61) / 9, 2)
End If
If backEaveCondition = "Curved+VGutter" Then
    flowableMasticQty = Round(((DownspoutQty * 0.15) / 6), 2)
    beadMasticQty = Round((gutterQty2 * 1.219) / 9, 2)
End If

'front eave gutter
If frontEaveCondition = "Gutter+Dwnspts" Then
    flowableMasticQty = flowableMasticQty + Round(((DownspoutQty * 0.34) / 6), 2)
    beadMasticQty = beadMasticQty + Round((gutterQty1 * 0.61) / 9, 2)
End If
If frontEaveCondition = "Curved+VGutter" Then
    flowableMasticQty = flowableMasticQty + Round(((DownspoutQty * 0.15) / 6), 2)
    beadMasticQty = beadMasticQty + Round((gutterQty2 * 1.219) / 9, 2)
End If

'bill out
If backEaveCondition = "Gutter+Dwnspts" Or backEaveCondition = "Curved+VGutter" _
Or frontEaveCondition = "Gutter+Dwnspts" Or frontEaveCondition = "Curved+VGutter" Then
    Call InsCode("", "FLM", salesCode, 1, flowableMasticQty) 'downspout
    Call InsCode("", "BM2", salesCode, 1, beadMasticQty) 'gutter
End If

'*************************************************************************************************

  PPLTR = PPLTR + CInt(rafleng + BEH + FEH + 0.9) * NExTrims
  
'purlin & girt tape
'************************************edited by hezron*********************************************
Dim pTapeQty As Integer ' in meters
pTapeQty = 0

'Roof
If Sheet1.Range("C150").Value = " Aluminum 0.7X1219 (Mill Finish)" Then
    pTapeQty = PLINES * leng '(GetBuildingDimension(Sheet1.Range("C12").Value)) 'roof - modified by hezron on 08/17/10
End If
'Wall
If Sheet1.Range("C154").Value = " Aluminum 0.7X1219 (Mill Finish)" Then
    pTapeQty = pTapeQty + (2 * (Int(FEH / 1.75) + 1) * leng) '(GetBuildingDimension(Sheet1.Range("C12").Value))) 'plus sidewalls - modified by hezron on 08/17/10
    GirtLines = CInt((EWArea / wid) / 1.7) 'Calculate Number of Endwall girt lines
    pTapeQty = pTapeQty + (2 * GirtLines * leng) '(GetBuildingDimension(Sheet1.Range("C17").Value))) 'plus endwall - modified by hezron on 08/17/10
End If

If Sheet1.Range("C150").Value = " Aluminum 0.7X1219 (Mill Finish)" Or _
   Sheet1.Range("C154").Value = " Aluminum 0.7X1219 (Mill Finish)" Then
    pTapeQty = pTapeQty / 27.5
    Call InsCode("", "PTAPE", salesCode, 1, pTapeQty)
End If


'*************************************************************************************************
  'cancelled by Do Nguyen
        'If PPLTR > 0 Then Call InsCode("", "PPLTR", SalesCode, 1, PPLTR)
  'cancelled by Do Nguyen
End If
'Insulation
DFTape = 0
ptfrk = 0
ptwk = 0
stpls = 0
stler = 0
InsDes$ = "Insulation"
Sheet7.Range("D1") = Sheet1.Range("C23")  'get Roof Insulation input
Code = Sheet7.Range("A1")                 'get Roof Insulation code
If Code <> "None" Then
   Call InsCode(InsDes$, Code, salesCode, 1, 1.1 * (wid * leng - ROpenings))
'************************************edited by hezron*********************************************
   If Sheet1.Range("E27").Value = "Roof Only" Or Sheet1.Range("E27").Value = "Roof+Wall" Then
    Dim WWMQty As Integer
    'WWM = Round(((1.1 * (wid * leng - ROpenings)) / 66.5) + 1, 2)'quantity based on rolls
    WWM = Round(1.1 * (wid * leng - ROpenings), 2)  'quantity based on area
    Call InsCode("", "WWM", salesCode, 1, WWM)
   End If
'*************************************************************************************************
   InsDes$ = ""
   DFTape = 4 * leng + 2 * wid + 2 * Int(Abs(wid - 20) / 10) * leng
   stpls = 1.1 * (wid * leng - ROpenings) / 375
   If Left(Code, 3) = "FGF" Then ptfrk = ptfrk + wid * leng / 3000
   If Left(Code, 3) = "FGW" Then ptwk = ptwk + wid * leng / 3000
End If
Sheet7.Range("D1") = Sheet1.Range("C24")  'get Wall Insulation input
Code = Sheet7.Range("A1")                 'get Wall Insulation code
If Code <> "None" Then
   Call InsCode(InsDes$, Code, salesCode, 1, 1.1 * (leng * BEH - BSWOpenings + leng * FEH - FSWOpenings + EWArea - LEWOpenings + EWArea - REWOpenings))
'************************************edited by hezron*********************************************
   If Sheet1.Range("E27").Value = "Wall Only" Or Sheet1.Range("E27").Value = "Roof+Wall" Then
    'WWM = Round(((1.1 * (leng * BEH - BSWOpenings + leng * FEH - FSWOpenings + EWArea - LEWOpenings + EWArea - REWOpenings)) / 66.5) + 1, 2)'quantity based on roll
    WWM = Round(1.1 * (leng * BEH - BSWOpenings + leng * FEH - FSWOpenings + EWArea - LEWOpenings + EWArea - REWOpenings), 2)  'quantity based on area
    Call InsCode("", "WWM", salesCode, 1, WWM)
   End If
'*************************************************************************************************
   DFTape = DFTape + 2 * leng + 2 * wid
   stpls = stpls + 1.1 * (leng * BEH - BSWOpenings + leng * FEH - FSWOpenings + EWArea - LEWOpenings + EWArea - REWOpenings) / 375
   If Left(Code, 3) = "FGF" Then ptfrk = ptfrk + (leng * BEH - BSWOpenings + leng * FEH - FSWOpenings + EWArea - LEWOpenings + EWArea - REWOpenings) / 3000
   If Left(Code, 3) = "FGW" Then ptwk = ptwk + (leng * BEH - BSWOpenings + leng * FEH - FSWOpenings + EWArea - LEWOpenings + EWArea - REWOpenings) / 3000
End If
If DFTape > 0 Then    'Insulation Accessories
  If ptfrk > 0 Then Call InsCode("", "PTFRK", salesCode, 1, Int(ptfrk + 1))
  If ptwk > 0 Then Call InsCode("", "PTWK", salesCode, 1, Int(ptwk + 1))
  
'************************************edited by hezron(august 17, 2010)****************************
'  Call InsCode("", "DFTP1", salesCode, 1, DFTape)'original code

'DFTape = RoundUp(wid/25) * 2 * leng
Dim W, L
DFTape = 0

'' Roof Insulation
If Sheet1.Range("C23").Value <> "None" Then
    '**************************************************** 'added by hezron on 05/20/2012
    Dim rIns As String
    rIns = Sheet1.Range("C23").Value
    If InStr(1, rIns, "50mm", vbTextCompare) > 1 Then
        containerFactor1 = 1
    ElseIf InStr(1, rIns, "75mm", vbTextCompare) > 1 Then
        containerFactor1 = 1.5
    ElseIf InStr(1, rIns, "100mm", vbTextCompare) > 1 Then
        containerFactor1 = 2
    End If
    '**************************************************** 'added by hezron on 05/20/2012
    W = wid
    L = leng
    If (W > 25) Then
        DFTape = Application.WorksheetFunction.RoundUp((W / 25), 0) * 2 * L
    Else
        DFTape = DFTape + 2 * L
    End If
End If

'Wall Insulation
If Sheet1.Range("C24").Value <> "None" Then
    '**************************************************** 'added by hezron on 05/20/2012
    Dim wIns As String
    rIns = Sheet1.Range("C24").Value
    If InStr(1, rIns, "50mm", vbTextCompare) > 1 Then
        containerFactor2 = 1
    ElseIf InStr(1, rIns, "75mm", vbTextCompare) > 1 Then
        containerFactor2 = 1.5
    ElseIf InStr(1, rIns, "100mm", vbTextCompare) > 1 Then
        containerFactor2 = 2
    End If
    '**************************************************** 'added by hezron on 05/20/2012
    
    'Front Side Walls
    W = FEH
    L = leng
    If (W > 25) Then
      DFTape = DFTape + Application.WorksheetFunction.RoundUp((W / 25), 0) * 2 * L
    Else
      DFTape = DFTape + 2 * L
    End If
    
    'Back Side Walls
    W = BEH
    L = leng
    If (W > 25) Then
      DFTape = DFTape + Application.WorksheetFunction.RoundUp((W / 25), 0) * 2 * L
    Else
      DFTape = DFTape + 2 * L
    End If
    
    'End Walls
    W = Application.WorksheetFunction.Max(FEH, BEH)
    L = wid
    If (W > 25) Then
      DFTape = DFTape + Application.WorksheetFunction.RoundUp((W / 25), 0) * 2 * L * 2
    Else
      DFTape = DFTape + 4 * L
    End If
End If

 '************************************************************************added by hezron on 05/20/2012
containerFactor = Application.WorksheetFunction.Max(containerFactor1, containerFactor2)
Sheet4.Unprotect ("ResearcH[20.19.5.11.3.9.21.17]")
Sheet5.Range("InsLoads").Value = "=FCPBS!G80*" & containerFactor & "/3500"
Sheet4.Protect ("ResearcH[20.19.5.11.3.9.21.17]")
 '************************************************************************added by hezron on 05/20/2012
 
If DFTape > 0 Then
    DFTape = Round(DFTape, 2)
End If

Call InsCode("", "DFTP1", salesCode, 1, Application.WorksheetFunction.RoundUp(DFTape, 0))

'*************************************************************************************************

'  Call InsCode("", "STPLS", salesCode, 1, Int(stpls + 1))
'  Call InsCode("", "STLER", salesCode, 1, 1)
End If

Call InsCode("", "-", salesCode, 0, 0)
Call RecapInput("Basic")
Sheet8.Range("RecapMark").Offset(-1, 0).PageBreak = xlPageBreakManual
Sheet1.Activate 'Activate Input Sheet
End If

'*****************************added by hezron*********************************
Call QuickEstCalculations.GetSheetingCode
'*****************************************************************************

Sheet2.EnableCalculation = True
Sheet3.EnableCalculation = True
Sheet4.EnableCalculation = True

Sheet7.Protect ("prd82465")
'Sheet7.EnableCalculation = True


'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic
    
'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub
Private Sub AddCanopy_Click()
'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)
        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False

CanDes$ = CStr(Sheet1.Range("CanDes"))
salesCode = Sheet1.Range("CanDes").Offset(0, 2)
Location$ = CStr(Sheet1.Range("CanDes").Offset(1, 2))
BUFinish = Sheet1.Range("CanDes").Offset(2, 2)
CFFinish = Sheet1.Range("CanDes").Offset(3, 2)
LiveLoad = Sheet1.Range("CanDes").Offset(4, 2)
WindSpeed = Sheet1.Range("CanDes").Offset(5, 2)
WLoad = WindSpeed ^ 2 / 20000
FType$ = CStr(Sheet1.Range("CanDes").Offset(1, 0))
Height = Sheet1.Range("CanDes").Offset(2, 0)
wid = Sheet1.Range("CanDes").Offset(3, 0)
ColSpacing$ = CStr(Sheet1.Range("CanDes").Offset(4, 0))
roofSheeting$ = CStr(Sheet1.Range("CanDes").Offset(5, 0))
Drainage$ = CStr(Sheet1.Range("CanDes").Offset(6, 0))
Soffit$ = CStr(Sheet1.Range("CanDes").Offset(7, 0))
wallSheeting$ = CStr(Sheet1.Range("CanDes").Offset(8, 0))
InternalSheeting$ = CStr(Sheet1.Range("CanDes").Offset(9, 0))
Dim Spacing(100, 1) As Double
Call GetList(ColSpacing$, Spacing())
If CStr(CFFinish) = "Alu/Zinc" Or CStr(CFFinish) = "Galvanized" Then
   Sheet5.Range("CFFinish") = 4
Else
   Sheet5.Range("CFFinish") = 3
End If
'*************************
For i = 1 To Spacing(0, 0)
  FLeng = FLeng + Spacing(i, 0) * Spacing(i, 1)
Next i
nbays = Spacing(0, 0)

'-------------------------------
'Roof Extension
'-------------------------------
Sheet2.Activate
If (Left$(FType$, 1) = "R" Or Left$(FType$, 1) = "r") And wid <= 1.5 Then
  
  CanDes$ = "Roof Extension: " + Location$ + ",   " + CanDes$ + ",   Length=" + CStr(FLeng) + ",   Width=" + CStr(wid)
  Call InsCode(CanDes$, "-", salesCode, "", "")
  If Location$ = "Back Sidewall" Or Location$ = "Front Sidewall" Then
  '  Sidewall Roof Extension
    Call InsCode("", "IPEa", salesCode, 0.2 + wid, Spacing(0, 1) + 1)
    Call InsCode("", "MFC1", salesCode, 1, 2 * Spacing(0, 1) + 4)
    Call InsCode("", "HSB16", salesCode, 1, 8 * Spacing(0, 1) + 6)
    'Purlins
    PGBolts = 0
    PLINES = 1
    'End Bays
  PDIndex = 0.65 * TLoad * Spacing(1, 1) ^ 2 ' Calculate Purlin Design Index
  Sheet5.Range("PDIndex") = PDIndex
  PDCode = Sheet5.Range("PDCode")
  Qty = PLINES
  Psize = Spacing(1, 1) + 0.107
  If Spacing(1, 1) > 6.5 Then Psize = Psize + 0.599
  If Spacing(1, 1) > 9 Then Psize = Psize + 0.706
  If Spacing(0, 0) = 1 And Spacing(1, 0) > 1 Then Qty = 2 * Qty
  Call InsCode("End Bay Purlins", PDCode, salesCode, Psize, Qty)
  PGBolts = PGBolts + Qty * 2
  If Spacing(0, 0) > 1 Then
  PDIndex = 0.65 * TLoad * Spacing(Spacing(0, 0), 1) ^ 2
  Sheet5.Range("PDIndex") = PDIndex
  PDCode = Sheet5.Range("PDCode")
  Psize = Spacing(Spacing(0, 0), 1) + 0.107
  If Spacing(Spacing(0, 0), 1) > 6.5 Then Psize = Psize + 0.599
  If Spacing(Spacing(0, 0), 1) > 9 Then Psize = Psize + 0.706
  Call InsCode("", PDCode, salesCode, Psize, Qty)
  PGBolts = PGBolts + Qty * 2
  End If
'Interior Bay Purlins
If Spacing(0, 1) > 2 Then
  IntPurlinDes = "Interior Bay Purlins"
  Spacing(1, 0) = Spacing(1, 0) - 1
  Spacing(Spacing(0, 0), 0) = Spacing(Spacing(0, 0), 0) - 1
  For i = 1 To Spacing(0, 0)
   PDIndex = TLoad * Spacing(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
   PDCode = Sheet5.Range("PDCode")
   Psize = Spacing(i, 1) + 0.107
   If Spacing(i, 1) > 6.5 Then Psize = Psize + 0.599
   If Spacing(i, 1) > 9# Then Psize = Psize + 0.706
   Qty = Spacing(i, 0) * PLINES
   If Spacing(i, 0) > 0 Then
      Call InsCode(IntPurlinDes, PDCode, salesCode, Psize, Qty)
      PGBolts = PGBolts + Qty * 8
      IntPurlinDes = ""
   End If
  Next i
  Spacing(1, 0) = Spacing(1, 0) + 1
  Spacing(Spacing(0, 0), 0) = Spacing(Spacing(0, 0), 0) + 1
  End If
  Call InsCode("", "HSB12", salesCode, 1, PGBolts)
  Shtg$ = "Sheeting & Trims"
  Sheet7.Range("D1") = roofSheeting$
  coder = Sheet7.Range("A1")
  If coder <> "None" Then Call InsCode(Shtg$, coder, salesCode, 1, wid * FLeng): Shtg$ = ""
  Sheet7.Range("D1") = Soffit$
  codes = Sheet7.Range("A1")
  If Drainage$ = "Eave Trim" Then Call InsCode("", "ETS1", salesCode, 1, FLeng)
  If Drainage$ = "Gutter+Dwnspts" Then
    Call InsCode("", "EGS1", salesCode, 1, FLeng)
    Call InsCode("", "DSS1", salesCode, Height, CInt(FLeng / 12) + 1)
  End If
  If codes <> "None" Then Call InsCode(Shtg$, codes, salesCode, 1, wid * FLeng): Shtg$ = ""
  If codes <> "None" Then Call InsCode("", "STS1", salesCode, 1, FLeng) 'Sill Trim
  If coder <> "None" Then SFSQty = (PLINES * 3 + 3) * FLeng
  If codes <> "None" Then SFSQty = SFSQty + FLeng * 9
  screwcode = "CS2"
  If InStr(coder & codes, "A") > 0 Then screwcode = "SS2"
  If SFSQty > 0 Then Call InsCode("", screwcode, salesCode, 1, SFSQty)
  End If
  '
  If Location$ = "Left Endwall" Or Location$ = "Right Endwall" Then
  '  Endwall Roof Extension
     PLINES = CInt(FLeng / 1.5) + 1
     PDIndex = TLoad * wid ^ 2
     Sheet5.Range("PDIndex") = PDIndex
     PDCode = Sheet5.Range("PDCode")
     Psize = wid + 0.706
     Call InsCode("", PDCode, salesCode, Psize, PLINES)
     Call InsCode("", "Gang", salesCode, 1, FLeng)
     Call InsCode("", "HSB12", salesCode, 1, 6 * PLINES)
     Shtg$ = "Sheeting & Trims"
     Sheet7.Range("D1") = roofSheeting$
     coder = Sheet7.Range("A1")
     If coder <> "None" Then
       Call InsCode(Shtg$, coder, salesCode, 1, wid * FLeng): Shtg$ = ""
       Call InsCode("", "GTS1", salesCode, 1, FLeng + 2 * wid)
     End If
     Sheet7.Range("D1") = Soffit$
     codes = Sheet7.Range("A1")
     If codes <> "None" Then Call InsCode(Shtg$, codes, salesCode, 1, wid * FLeng): Shtg$ = ""
     If codes <> "None" Then Call InsCode("", "STS1", salesCode, 1, FLeng)
     If coder <> "None" Then SFSQty = (PLINES * 3 + 3) * FLeng
     If codes <> "None" Then SFSQty = SFSQty + FLeng * 9
     screwcode = "CS2"
     
     If SFSQty > 0 Then Call InsCode("", screwcode, salesCode, 1, SFSQty)
  End If
  '
  If Location$ = "All Around" Then
  '  All Around Roof Extension
     MsgBox ("This program cannot process Roof Extension all around in one shot. Please reinput for each wall at a time.")
  End If
End If
'-------------------------------
'Canopy
'-------------------------------
If Left$(FType$, 1) = "C" Or Left$(FType$, 1) = "c" Then
  CanDes$ = "Canopy: " + Location$ + ",   " + CanDes$ + ",   Length=" + CStr(FLeng) + ",   Height=" + CStr(Height) + ",  Width=" + CStr(wid)
  Call InsCode(CanDes$, "-", salesCode, "", "")
  ReDim PQty(nbays) As Integer
  ReDim PCode(nbays) As String
  TLoad = LiveLoad + 0.15
  If WLoad < WLoad Then TLoad = WLoad
  For i = 1 To nbays
    PostIndex = TLoad * wid ^ 2 * Spacing(i, 1)
    PCode(i) = "IPEa"
    If PostIndex > 49 Then PCode(i) = "UB2"
    If PostIndex > 60 Then PCode(i) = "UB3"
    If PostIndex > 100 Then PCode(i) = "UB4"
  Next i
  For i = 1 To nbays
    Qty = 1
    For j = 1 To nbays
      If PCode(i) = PCode(j) Then
        If i > j Then Qty = 0
        PQty(i) = PQty(i) + Spacing(j, 0) * Qty
      End If
    Next j
  Next i
  '
  PostDes$ = "Rafter"
  For i = 1 To nbays
    If PQty(i) > 0 Then Call InsCode(PostDes$, PCode(i), salesCode, Height + wid + 0.2, PQty(i))
    PostDes$ = ""
  Next i
  Call InsCode("", "MFC1", salesCode, 1, Spacing(0, 1))
  Call InsCode("", "HSB16", salesCode, 1, 8 * Spacing(0, 1))
  'Purlins
  PGBolts = 0
  PLINES = CInt(wid / 1.5) + 1
  'End Bays
  PDIndex = 1.25 * TLoad * Spacing(1, 1) ^ 2 ' Calculate Purlin Design Index
  Sheet5.Range("PDIndex") = PDIndex
  PDCode = Sheet5.Range("PDCode")
  Qty = PLINES
  Psize = Spacing(1, 1) + 0.107
  If Spacing(1, 1) > 6.5 Then Psize = Psize + 0.599
  If Spacing(1, 1) > 9 Then Psize = Psize + 0.706
  If Spacing(0, 0) = 1 And Spacing(1, 0) > 1 Then Qty = 2 * Qty
  Call InsCode("End Bay Purlins", PDCode, salesCode, Psize, Qty)
  PGBolts = PGBolts + Qty * 2
  If Spacing(0, 0) > 1 Then
  PDIndex = 1.25 * TLoad * Spacing(Spacing(0, 0), 1) ^ 2
  Sheet5.Range("PDIndex") = PDIndex
  PDCode = Sheet5.Range("PDCode")
  Psize = Spacing(Spacing(0, 0), 1) + 0.107
  If Spacing(Spacing(0, 0), 1) > 6.5 Then Psize = Psize + 0.599
  If Spacing(Spacing(0, 0), 1) > 9 Then Psize = Psize + 0.706
  Call InsCode("", PDCode, salesCode, Psize, Qty)
  PGBolts = PGBolts + Qty * 2
End If
'Interior Bay Purlins
If Spacing(0, 1) > 2 Then
  IntPurlinDes = "Interior Bay Purlins"
  Spacing(1, 0) = Spacing(1, 0) - 1
  Spacing(Spacing(0, 0), 0) = Spacing(Spacing(0, 0), 0) - 1
  For i = 1 To Spacing(0, 0)
   PDIndex = TLoad * Spacing(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
   PDCode = Sheet5.Range("PDCode")
   Psize = Spacing(i, 1) + 0.107
   If Spacing(i, 1) > 6.5 Then Psize = Psize + 0.599
   If Spacing(i, 1) > 9# Then Psize = Psize + 0.706
   Qty = Spacing(i, 0) * PLINES
   If Spacing(i, 0) > 0 Then
      Call InsCode(IntPurlinDes, PDCode, salesCode, Psize, Qty)
      PGBolts = PGBolts + Qty * 8
      IntPurlinDes = ""
   End If
  Next i
  Spacing(1, 0) = Spacing(1, 0) + 1
  Spacing(Spacing(0, 0), 0) = Spacing(Spacing(0, 0), 0) + 1
  End If
  Call InsCode("", "HSB12", salesCode, 1, PGBolts)
  Shtg$ = "Sheeting & Trims"
  Sheet7.Range("D1") = roofSheeting$
  coder = Sheet7.Range("A1")
  If coder <> "None" Then Call InsCode(Shtg$, coder, salesCode, 1, wid * FLeng): Shtg$ = ""
  Sheet7.Range("D1") = Soffit$
  codes = Sheet7.Range("A1")
  If Drainage$ = "Eave Trim" Then Call InsCode("", "ETS1", salesCode, 1, FLeng)
  If Drainage$ = "Gutter+Dwnspts" Then
    Call InsCode("", "EGS1", salesCode, 1, FLeng)
    Call InsCode("", "DSS1", salesCode, Height, CInt(FLeng / 12) + 1)
  End If
  If codes <> "None" Then Call InsCode(Shtg$, codes, salesCode, 1, wid * FLeng): Shtg$ = ""
  If codes <> "None" Then Call InsCode("", "STS1", salesCode, 1, FLeng)
  If coder <> "None" Then SFSQty = (PLINES * 3 + 3) * FLeng
  If codes <> "None" Then SFSQty = SFSQty + FLeng * 9
  screwcode = "CS2"
  If InStr(coder & codes, "A") > 0 Then screwcode = "SS2"
  If SFSQty > 0 Then Call InsCode("", screwcode, salesCode, 1, SFSQty)
  
End If

'-------------------------------
'Fascia
'-------------------------------
If Left$(FType$, 1) = "F" Or Left$(FType$, 1) = "f" Then
  CanDes$ = "Fascia: " + Location$ + ",   " + CanDes$ + ",   Length=" + CStr(FLeng) + ",   Height=" + CStr(Height)
  Call InsCode(CanDes$, "-", salesCode, "", "")
  nbays = Spacing(0, 0)
  ReDim PQty(nbays) As Integer
  ReDim PCode(nbays) As String
  For i = 1 To nbays
    PostIndex = WindSpeed * (Height + wid) * Spacing(i, 1)
    PCode(i) = "IPEa"
    If PostIndex > 2500 Then PCode(i) = "UB2"
    If PostIndex > 3500 Then PCode(i) = "UB2"
    If PostIndex > 6000 Then PCode(i) = "UB3"
  Next i
  For i = 1 To nbays
    Qty = 1
    For j = 1 To nbays
      If PCode(i) = PCode(j) Then
        If i > j Then Qty = 0
        PQty(i) = PQty(i) + Spacing(j, 0) * Qty
      End If
    Next j
  Next i
  '
  PostDes$ = "Post"
  For i = 1 To nbays
    If PQty(i) > 0 Then Call InsCode(PostDes$, PCode(i), salesCode, Height + wid + 0.2, PQty(i))
    PostDes$ = ""
  Next i
  Call InsCode("", "MFC1", salesCode, 1, Spacing(0, 1))
  Call InsCode("", "HSB16", salesCode, 1, 8 * Spacing(0, 1))
  'Girts
  GClips = 0
  Havg = Height         ' Calculate Average Height
  
  'modified by hezron on 07152012
  '=================================================================================
'  GLines = CInt(Havg + wid / 1.7) + 1 'Calculate Number of Endwall girt lines
  If Havg <= 1.2 Then
    GLines = 3 'Calculate Number of Endwall girt lines
  Else
    GLines = CInt(Havg + wid / 1.7) + 1 'Calculate Number of Endwall girt lines
  End If
  '=================================================================================
  
  GirtDes = "Fascia Girts"
  For i = 1 To nbays
   PDIndex = 2.01 * WindSpeed ^ 2 / 20000 * Spacing(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
   PDCode = Sheet5.Range("PDCode")
   Psize = Spacing(i, 1)
   Qty = Spacing(i, 0) * GLines
   If Qty > 0 Then
      Call InsCode(GirtDes, PDCode, salesCode, Psize, Qty)
      GClips = GClips + 2 * Qty
      PGBolts = PGBolts + Qty * 8
      GirtDes = ""
   End If
  Next i
  Call InsCode("", "HSB12", salesCode, 1, PGBolts)
  If GClips > 0 Then Call InsCode("", "CFClip", salesCode, 1, GClips)
  Shtg$ = "Sheeting & Trim"
  Sheet7.Range("D1") = wallSheeting$
  codew = Sheet7.Range("A1")
  If codew <> "None" Then Call InsCode(Shtg$, codew, salesCode, 1, Height * FLeng): Shtg$ = ""
  Sheet7.Range("D1") = Soffit$
  codes = Sheet7.Range("A1")
  If codes <> "None" Then Call InsCode(Shtg$, codes, salesCode, 1, wid * FLeng): Shtg$ = ""
  Sheet7.Range("D1") = InternalSheeting$
  Codei = Sheet7.Range("A1")
  If Codei <> "None" Then Call InsCode(Shtg$, Codei, salesCode, 1, (Height - 0.5) * FLeng): Shtg$ = ""
  If codew <> "None" Then Call InsCode("", "CFS1", salesCode, 1, FLeng)
  If codew <> "None" Then Call InsCode("", "DTS1", salesCode, 1, FLeng)
  If codes <> "None" Then Call InsCode("", "STS1", salesCode, 1, FLeng)
  If codew <> "None" Then SFSQty = FLeng * Height * 9
  If Codei <> "None" Then SFSQty = SFSQty + FLeng * Height * 9
  If codes <> "None" Then SFSQty = SFSQty + FLeng * 9
  screwcode = "CS2"
  If InStr(coder & codes & codew, "A") > 0 Then screwcode = "SS2"
  If SFSQty > 0 Then Call InsCode("", screwcode, salesCode, 1, SFSQty)
End If
'-----------
Call InsCode("", "-", salesCode, "", "")
    Call RecapInput("Fascia")
        
        Sheet2.EnableCalculation = True
        Sheet3.EnableCalculation = True
        Sheet4.EnableCalculation = True

Sheet1.Activate

'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic

'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub

Private Sub AddCrane_Click()
'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)
        
        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False


CrDes$ = CStr(Sheet1.Range("CrDes"))
salesCode = Sheet1.Range("CrDes").Offset(0, 2)
Duty = Left$(CStr(Sheet1.Range("CrDes").Offset(1, 2)), 1)
Capacity = Sheet1.Range("CrDes").Offset(1, 0)
RailCenters = Sheet1.Range("CrDes").Offset(2, 0)
CraneRun$ = Sheet1.Range("CrDes").Offset(3, 0)
Dim CrRun(100, 1) As Double
Call GetList(CraneRun$, CrRun())
Sheet2.Activate
CrDes$ = CrDes$ + " Capacity=" + CStr(Capacity) + " MT, Run=" + CraneRun$ + " Width=" + CStr(RailCenters)
For i = 1 To CrRun(0, 0)
  CBIndex = Capacity * CrRun(i, 1) * Sqr(RailCenters)
  If Duty = "M" Then CBIndex = 1.1 * CBIndex
  If Duty = "H" Then CBIndex = 1.2 * CBIndex
  'CBcode = "UB6"
  CBcode = "BUCRB4"
  CCCode = "CRC4"
  CrBrCode = "BUCRBr6"
  If CBIndex < 1000 Then
    'CBcode = "UB5"
    CBcode = "BUCRB3"
    CCCode = "CRC4"
    CrBrCode = "BUCRBr5"
  End If
  If CBIndex < 800 Then
    'CBcode = "UB5"
    CBcode = "BUCRB2"
    CCCode = "CRC3"
    CrBrCode = "BUCRBr5"
  End If
  If CBIndex < 600 Then
    'CBcode = "UB45"
    CBcode = "BUCRB2"
    CCCode = "CRC3"
    CrBrCode = "BUCRBr3"
  End If
  If CBIndex < 400 Then
    'CBcode = "UB45"
    CBcode = "BUCRB1"
    CCCode = "CRC2"
    CrBrCode = "BUCRBr3"
  End If
  If CBIndex < 200 Then
    'CBcode = "UB4"
    CBcode = "BUCRB1"
    CCCode = "CRC2"
    CrBrCode = "BUCRBr3"
  End If
  Size = CrRun(i, 1)
  If CBIndex > 1400 Then
    CBcode = "BUB"
    Size = Int(CBIndex / 1400 * 101 * Size)
  End If
  Call InsCode(CrDes$, CBcode, salesCode, Size, 2 * CrRun(i, 0))
  Call InsCode("", CCCode, salesCode, CrRun(i, 1), 2 * CrRun(i, 0))
  Call InsCode("", CrBrCode, salesCode, 1, 2 * CrRun(i, 0) + 2 * Int(i / CrRun(0, 0)))
  CrDes$ = ""
  PPLCRB = PPLCRB + 2 * CrRun(i, 0)
Next i
'Bracing
Call InsCode("", "CRA", salesCode, 1, 4 * CrRun(0, 1))
PPLBRA = 4 * CrRun(0, 1)
'Stoppers
Call InsCode("", "CRS", 1, 1, 4)
'Additional Frame Weight
Call InsCode("", "BU", salesCode, Int(4 * Sqr(CBIndex)), 2 * CrRun(0, 1) + 2)
'Connections
'Bolts
Call InsCode("", "HSB2060", salesCode, 1, 8 * (CrRun(0, 1) + 1)) 'changed from HSB2050 to HSB2060 9.22.11(hez)
Call InsCode("", "HSB16", salesCode, 1, 8 * CrRun(0, 1))
    
    'Call InsCode("Handling, Packing and Loading of Crane Members:", "PPLBu", SalesCode, 1, PPLCRB)
    'Call InsCode("", "PPLHR", SalesCode, 1, PPLBRA)

'
Call InsCode("", "-", salesCode, "", "")
 Call RecapInput("Crane")
 
        Sheet2.EnableCalculation = True
        Sheet3.EnableCalculation = True
        Sheet4.EnableCalculation = True

 
Sheet1.Activate

'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic

'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub

'

Private Sub AddGeneral_Click()

'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)

        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False
        'Sheet6.EnableCalculation = False

If Sheet2.Range("AddGeneral") = "CC" Then AddGeneralItems = MsgBox("Warning: Items applicable to all areas have already been added. Do you want to add them again?", vbYesNo)
If AddGeneralItems = vbNo Then End
  Sheet2.Activate
     desc = Sheet1.Range("PaintSpecs")
     If desc <> "" Then
       Sheet7.Range("D1") = desc
       Code = Sheet7.Range("A1")
       'Qty$ = "=sumif(CostCodes,""10*"",surfaceareas)+sumif(CostCodes,""A2"",surfaceareas)+sumif(CostCodes,""A3"",surfaceareas)+sumif(CostCodes,""A4"",surfaceareas)"
       Qty$ = "=Ceiling(TotalSPaintArea,1)"
       If Code <> "" Then Call InsCode("Paint System (For All Areas)", Code, "P", 1, Qty$)
     End If
     
     'Sheeting special color
     'Qty = Sheet5.Range("TotalShSpCoAr")
     'If Qty >= 0 Then
      ' Qty$ = "=Ceiling(TotalShSpCoAr,1)"
       'Call InsCode("", "SC", "P", 1, Qty$)
     'End If

 ' Treatment Info
     Treatment$ = Sheet1.Range("PaintSpecs").Offset(1, 0)
       Sheet7.Range("D1") = Treatment$
       Code_Paint = Sheet7.Range("A1")
       If Code_Paint <> "None" Then
         Qty$ = "=sumif(CostCodes,10521,Units)+sumif(CostCodes,10211,Units)+sumif(CostCodes,10311,Units)+sumif(CostCodes,10411,Units)/2"
         Call InsCode("", Code_Paint, "P", 1, Qty$)
       End If
       
 'Modified by Do Nguyen
 '----------------------------------------------------
 ' whenever User click on "Add General" on Input Sheet
 ' the program will add all PPL of hole job
 '----------------------------------------------------
        'insert one bank row
        'Call InsCode("PPL for (All Areas)", "-", "S", 1, "")
 
        'PPL Info for Main frames=50111
        If Sheet4.Range("H9") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H9" ' PPL (50111)= 10111
            Call InsCode("PPL for Built Up Members (All Areas)", "PPLBu", "S", 1, Qty$)
        End If
        
        'PPL Info for Crane Beams=50111
        If Sheet4.Range("H13") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H13" ' PPL (50111)= 10411
            Call InsCode("PPL for Crane Beams (All Areas)", "PPLCRB", "S", 1, Qty$)
        End If
        
        'PPL Info for Hot Rolled Members
        If (Sheet4.Range("H10") + Sheet4.Range("H11") + Sheet4.Range("H12")) <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H10+FCPBS!H11+FCPBS!H12" ' PPL (50111)= 10211+10311
            Call InsCode("PPL for Hot Rolled Members (All Areas)", "PPLHR", "S", 1, Qty$)
        End If
        
        'PPL Info for Staircases & Handrails
        If Sheet4.Range("H16") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H16" ' PPL (50111)= 31011
            Call InsCode("PPL for Staircases & Handrails (All Areas)", "PPLSH", "S", 1, Qty$)
        End If
        
        'PPL Info for Cage Ladders
        If Sheet4.Range("H17") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H17" ' PPL (50111)=31111
            Call InsCode("PPL for Cage Ladders (All Areas)", "PPLCL", "S", 1, Qty$)
        End If
        
        'PPL Info for Rod Bracing
        If Sheet4.Range("H18") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H18" ' PPL (50111)=10812
            Call InsCode("PPL for Rod Bracing (All Areas)", "PPLRB", "S", 1, Qty$)
        End If
        
        
        'PPL Info for Checkered Plates & Grating
        If Sheet4.Range("H19") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H19" ' PPL (50111)=31211
            Call InsCode("PPL for Checkered Plates & Grating (All Areas)", "PPLCPG", "S", 1, Qty$)
        End If
 
        'PPL Info for Secondary Members
        If Sheet4.Range("H36") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H28+FCPBS!H29+FCPBS!H30+FCPBS!H31+FCPBS!H32+FCPBS!H33+FCPBS!H34" ' PPL (50311)
            Call InsCode("PPL for Secondary Members (All Areas)", "PPLCF", "S", 1, Qty$)
        End If
        
        ' PPL Info for Steel Standard Buyouts
        If Sheet4.Range("H46") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H37+FCPBS!H38+FCPBS!H39+FCPBS!H40+FCPBS!H41+FCPBS!H42" '50721
            
            Call InsCode("PPL Steel Standard Buyouts (All Areas)", "PPLStBO", "S", 1, Qty$)
        End If
        
        
        'PPL Info for Single Skin Sheeting
        If Sheet4.Range("H55") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H48+FCPBS!H49+FCPBS!H50+FCPBS!H51" ' PPL (50411)
            
            Call InsCode("PPL for Single Skin Sheeting (All Areas)", "PPLSS", "S", 1, Qty$)
        End If
        
        
        'PPL Info for Sandwich Panels
        If Sheet4.Range("H60") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            Qty = "=FCPBS!H56+FCPBS!H57"
            Call InsCode("PPL for Sandwich Panels (All Areas)", "PPLPU", "S", 1, Qty$)
        End If
 
        'PPL Info for Trims & Flashings=50611
        If Sheet4.Range("H66") <> 0 Then
               Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
               Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
               Qty = "=FCPBS!H61+FCPBS!H62+FCPBS!H63+FCPBS!H64"
               Call InsCode("PPL for Trims & Flashings (All Areas)", "PPLTR", "S", 1, Qty$)
        End If
     
        'PPL Info for Panel Standard Buyouts=50731
        If Sheet4.Range("H72") <> 0 Then
                Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
                Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
                ' PPL (50731)
                Qty = "=FCPBS!H67+FCPBS!H68+FCPBS!H69+FCPBS!H70"
                
                Call InsCode("PPL for Panels Standard Buyouts (All Areas)", "PPLPnBO", "S", 1, Qty$)
        End If
        
        
        'PPL Info for Special Buyouts=50711
        If Sheet4.Range("H88") <> 0 Then
            Qty$ = "=sumif(CostCodes,""A8"",Weights)+sumif(CostCodes,""A9"",Weights)+sumif(CostCodes,""A10"",Weights)+sumif(CostCodes,""A14"",Units)"
            Qty$ = Qty$ & " + sumif(CostCodes,""B6"",Weights)+sumif(CostCodes,""B7"",Weights)+sumif(CostCodes,""C*"",Weights)"
            ' PPL (50711)= 30111+30211+30311+30411+30511+30611+30711+30811+30812+11611+30911
            Qty = "=FCPBS!H73+FCPBS!H74+FCPBS!H75+FCPBS!H76+FCPBS!H77+FCPBS!H78+FCPBS!H79+FCPBS!H80+FCPBS!H81+FCPBS!H82+FCPBS!H83"
            
            Call InsCode("PPL for Special Buyouts (All Areas)", "PPLsBO", "S", 1, Qty$)
        End If
        
 '-------end of modified by Do Nguyen
 
 ' Shipping Info
'     desc = Sheet1.Range("PaintSpecs").Offset(2, 0)
'     If desc <> "" Then
'       Sheet7.Range("D1") = desc
'       Code = Sheet7.Range("A1")
'       If Code <> "" Then
'        Dim cF As String
'        cF = containerFactor
'        Call InsCode("Shipping Loads for Building (For All Areas)", Code, "S", 1, "=Ceiling(TotalLoads,1)") '*" & cF)'modified by hezron on 05/14/2012
'        If Left$(Code, 1) = "C" Then
'
'            Call InsCode("", "Skid", "S", 1, "=Ceiling(BldgLoads+PULoads+SSkinLoads+AccLoads,1)-Round(SSkinLoads,2)")
'
'             'added by hezron on 04/26/2012
'            If roofSWPCode <> "" Or wallSWPCode <> "" Then
'                Call InsCode("", "Skid2", "S", 1, Round(Sheet5.Range("SSkinLoads"), 2))
'            End If
'
'        End If
'       End If
'     End If
     
     '----------modified by ZAS on 29-Oct-2012
     
      ' Shipping Info
     desc = Sheet1.Range("PaintSpecs").Offset(2, 0)
     If desc <> "" Then
       Sheet7.Range("D1") = desc
       Code = Sheet7.Range("A1")
       If Code <> "" Then
        Call InsCode("Shipping Loads for Building (For All Areas)", Code, "S", 1, "=Ceiling(TotalLoads,1)")
        If Left$(Code, 1) = "C" Then Call InsCode("", "Skid", "S", 1, "=Ceiling(BldgLoads+PULoads+SSkinLoads+AccLoads,1)")
       End If
     End If
     
'-----------------------------added by hezron on 10/04/2010---------------------------------------------------------
    coatableArea = 0
    Select Case Sheet1.Range("C150").Value2
        Case " AZ Steel 0.5X1219 (Mill Finish) (Coatable for Special Colors)"
        Case " AZ Steel 0.7X1219 (Mill Finish) (Coatable for Special Colors)"
        Case Else
            roofCoatableArea = 0
    End Select
    
    Select Case Sheet1.Range("C154").Value2
        Case " AZ Steel 0.5X1219 (Mill Finish) (Coatable for Special Colors)"
        Case " AZ Steel 0.7X1219 (Mill Finish) (Coatable for Special Colors)"
        Case Else
            wallCoatableArea = 0
    End Select
    
    coatableArea = roofCoatableArea + wallCoatableArea
    
    If coatableArea > 0 Then
        If InStr(Sheet1.Range("C150").Value, "Coatable") > 0 Or InStr(Sheet1.Range("C154").Value, "Coatable") > 0 Then
            If Sheet1.Range("C49") = "Special PVDF Paint for Sheeting Material" Then
                Call InsCode("Special Sheeting Paint:", "PVDF", 1, 1, coatableArea)
            Else
                Call InsCode("Special Sheeting Paint:", "POL", 1, 1, coatableArea)
            End If
        End If
    End If
'-------------------------------------------------------------------------------------------------------------------

     Call InsCode("", "-", salesCode, "", "")
     Call RecapInput("General")
     
        Sheet2.EnableCalculation = True
        Sheet3.EnableCalculation = True
        Sheet4.EnableCalculation = True
        'Sheet6.EnableCalculation = True

    Sheet1.Activate
    
'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic

'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub

Private Sub AddMezz_Click()
'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)
        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False
        
        
  desc$ = Sheet1.Range("MezDes")
  salesCode = Sheet1.Range("MezDes").Offset(0, 2)
  ColSp$ = Sheet1.Range("MezDes").Offset(1, 0)
  BeamSp$ = Sheet1.Range("MezDes").Offset(2, 0)
  JoistSp$ = Sheet1.Range("MezDes").Offset(3, 0)
  ClearHt = CDbl(Sheet1.Range("MezDes").Offset(4, 0))
  DblWld$ = Sheet1.Range("MezDes").Offset(4, 2)
  DeckType$ = Sheet1.Range("MezDes").Offset(5, 0)
  NStairs = CInt(Sheet1.Range("MezDes").Offset(6, 0))
  Dead = CDbl(Sheet1.Range("MezDes").Offset(7, 0))
  Live = CDbl(Sheet1.Range("MezDes").Offset(8, 0))
  AddLoad = CDbl(Sheet1.Range("MezDes").Offset(9, 0))
  BUFinish = Sheet1.Range("MezDes").Offset(1, 2)
  CFFinish = Sheet1.Range("MezDes").Offset(2, 2)
  MinThick = CDbl(Sheet1.Range("MezDes").Offset(3, 2))
  mwplm = Sqr(MinThick / 3.5) * 18.5
  Dim ColSpacing(100, 1) As Double, BeamSpacing(100, 1) As Double, JoistSpacing(100, 1) As Double
  Dim ExColSp() As Double, ExBeamSp() As Double, ExJoistSp() As Double
  Call GetList(ColSp$, ColSpacing()): Call ExpList(ColSpacing(), ExColSp())
  Call GetList(BeamSp$, BeamSpacing()): Call ExpList(BeamSpacing(), ExBeamSp())
  Call GetList(JoistSp$, JoistSpacing()): Call ExpList(JoistSpacing(), ExJoistSp())
  MezWid = 0
  MezLen = 0
  For i = 1 To ExColSp(0)
   MezWid = MezWid + ExColSp(i)
  Next i
  For i = 1 To ExBeamSp(0)
    MezLen = MezLen + ExBeamSp(i)
  Next i
  TLoad = Dead + Live + AddLoad
  
  
' ******************Write Estimate Records***************************
  Sheet2.Activate
  desc$ = desc$ + " (" + CStr(MezWid) + "m X " + CStr(MezLen) + "m Load= " + CStr(TLoad) + " kN/m2)"
  Call InsCode(desc$, "-", salesCode, "", "")
  Sheet7.Range("D1") = DeckType$
  Code = Sheet7.Range("A1")
  PPLDeck = weight(Code) * MezWid * MezLen
  Call InsCode("", Code, salesCode, 1, MezWid * MezLen)
  Call InsCode("", "MEA", salesCode, 1, 2 * (MezLen + MezWid))
  Call InsCode("", "MDF", salesCode, 1, 6 * MezLen * MezWid)
  'Joists
  nJoists = Int(MezWid / JoistSpacing(1, 1)) + 1 'Limitation of one Joist Spacing
  Des$ = "Joists (" & nJoists & " runs @ " & MezLen & "m)"
  JoistLeng = 0
  For i = 1 To BeamSpacing(0, 0)
    span = BeamSpacing(i, 1)
    Qty = nJoists * BeamSpacing(i, 0)
    JDIndex = span ^ 2 * TLoad * JoistSpacing(1, 1)
    Sheet5.Range("JDIndex") = JDIndex
    JDCode = Sheet5.Range("JDCode")
    Size = span
    If JDCode = "BUB" Then Size = Int(JDIndex / 1000 * span * 40)
    Call InsCode(Des$, JDCode, salesCode, Size, Qty): Des$ = ""
    If JDCode = "BUB" Then JoistLeng = JoistLeng + Qty * span
    JoistClips = JoistClips + Qty
  Next i
  If DblWld$ = "Yes" Then Call InsCode(Des$, "DSW", salesCode, 1, JoistLeng)
  Call InsCode(Des$, "BuLeng", salesCode, 1, JoistLeng)
  Call InsCode("", "JCL", salesCode, 1, 2 * JoistClips)
  Call InsCode("", "HSB12", salesCode, 1, 2 * JoistClips * 3)
  'Beams
  nBeams = ExColSp(0) * (ExBeamSp(0) + 1)
  ReDim MezBeams(nBeams)
  BeamLeng = 0
  For i = 1 To ExBeamSp(0) + 1
    If i > 1 And i < ExBeamSp(0) + 1 Then BeamLoad = TLoad * (ExBeamSp(i - 1) + ExBeamSp(i)) / 2
    If i = 1 Then BeamLoad = 0.6 * TLoad * ExBeamSp(1)
    If i = ExBeamSp(0) + 1 Then BeamLoad = 0.6 * ExBeamSp(i - 1) * TLoad
    For j = 1 To ExColSp(0)
      span = ExColSp(j)
      M = BeamLoad * span ^ 2 / 8
      wplm = 0.55 * M / span + 0.66 * M ^ 0.67
      If wplm < 1.32 * M ^ 0.67 Then wplm = 1.32 * M ^ 0.67
      If wplm < mwplm Then wplm = mwplm
      MezBeams((i - 1) * ExColSp(0) + j) = Int(wplm * span)
      BeamLeng = BeamLeng + span
    Next j
  Next i
  'Group Beams and write beam records
  ReDim MBQty(nBeams)
  Des$ = "Mezzanine Beams " & CStr(nBeams) & " Nos"
  For i = 1 To nBeams
   Qty = 1
   For j = 1 To nBeams
    If MezBeams(i) = MezBeams(j) Then
      If j < i Then Qty = 0
      MBQty(i) = MBQty(i) + 1
    End If
   Next j
   MBQty(i) = MBQty(i) * Qty
   If MBQty(i) > 0 Then
    Call InsCode(Des$, "BUB", salesCode, MezBeams(i), MBQty(i))
    Des$ = ""
    If MezBeams(i) < 450 Then
       BCPs = BCPs + MBQty(i) * 4
    Else
       BCPl = BCPl + MBQty(i) * 4
    End If
   End If
  Next i
  If DblWld$ = "Yes" Then Call InsCode(Des$, "DSW", salesCode, 1, BeamLeng)
  Call InsCode("", "BuLeng", salesCode, 1, BeamLeng)
  If BCPs > 0 Then Call InsCode("", "MFC1", salesCode, 1, BCPs)
  If BCPl > 0 Then Call InsCode("", "MFC3", salesCode, 1, BCPl)
  If BCPs + BCPl > 0 Then Call InsCode("", "HSB2060", salesCode, 1, 6 * BCPs + 8 * BCPl) 'changed from HSB2050 to HSB2060 9.22.11(hez)
  'Mezzanine Columns
  nColumns = (ExColSp(0) + 1) * (ExBeamSp(0) + 1)
  ReDim ColCode(nColumns) As String
  ReDim ColSize(nColumns) As Double
  For i = 1 To ExColSp(0) + 1
    If i = 1 Then ist = 0
    If i > 1 Then ist = ExColSp(i - 1)
    If i > ExColSp(0) Then ie = 0
    If i <= ExColSp(0) Then ie = ExColSp(i)
    For j = 1 To ExBeamSp(0) + 1
      If j = 1 Then jst = 0
      If j > 1 Then ist = ExBeamSp(j - 1)
      If j > ExBeamSp(0) Then je = 0
      If j <= ExBeamSp(0) Then je = ExBeamSp(j)
      cn = j + (i - 1) * (ExBeamSp(0) + 1)
      Height = ClearHt + 0.3
      If Height < 2 Then Height = 2
      ColIndex = TLoad * (jst + je) * (ist + ie) / 4 * Height ^ 2
      'Sheet5.Range("ColIndex") = ColIndex
      'ColCode(cn) = Sheet5.Range("ColCode")
      ColSize(cn) = ClearHt + 0.3
      ColCode(cn) = "BUC"
      If ColIndex < 4500 Then ColCode(cn) = "T200"
      If ColIndex < 1950 Then ColCode(cn) = "T150"
      If ColIndex < 600 Then ColCode(cn) = "IPEa"
      If ColCode(cn) = "BUC" Then ColSize(cn) = Int(ColSize(cn) * ColIndex / 4500 * 36)
    Next j
  Next i
  ReDim ColQty(nColumns)  ' Regroup Columns
  Des$ = "Mezzanine Columns " & CStr(nColumns) & " Nos"
  For i = 1 To nColumns
   Qty = 1
   For j = 1 To nColumns
    If ColSize(i) = ColSize(j) And ColCode(i) = ColCode(j) Then
      If j < i Then Qty = 0
      ColQty(i) = ColQty(i) + 1
    End If
   Next j
   ColQty(i) = ColQty(i) * Qty
   If ColQty(i) > 0 Then
    Call InsCode(Des$, ColCode(i), salesCode, ColSize(i), ColQty(i))
    Des$ = ""
   End If
  Next i
  If nColumns > 0 Then Call InsCode("", "MFC1", salesCode, 1, nColumns)
  If nColumns > 0 Then Call InsCode("", "AB24", salesCode, 1, 4 * nColumns)
  If NStairs > 0 Then Call InsCode(" ", "DSP", salesCode, 1, NStairs)
  Des$ = " Handling, Packing & Loading (Mezzanine Items):"
    '
    'If PPLDeck > 0 Then Call InsCode(Des$, "PPLSS", SalesCode, 1, PPLDeck): Des$ = ""
    'If JoistLeng > 0 Then Call InsCode(Des$, "PPLBu", SalesCode, 1, JoistClips): Des$ = ""
    'If BeamLeng > 0 Then Call InsCode(Des$, "PPLBu", SalesCode, 1, nBeams): Des$ = ""
    'If nColumns > 0 Then Call InsCode(Des$, "PPLHR", SalesCode, 1, nColumns): Des$ = ""
    
  Call InsCode("", "-", salesCode, "", "")
  Sheet2.Range("ItemStart").Activate
   Call RecapInput("Mezzanine")
        
        Sheet2.EnableCalculation = True
        Sheet3.EnableCalculation = True
        Sheet4.EnableCalculation = True

   
  Sheet1.Activate

'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic

'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub

Private Sub AddMonitor_Click()
    Call AddRoofMonitor.AddRoofMonitor
End Sub

Private Sub AddPartition_Click()
'Disable the worksheet change event
Application.EnableEvents = False

Call Activation(x)
        Sheet2.EnableCalculation = False
        Sheet3.EnableCalculation = False
        Sheet4.EnableCalculation = False

  ParDes = Sheet1.Range("ParDes")
  salesCode = Sheet1.Range("ParDes").Offset(0, 2)
  Direction = Sheet1.Range("ParDes").Offset(1, 2)
  BUFinish = Sheet1.Range("ParDes").Offset(2, 2)
  CFFinish = Sheet1.Range("ParDes").Offset(3, 2)
  WindSpeed = Sheet1.Range("ParDes").Offset(4, 2)
  ColSp = Sheet1.Range("ParDes").Offset(1, 0)
  Height = Sheet1.Range("ParDes").Offset(2, 0)
  OpenHt = Sheet1.Range("ParDes").Offset(3, 0)
  FrShtg = Sheet1.Range("ParDes").Offset(4, 0)
  BkShtg = Sheet1.Range("ParDes").Offset(5, 0)
  Insulation = Sheet1.Range("ParDes").Offset(6, 0)
  Dim ColSpacing(100, 1) As Double
  Call GetList(CStr(ColSp), ColSpacing())
  For i = 1 To ColSpacing(0, 0)
     leng = leng + ColSpacing(i, 0) * ColSpacing(i, 1)
  Next i
  ParDes = ("Partition: " + CStr(ParDes) + ",  Width=" + CStr(leng) + ",  Height=" + CStr(Height))
  If CStr(CFFinish) = "Alu/Zinc" Or CStr(CFFinish) = "Galvanized" Then
    Sheet5.Range("CFFinish") = 4
  Else
    Sheet5.Range("CFFinish") = 3
  End If
'---------
Sheet2.Activate
' Columns
Call InsCode(ParDes, "-", salesCode, "", "")
  desc$ = "Partition Columns"
  For i = 1 To ColSpacing(0, 0)
    If i > 1 Then desc$ = ""
    Qty = ColSpacing(i, 0)
    TrWidth = ColSpacing(i, 1)
    If i = ColSpacing(0, 0) Then Qty = Qty + 1
    EWCIndex = WindSpeed ^ 2 / 20000 * Height ^ 3 * TrWidth / 3
    Sheet5.Range("EWCIndex") = EWCIndex
    Code = Sheet5.Range("EWCCode")
    Call InsCode(desc$, Code, salesCode, Height, Qty)
  Next i
Call InsCode("", "CFClip", salesCode, 1, 4 * ColSpacing(0, 1) + 4)
Call InsCode("", "HSB12", salesCode, 1, 6 * ColSpacing(0, 1) + 6)
Call InsCode("", "AB16", salesCode, 1, 2 * ColSpacing(0, 1) + 2)
'Girts
GClips = 0
Havg = Height - OpenHt       ' Calculate Average Height
EWGLines = CInt(Havg / 1.9) + 1 'Calculate Number of Endwall girt lines
EWGirtDes = "Partition Wall Girts"
'
For i = 1 To ColSpacing(0, 0)
   PDIndex = 2.01 * Wind * ColSpacing(i, 1) ^ 2
   Sheet5.Range("PDIndex") = PDIndex
   PDCode = Sheet5.Range("PDCode")
   Psize = ColSpacing(i, 1)
   Qty = ColSpacing(i, 0) * EWGLines
   If Qty > 0 Then
      Call InsCode(EWGirtDes, PDCode, salesCode, Psize, Qty)
      GClips = GClips + 2 * Qty
      PGBolts = PGBolts + Qty * 8
      EWGirtDes = ""
      If Psize > 7.5 Then SagRods = SagRods + Qty
   End If
Next i
Call InsCode("", "HSB12", salesCode, 1, PGBolts)
If GClips > 0 Then Call InsCode("", "CFClip", salesCode, 1, GClips)
'Gable Angle/Base Angle
Call InsCode("", "Gang", salesCode, 1, 2 * leng)
If CDbl(OpenHt) = 0 Then Call InsCode("", "Bang", salesCode, 1, 2 * leng)
If SagRods > 0 Then Call InsCode("", "SR12", salesCode, 1, SagRods)
'Sheeting & Trims
ShtDes$ = "Sheeting & Trims"
CodeF = CodeOf(FrShtg)
If CodeF <> "None" Then Call InsCode(ShtDes$, CodeF, salesCode, 1, leng * (Height - OpenHt)): ShtDes$ = ""
CodeB = CodeOf(BkShtg)
If CodeB <> "None" Then Call InsCode(ShtDes$, CodeB, salesCode, 1, leng * (Height - OpenHt)): ShtDes$ = ""
If CodeF <> "None" Then
   TTrim = leng + 2 * (Height - OpenHt)
   PFasteners = 4 * leng * (Height - OpHeight)
End If
If CodeB <> "None" Then
   TTrim = TTrim + leng + 2 * (Height - OpenHt)
   PFasteners = PFasteners + leng * (Height - OpenHt)
End If
If TTrim > 0 Then Call InsCode("", "TTS1", salesCode, 1, TTrim)
screwcode = "CS2"
If InStr(CodeB & CodeF, "A") > 0 Then screwcode = "SS2"
If PFasteners > 0 Then Call InsCode("", screwcode, salesCode, 1, PFasteners)
'---------
Call InsCode("", "-", salesCode, "", "")
    Call RecapInput("Partition")
    
        Sheet2.EnableCalculation = True
        Sheet3.EnableCalculation = True
        Sheet4.EnableCalculation = True

        
Sheet1.Activate

'Disable the worksheet change event
Application.EnableEvents = True

Call QuickEstCalculations.GetPhaseNumberFromMAKDB

''Clear the contents of "RawMat" sheet
'Worksheets("RawMat").Cells.Clear

Application.Calculation = xlAutomatic

'Worksheets("Detail").Activate
'
'Call CheckBlankEntry
'
'Worksheets("Input").Activate

End Sub

    
Private Sub btnAddGalvanized_Click()
    If Sheet1.Range("E10") = "Galvanized" Then
        Call InsCode("Built-Up/Hot-Rolled Finish", "Galv", salesCode, 1, Sheet4.Range("H22").Value) 'Added by hezron on 10/19/2011
    End If
End Sub

Private Sub btnAddSSL_Click()

    On Error GoTo ErrHandler:
    
    'added by hezron(09.19.2011)
    '================================================================================================
    'Revert to default color
    Sheet2.Range("ItemMark").Offset(-1, 4).Font.Color = RGB(0, 0, 0)
    Sheet2.Range("ItemMark").Offset(-1, 10).Font.Color = RGB(0, 0, 0)
    Sheet2.Range("ItemMark").Offset(-1, 17).Font.Color = RGB(0, 0, 0)
    '================================================================================================
    
    Dim ssHR1 As String, ssHR2 As String, ssTube As String, ssHRail As String, ssTruss As String
    Dim ssMiscSteel As String, ssBU As String, ssPL As String, ssRoofClad As String, ssWallClad As String
    Dim ssMfg As String, ssSurfPrep As String, ssPaint As String, ssTesting As String, ssMatHandling As String
    Dim ssFreight As String
    
     ssHR1 = Sheet1.Range("H124")
     ssHR2 = Sheet1.Range("H125")
     ssTube = Sheet1.Range("H126")
     ssHRail = Sheet1.Range("H127")
     ssTruss = Sheet1.Range("H128")
     ssMiscSteel = Sheet1.Range("H129")
     ssBU = Sheet1.Range("H130")
     ssPL = Sheet1.Range("H131")
     ssRoofClad = Sheet1.Range("H132")
     ssWallClad = Sheet1.Range("H133")
     ssMfg = Sheet1.Range("H134")
     ssSurfPrep = Sheet1.Range("H135")
     ssPaint = Sheet1.Range("H136")
     ssTesting = Sheet1.Range("H137")
     ssMatHandling = Sheet1.Range("H138")
     ssFreight = Sheet1.Range("H139")
   
    If (Sheet1.Range("H124").Value <> "" And Sheet1.Range("D124").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C124"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H124").Value <> "" And Sheet1.Range("D124").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C124"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H125").Value <> "" And Sheet1.Range("D125").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C125"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H125").Value <> "" And Sheet1.Range("D125").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C125"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H126").Value <> "" And Sheet1.Range("D126").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C126"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H126").Value <> "" And Sheet1.Range("D126").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C126"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H127").Value <> "" And Sheet1.Range("D127").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C127"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H127").Value <> "" And Sheet1.Range("D127").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C127"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H128").Value <> "" And Sheet1.Range("D128").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C128"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H128").Value <> "" And Sheet1.Range("D128").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C128"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H129").Value <> "" And Sheet1.Range("D129").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C129"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H129").Value <> "" And Sheet1.Range("D129").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C129"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H130").Value <> "" And Sheet1.Range("D130").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C130"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H130").Value <> "" And Sheet1.Range("D130").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C130"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H131").Value <> "" And Sheet1.Range("D131").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C131"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H131").Value <> "" And Sheet1.Range("D131").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C131"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H132").Value <> "" And Sheet1.Range("D132").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C132"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H132").Value <> "" And Sheet1.Range("D132").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C132"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H133").Value <> "" And Sheet1.Range("D133").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C133"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H133").Value <> "" And Sheet1.Range("D133").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C133"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H134").Value <> "" And Sheet1.Range("D134").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C134"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H134").Value <> "" And Sheet1.Range("D134").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C134"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H135").Value <> "" And Sheet1.Range("D135").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C135"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H135").Value <> "" And Sheet1.Range("D135").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C135"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H136").Value <> "" And Sheet1.Range("D136").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C136"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H136").Value <> "" And Sheet1.Range("D136").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C136"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H137").Value <> "" And Sheet1.Range("D137").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C137"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H137").Value <> "" And Sheet1.Range("D137").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C137"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H138").Value <> "" And Sheet1.Range("D138").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C138"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H138").Value <> "" And Sheet1.Range("D138").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C138"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    If (Sheet1.Range("H139").Value <> "" And Sheet1.Range("D139").Value = "") Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C139"), vbExclamation, "QuickEst"
        Exit Sub
    ElseIf (Sheet1.Range("H139").Value <> "" And Sheet1.Range("D139").Value = 0) Then
        MsgBox "Please provide quantity for" & Sheet1.Range("C139"), vbExclamation, "QuickEst"
        Exit Sub
    End If
    
    'Disable the worksheet change event
    Application.EnableEvents = False
    
    'Call Activation(x)
    Sheet2.EnableCalculation = False
    Sheet3.EnableCalculation = False
    Sheet4.EnableCalculation = False
    
    Sheet2.Activate
    
    If ssHR1 = "" And ssHR2 = "" And ssTube = "" And ssHRail = "" And ssTruss = "" And ssMiscSteel = "" _
    And ssBU = "" And ssPL = "" And ssRoofClad = "" And ssWallClad = "" And ssMfg = "" And ssSurfPrep = "" _
    And ssPaint = "" And ssTesting = "" And ssMatHandling = "" And ssFreight = "" Then
        'Do Nothing
    Else
        'added by hezron(09.19.2011)
        '================================================================================================
        If Sheet1.Range("D136") = "" Then
            Call InsCode("Structural Steel (Scrap " & Sheet1.Range("I132") & "%, Conn " & Sheet1.Range("J132") & "%, Bolts " & Sheet1.Range("K132") & "%)", "", "", "", "")
        Else
            Call InsCode("Structural Steel (Scrap " & Sheet1.Range("I132") & "%, Conn " & Sheet1.Range("J132") & "%, Bolts " & Sheet1.Range("K132") & "%)", "", "", "", "")
        End If
       '================================================================================================
    End If
           
    Dim memberConnection As Variant
    
    'Hot Rolled (I-Section) type 1
    description = Sheet1.Range("H124")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D124"))
        
        If Sheet1.Range("E124") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSHRL"
                    Call InsCode("", "SSHRSCR1", 1, 1, Sheet1.Range("D124") * Sheet1.Range("E124")) 'Scrap
                Case "SSHRM"
                    Call InsCode("", "SSHRSCR2", 1, 1, Sheet1.Range("D124") * Sheet1.Range("E124")) 'Scrap
                Case "SSHRH"
                    Call InsCode("", "SSHRSCR3", 1, 1, Sheet1.Range("D124") * Sheet1.Range("E124")) 'Scrap
                Case "SSHRE"
                    Call InsCode("", "SSHRSCR4", 1, 1, Sheet1.Range("D124") * Sheet1.Range("E124")) 'Scrap
                Case "SSHRS"
                    Call InsCode("", "SSHRSCR5", 1, 1, Sheet1.Range("D124") * Sheet1.Range("E124")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F124") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D124") * Sheet1.Range("F124")) 'End Plate
        End If
        
        If Sheet1.Range("G124") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D124") * Sheet1.Range("G124")) 'Connection Bolts
        End If
    End If

    'Hot Rolled (I-Section) type 2
    description = Sheet1.Range("H125")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D125"))
        
        If Sheet1.Range("E125") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSHRW2"
                    Call InsCode("", "SSHRSCW2", 1, 1, Sheet1.Range("D125") * Sheet1.Range("E125")) 'Scrap
                Case "SSHRU2"
                    Call InsCode("", "SSHRSCU2", 1, 1, Sheet1.Range("D125") * Sheet1.Range("E125")) 'Scrap
                Case "SSHRH2"
                    Call InsCode("", "SSHRSCH2", 1, 1, Sheet1.Range("D125") * Sheet1.Range("E125")) 'Scrap
                Case "SSHRA2"
                    Call InsCode("", "SSHRSCA2", 1, 1, Sheet1.Range("D125") * Sheet1.Range("E125")) 'Scrap
                Case "SSHRP2"
                    Call InsCode("", "SSHRSCP2", 1, 1, Sheet1.Range("D125") * Sheet1.Range("E125")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F125") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D125") * Sheet1.Range("F125")) 'End Plate
        End If
        
        If Sheet1.Range("G125") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D125") * Sheet1.Range("G125")) 'Connection Bolts
        End If
    End If
    
    'HR Tubes
    description = Sheet1.Range("H126")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D126"))
        
        If Sheet1.Range("E126") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSSHS"
                    Call InsCode("", "SSTUSCR1", 1, 1, Sheet1.Range("D126") * Sheet1.Range("E126")) 'Scrap
                Case "SSRHS"
                    Call InsCode("", "SSTUSCR2", 1, 1, Sheet1.Range("D126") * Sheet1.Range("E126")) 'Scrap
                Case "SSCHS"
                    Call InsCode("", "SSTUSCR3", 1, 1, Sheet1.Range("D126") * Sheet1.Range("E126")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F126") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D126") * Sheet1.Range("F126")) 'End Plate
        End If
        
        If Sheet1.Range("G126") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D126") * Sheet1.Range("G126")) 'Connection Bolts
        End If
    End If
     
    'Hand Rails
    description = Sheet1.Range("H127")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D127"))
        
        If Sheet1.Range("E127") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSHLP"
                    Call InsCode("", "SSHRLSCR1", 1, 1, Sheet1.Range("D127") * Sheet1.Range("E127")) 'Scrap
                Case "SSHLA"
                    Call InsCode("", "SSHRLSCR2", 1, 1, Sheet1.Range("D127") * Sheet1.Range("E127")) 'Scrap
                Case "SSHLB"
                    Call InsCode("", "SSHRLSCR3", 1, 1, Sheet1.Range("D127") * Sheet1.Range("E127")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F127") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D127") * Sheet1.Range("F127")) 'End Plate
        End If
        
        If Sheet1.Range("G127") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D127") * Sheet1.Range("G127")) 'Connection Bolts
        End If
    End If
    
    'HR Truss
    description = Sheet1.Range("H128")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D128"))
        
        If Sheet1.Range("E128") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSWAT"
                    Call InsCode("", "SSTRSCR1", 1, 1, Sheet1.Range("D128") * Sheet1.Range("E128")) 'Scrap
                Case "SSWHT"
                    Call InsCode("", "SSTRSCR2", 1, 1, Sheet1.Range("D128") * Sheet1.Range("E128")) 'Scrap
                Case "SSWTT"
                    Call InsCode("", "SSTRSCR3", 1, 1, Sheet1.Range("D128") * Sheet1.Range("E128")) 'Scrap
                Case "SSBAT"
                    Call InsCode("", "SSTRSCR4", 1, 1, Sheet1.Range("D128") * Sheet1.Range("E128")) 'Scrap
                Case "SSBHT"
                    Call InsCode("", "SSTRSCR5", 1, 1, Sheet1.Range("D128") * Sheet1.Range("E128")) 'Scrap
                Case "SSBTT"
                    Call InsCode("", "SSTRSCR6", 1, 1, Sheet1.Range("D128") * Sheet1.Range("E128")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F128") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D128") * Sheet1.Range("F128")) 'End Plate
        End If
        
        If Sheet1.Range("G128") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D128") * Sheet1.Range("G128")) 'Connection Bolts
        End If
    End If
    
    'Miscellaneous Steel
    description = Sheet1.Range("H129")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D129"))
        
        If Sheet1.Range("E129") <> "" Then
            On Error Resume Next
            Select Case description
'                Case "SSANB"
'                    Call InsCode("", "", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
'                Case "SSSHS"
'                    Call InsCode("", "", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSSTR"
                    Call InsCode("", "SSSTRSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSTRD"
                    Call InsCode("", "SSTRDSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSLAD"
                    Call InsCode("", "SSLADSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSCHQ"
                    Call InsCode("", "SSCHQSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSGRT"
                    Call InsCode("", "SSGRTSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSDCK"
                    Call InsCode("", "SSDCKSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSCFZS"
                    Call InsCode("", "SSCFZSSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSCFCS"
                    Call InsCode("", "SSCFCSSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSCFAS"
                    Call InsCode("", "SSCFASSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SHSSTRS"
                    Call InsCode("", "SHSSTRSSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SHSSFS"
                    Call InsCode("", "SHSSFSSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SHSSAC"
                    Call InsCode("", "SHSSACSCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSSR12"
                    Call InsCode("", "SSSR12SCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
                Case "SSSR16"
                    Call InsCode("", "SSSR16SCR", 1, 1, Sheet1.Range("D129") * Sheet1.Range("E129")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F129") <> "" Then
            On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D129") * Sheet1.Range("F129")) 'End Plate
        End If
        
        If Sheet1.Range("G129") <> "" Then
            On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D129") * Sheet1.Range("G129")) 'Connection Bolts
        End If
        
    End If
    
    'Built-Ups
    description = Sheet1.Range("H130")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D130"))
        
        If Sheet1.Range("E130") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSBUL"
                    Call InsCode("", "SSBUSCR1", 1, 1, Sheet1.Range("D130") * Sheet1.Range("E130")) 'Scrap
                Case "SSBUM"
                    Call InsCode("", "SSBUSCR2", 1, 1, Sheet1.Range("D130") * Sheet1.Range("E130")) 'Scrap
                Case "SSBUH"
                    Call InsCode("", "SSBUSCR3", 1, 1, Sheet1.Range("D130") * Sheet1.Range("E130")) 'Scrap
                Case "SSBUE"
                    Call InsCode("", "SSBUSCR4", 1, 1, Sheet1.Range("D130") * Sheet1.Range("E130")) 'Scrap
                Case "SSBUS"
                    Call InsCode("", "SSBUSCR5", 1, 1, Sheet1.Range("D130") * Sheet1.Range("E130")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F130") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D130") * Sheet1.Range("F130")) 'End Plate
        End If
        
        If Sheet1.Range("G130") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D130") * Sheet1.Range("G130")) 'Connection Bolts
        End If
    End If
    
    'Plates
    description = Sheet1.Range("H131")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D131"))
        
        If Sheet1.Range("E131") <> "" Then
        On Error Resume Next
            Select Case description
                Case "SSPLL"
                    Call InsCode("", "SSPLSCR1", 1, 1, Sheet1.Range("D131") * Sheet1.Range("E131")) 'Scrap
                Case "SSPLM"
                    Call InsCode("", "SSPLSCR2", 1, 1, Sheet1.Range("D131") * Sheet1.Range("E131")) 'Scrap
                Case "SSPLH"
                    Call InsCode("", "SSPLSCR3", 1, 1, Sheet1.Range("D131") * Sheet1.Range("E131")) 'Scrap
                Case "SSPLE"
                    Call InsCode("", "SSPLSCR4", 1, 1, Sheet1.Range("D131") * Sheet1.Range("E131")) 'Scrap
                Case "SSPLS"
                    Call InsCode("", "SSPLSCR5", 1, 1, Sheet1.Range("D131") * Sheet1.Range("E131")) 'Scrap
            End Select
        End If
        
        If Sheet1.Range("F131") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSEPLC", 1, 1, Sheet1.Range("D131") * Sheet1.Range("F131")) 'End Plate
        End If
        
        If Sheet1.Range("G131") <> "" Then
        On Error Resume Next
            Call InsCode("", "SSCNB", 1, 1, Sheet1.Range("D131") * Sheet1.Range("G131")) 'Connection Bolts
        End If
    End If
    
    'Roof Cladding
    description = Sheet1.Range("H132")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D132"))
        
        If Sheet1.Range("G132") <> "" Then
        
            If InStr(1, Sheet1.Range("C132").Value, "AZ Steel", vbTextCompare) Then
                Call InsCode("", "CS2", 1, 1, Sheet1.Range("D132") * Sheet1.Range("G132")) 'Connection Bolts/Screws
            End If
            
            If InStr(1, Sheet1.Range("C132").Value, "Aluminum", vbTextCompare) Then
                Call InsCode("", "SS2", 1, 1, Sheet1.Range("D132") * Sheet1.Range("G132")) 'Connection Bolts/Screws
            End If
            
        End If
        
    End If

    'Wall Cladding
    description = Sheet1.Range("H133")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D133"))
        
        If Sheet1.Range("G133") <> "" Then
        
            If InStr(1, Sheet1.Range("C133").Value, "AZ Steel", vbTextCompare) Then
                Call InsCode("", "CS2", 1, 1, Sheet1.Range("D133") * Sheet1.Range("G133")) 'Connection Bolts/Screws
            End If
            
            If InStr(1, Sheet1.Range("C133").Value, "Aluminum", vbTextCompare) Then
                Call InsCode("", "SS2", 1, 1, Sheet1.Range("D133") * Sheet1.Range("G133")) 'Connection Bolts/Screws
            End If
            
        End If
        
    End If
    
    'Manufacturing
    description = Sheet1.Range("H134")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D134"))
    End If
    
    'Surface Preparation
    description = Sheet1.Range("H135")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D135"))
    End If
    
    'Painting
    description = Sheet1.Range("H136")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D136"))
    End If
    
    'Testing
    description = Sheet1.Range("H137")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D137"))
    End If
    
    'Material Handling
    description = Sheet1.Range("H138")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D138"))
    End If
    
    'Project Managment
    description = Sheet1.Range("H139")
    If description <> "" Then
        On Error Resume Next
        Call InsCode("", description, 1, 1, Sheet1.Range("D139"))
    End If
    
'    'Freight
'    description = Sheet1.Range("H142")
'    If description <> "" Then
'        On Error Resume Next
'        Call InsCode("", description, 1, 1, 1) ' Sheet1.Range("D139"))
'    End If
    
    Sheet2.Range("ItemMark").EntireRow.Insert
    Sheet2.Range("ItemMark").Offset(-1, 0) = Sheet2.Range("ItemMark").Offset(-2, 0) + 1
 
    Call RecapInput("StructuralSteel")
    Sheet2.EnableCalculation = True
    Sheet3.EnableCalculation = True
    Sheet4.EnableCalculation = True
    
    'added by hezron(09.19.2011)
    '================================================================================================
    Dim i As Integer
    'Dim desc As String
    i = -2

    While InStr(1, Sheet2.Range("ItemMark").Offset(i, 4).Text, "Structural Steel", vbTextCompare) = 0
        Sheet2.Range("ItemMark").Offset(-1, 10).Value = Sheet2.Range("ItemMark").Offset(-1, 10).Value + Sheet2.Range("ItemMark").Offset(i, 10).Value
        Sheet2.Range("ItemMark").Offset(-1, 17).Value = Sheet2.Range("ItemMark").Offset(-1, 17).Value + Sheet2.Range("ItemMark").Offset(i, 17).Value
        i = i - 1
    Wend

    'Color part of the description
    i = -2
    While InStr(1, Sheet2.Range("ItemMark").Offset(i, 4).Text, "Structural Steel", vbTextCompare) = 0
        i = i - 1
    Wend
    
    Sheet2.Range("ItemMark").Offset(i, 4).Characters(17).Font.Color = RGB(255, 0, 0)
    Sheet2.Range("ItemMark").Offset(i - 1, 4).Font.Color = RGB(255, 0, 0)
    'Sheet2.Range("ItemMark").Offset(i - 1, 17).Font.Color = RGB(255, 0, 0)
'    Sheet2.Range("ItemMark").Offset(i - 1, 10).Font.Color = RGB(255, 0, 0)
'    Sheet2.Range("ItemMark").Offset(i - 1, 17).Font.Color = RGB(255, 0, 0)
    
    Sheet2.Range("ItemMark").Offset(-1, 4).Font.Color = RGB(255, 0, 0)
'    Sheet2.Range("ItemMark").Offset(-1, 10).Font.Color = RGB(255, 0, 0)
'    Sheet2.Range("ItemMark").Offset(-1, 17).Font.Color = RGB(255, 0, 0)
      
    Sheet2.Range("ItemMark").Offset(-1, 4).Value = _
    "Sub Total Unit Price     (" & Round(Sheet2.Range("ItemMark").Offset(-1, 17).Value, 0) & " / " & Round(Sheet2.Range("ItemMark").Offset(-1, 10).Value, 0) & " = " & Round(Sheet2.Range("ItemMark").Offset(-1, 17).Value / Sheet2.Range("ItemMark").Offset(-1, 10).Value, 3) & " AED/kg)"
    
    'delete the subtotals
    Sheet2.Range("ItemMark").Offset(-1, 10).Value = 0
    Sheet2.Range("ItemMark").Offset(-1, 17).Value = 0
    '================================================================================================
ErrHandler:
    If Err.Number = 13 Then
        MsgBox "Please provide some input"
        Sheet1.Activate
        Exit Sub
    End If
        

    
        Sheet1.Activate
    
    'Disable the worksheet change event
    Application.EnableEvents = True
    
    Call QuickEstCalculations.GetPhaseNumberFromMAKDB
    
    Application.Calculation = xlAutomatic
    
End Sub

Private Sub btnClearSSInputs_Click()
    Sheet1.Range("StructuralSteelInput").ClearContents
End Sub

Private Sub btnGeneratePPL_Click()
    If Sheet1.Range("freightDestination").Value <> "" Then
        If Sheet2.Range("AddGeneral") = "CC" Then
            AddGeneralItems = MsgBox("Warning: PPL Items have already been added. " & _
            "Please delete the previous items.", vbOKOnly, "PPL Items") 'Do you want to add them again?", vbYesNo)
            End
        End If
        
'        If AddGeneralItems = vbYes Then
            Call ShippingLoad.ShippingLoad
'            MsgBox "Please remove the duplicate PPL items from the detail sheet.", vbOKOnly, "PPL Items"
'        End If
'        If AddGeneralItems = vbNo Then
'            End
'        End If
    End If
End Sub

Private Sub ComboBox19_Change()
    If Sheet1.Range("AreaDesc").Offset(14, 0).Value = "None" Then
        If Sheet1.Range("AreaDesc").Offset(15, 0).Value = "None" Then
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "None"
        Else
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "Wall"
        End If
    Else
        If Sheet1.Range("AreaDesc").Offset(15, 0).Value = "None" Then
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "Roof Only"
        Else
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "Roof+Wall"
        End If
    End If
End Sub

Private Sub ComboBox20_Change()
     If Sheet1.Range("AreaDesc").Offset(15, 0).Value = "None" Then
        If Sheet1.Range("AreaDesc").Offset(14, 0).Value = "None" Then
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "None"
        Else
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "Roof"
        End If
    Else
        If Sheet1.Range("AreaDesc").Offset(14, 0).Value = "None" Then
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "Wall Only"
        Else
            Sheet1.Range("AreaDesc").Offset(18, 2).Value = "Roof+Wall"
        End If
    End If
End Sub

'added by hezron 07092012
Private Sub ComboBox5_Change()
    If ComboBox5.Text = "M45-150" Then
        Shapes("RoofShtg2").OLEFormat.Object.ListFillRange = "Core150"
        RoofShtg2.ListIndex = 0
        Shapes("ComboBox65").OLEFormat.Object.ListFillRange = "Core150"
        ComboBox65.ListIndex = 0
    Else
        Shapes("RoofShtg2").OLEFormat.Object.ListFillRange = "Core"
        RoofShtg2.ListIndex = 0
        Shapes("ComboBox65").OLEFormat.Object.ListFillRange = "Core"
        ComboBox65.ListIndex = 0
    End If
End Sub

Private Sub ComboBox6_Change()

End Sub

Private Sub ComboBox61_Change()
    'Dim costData As String
    'costData = Range("C48").Text
    'Dim targetCellas As String
    'targetcell = "K" & Sheet7.Range("B578")
    'If Sheet7.Range("A579").Text = "#VALUE!" Then MsgBox "Please Provide Cost Data for this freight. Go to cell " & targetcell & " in MAKDB sheet", vbOKOnly, costData
End Sub

Private Sub ComboBox64_Change()

'    Sheet1.Unprotect ("[PinoY]82465!")
'    Sheet1.Range("J26").Locked = False
    
    Dim panel As String
    panel = Sheet1.Range("C154").Value

    If InStr(1, panel, "Aluminum", vbTextCompare) > 1 Then
        Sheet1.Range("J26").Value = "0.7 AL"
        'cboTrimSizes.Enabled = False
    Else
        If InStr(1, panel, "AZ Steel 0.5", vbTextCompare) > 0 Then
            Sheet1.Range("J26").Value = "0.5 AZ"
'            On Error GoTo ErrHandler:
            'cboTrimSizes.Enabled = True
        Else
            Sheet1.Range("J26").Value = "0.7 AZ"
            'cboTrimSizes.Enabled = True
        End If
    End If
'ErrHandler:
'    If Err.Number = 424 Then
'        ThisWorkbook.Close SaveChanges:=True
'    End If
'
'    Sheet1.Range("J26").Locked = True
'    Sheet1.Protect ("[PinoY]82465!")
    
End Sub

Private Sub ComboBox65_Change()
    
    If ComboBox65.Text = "Single Skin (No Polyurethane)" Then
        ComboBox66.Text = "Single Skin (No Internal Sheeting)"
        'ComboBox66.Enabled = False
    Else
'        On Error GoTo ErrHandler:
'        ComboBox66.Enabled = True 'run time error 424
    End If
    
'ErrHandler:
'    If Err.Number = 424 Then
'        ThisWorkbook.Close SaveChanges:=True
'    End If

End Sub

Private Sub ComboBox66_Change()
    
    If ComboBox66.Text = "Single Skin (No Internal Sheeting)" Then ' Then
        ComboBox65.Text = "Single Skin (No Polyurethane)"
    End If
    
End Sub


Private Sub NewEst_Click()
 Del_All = MsgBox("This action will delete all areas and components in this estimate project. Are you sure you want to delete everything?", 305)
 If Del_All = 1 Then
 'Sheet2.Activate
Sheet2.EnableCalculation = False
Sheet3.EnableCalculation = False
Sheet4.EnableCalculation = False

Sheet7.EnableCalculation = False
 Do Until Sheet2.Range("ItemMark").Name = "=Detail!$A$10"
   Sheet2.Range("ItemMark").Offset(-1, 0).EntireRow.Delete
 Loop
 'Sheet1.Activate
 End If
 Do Until Sheet8.Range("RecapMark").address = "$A$7"
 Sheet8.Range("RecapMark").Offset(-1, 0).EntireRow.Delete
Loop

'    'clear the contents of "RawMat" sheet
'    Worksheets("RawMat").Cells.Clear
'    Range("A1").Select
    
    Worksheets("RawMat").Columns("A:I").Clear
'    Range("A2").Activate
'    Selection.Clear

Sheet4.Range("M121").Value = 0
Sheet2.EnableCalculation = True
Sheet3.EnableCalculation = True
Sheet4.EnableCalculation = True

Sheet7.EnableCalculation = True

Sheet1.Range("A1").Select

End Sub

Private Sub RoofShtg1_Change()
    
    Dim panel As String
    panel = Sheet1.Range("C150").Value
    
    If InStr(1, panel, "Aluminum", vbTextCompare) > 1 Then
        Sheet1.Range("E23").Value = "0.7 AL"
        'cboTrimSizes.Enabled = False
    Else
        If InStr(1, panel, "AZ Steel 0.5", vbTextCompare) > 0 Then
            Sheet1.Range("E23").Value = "0.5 AZ"
'            On Error GoTo ErrHandler:
'            cboTrimSizes.Enabled = True
        Else
            Sheet1.Range("E23").Value = "0.7 AZ"
'            cboTrimSizes.Enabled = True
        End If
    End If
'ErrHandler:
'    If Err.Number = 424 Then
'        ThisWorkbook.Close SaveChanges:=True
'    End If

End Sub

Private Sub RoofShtg2_Change()
    
    If RoofShtg2.Text = "Single Skin (No Polyurethane)" Then
        RoofShtg3.Text = "Single Skin (No Internal Sheeting)"
        'RoofShtg3.Enabled = False
    Else
        'On Error GoTo ErrHandler:
        'RoofShtg3.Enabled = True
    End If
'ErrHandler:
'    If Err.Number = 424 Then
'        ThisWorkbook.Close SaveChanges:=True
'    End If

End Sub

Private Sub RoofShtg3_Change()
    
    If RoofShtg3.Text = "Single Skin (No Internal Sheeting)" Then ' Then
        RoofShtg2.Text = "Single Skin (No Polyurethane)"
    End If
    
End Sub

'Private Sub Worksheet_Change(ByVal Target As Range)
'    On Error GoTo ErrHandler:
'    For Each H In Worksheets(1).Hyperlinks 'run time error 1004
'      A = H.Range.address
'      'Range(a).Hyperlinks.Delete
'      F = H.Range.Formula
'      Range(A).MergeArea.ClearContents
'      Range(A).Formula = F
'      Range(A).Font.Color = Range("AreaDesc").Font.Color
'      Range(A).Font.Underline = Range("AreaDesc").Font.Underline
'      Range(A).Font.Size = Range("AreaDesc").Font.Size
'    Next
'ErrHandler:
'    If Err.Number = 1004 Then
'        ThisWorkbook.Close SaveChanges:=True
'    End If
'End Sub


-------------------------------------------------------------------------------
VBA MACRO Sheet12.cls 
in file: /Users/alishan/LaravelHerd/Maimaar-Estimation-Calculator/documentations/HQ-O-53305-R00 (3).xls - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet12'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub ExportToERP_Click()
On Error GoTo CloseFile
Dim FileName As String
Dim FDate As Date
Dim FYear As Integer, JobBldg As String, ContractDate As String, Job As String, ContractValue As String
Dim erpCode As Long, Qty As Double, Rate As Double, unit As String

'---------------------------------------
Dim Mat_Cost As Double
Dim Prod_Cost As Double
Dim OH_Cost As Double
Dim MQty As String

FileName = Range("H2").Value & "-" & Range("I2").Value & "-" & Range("L2").Value & "Rev" & Range("O4").Value & ".csv"
FileName = "c:\fcpbs\" & FileName

'Checking input conditions
    '1) Job_No
        If Not IsNumeric(Range("I2").Value) Then
            MsgBox "Job Number is not valid, Kindly check your FCPBS.Cell(""I2"")", vbCritical
            Range("I2").Select
            Exit Sub
        End If
    ' Building No
        If Not IsNumeric(Range("L2").Value) Then
            MsgBox "Building Number is not valid, Kindly check your FCPBS.Cell(""L2"")", vbCritical
            Range("L2").Select
            Exit Sub
        End If
    'Estimated Date
        If Not IsDate(Range("O2").Value) Then
            MsgBox "Estimated Date is not valid, Kindly check your FCPBS.Cell(""O2"")", vbCritical
            Range("O2").Select
            Exit Sub
        End If
    
'check filename exists on HDD or not
    If Dir(FileName) <> "" Then
         If MsgBox("This file name: " & FileName & " exists in Folder C:\FCPBS\.... ! Do you want to replace it? ", vbYesNo) = vbNo Then
            Exit Sub
        End If
    End If
    
Open FileName For Output As #1
FDate = CDate(Range("O2"))
FYear = Year(FDate)
A = Month(FDate)
If A < 4 Then FYear = FYear - 1
JobBldg = Left((Right(Range("I2"), 4) & "-" & Range("L2") & "          "), 10)
ContractDate = Format(FDate, "dd-mm-yyyy")
Job = Range("H2").Value & "-" & Range("I2").Value & "    "
Job = Left(Job, 9)
ContractValue = Format(CDbl(Range("ContractValue")), "000000000000.00")

'First Line
'1,Year_No,Job-Building,Date,Jobno,Total_Contract_Price

Print #1, "1,"; Format(FYear, "####"); ","; JobBldg; ","; ContractDate; ","; Job; ","; ContractValue

      'Process Each Line
        For i = 1 To 112
        erpCode = CLng(Range("E7").Offset(i, 0).Value)
        If erpCode > 0 Then
          Qty = CDbl(Range("H7").Offset(i, 0))
           
          If Qty > 0 Then
             Rate = CDbl(Range("Q7").Offset(i, 0))
                
                'added by Do Nguyen
                'add more code
                'Mat_Cost     =   Material Cost
                'Prod_Cost    =   Manufg Cost
                'OH_Cost      =   Overhead Cost
                SQty = Left(CStr(Format(Qty / 1000, "##,##0.000000")) & "                ", 15)
                Mat_Cost = CDbl(Range("J7").Offset(i, 0)) * 1000 / Qty
                Prod_Cost = CDbl(Range("K7").Offset(i, 0)) * 1000 / Qty
                OH_Cost = CDbl(Range("L7").Offset(i, 0)) * 1000 / Qty
                MQty = CStr(Range("G7").Offset(i, 0))
                   
          Else
             Qty = 1
             Rate = CDbl(Range("O7").Offset(i, 0))
                'added by Do Nguyen
                'add more code
                'Mat_Cost     =   Material Cost
                'Prod_Cost    =   Manufg Cost
                'OH_Cost      =   Overhead Cost
                SQty = Left(CStr(Qty) & "                ", 15)
                Mat_Cost = CDbl(Range("J7").Offset(i, 0))
                Prod_Cost = CDbl(Range("K7").Offset(i, 0))
                OH_Cost = CDbl(Range("L7").Offset(i, 0))
                MQty = CStr(Range("G7").Offset(i, 0))
                
          End If
          SRate = Left(CStr(Rate) & "                ", 15)
          SMat_Cost = Left(CStr(Mat_Cost) & "                ", 15)
          SProd_Cost = Left(CStr(Prod_Cost) & "                ", 15)
          SOH_Cost = Left(CStr(OH_Cost) & "                ", 15)
          SMQTY = Left(CStr(MQty) & "                ", 15)
          
          
          'second line
          '2,Year_no,Item_no,Qty,Price,Mat_Cost,Prod_Cost,OH_Cost,MQty
  
  If Rate > 0 Then Print #1, "2,"; Format(FYear, "####"); ","; Format(erpCode, "000000"); ","; SQty; ","; SRate; ","; SMat_Cost; ","; SProd_Cost; ","; SOH_Cost; ","; SMQTY
  
End If
Next i

CloseFile:
If Err Then
  MsgBox (Error(Err))
Else
  MsgBox "Exported to file: " & FileName
End If
Close #1
End Sub

-------------------------------------------------------------------------------
VBA MACRO xlm_macro.txt 
in file: xlm_macro - OLE stream: 'xlm_macro'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' 0085     12 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, hidden -  Mai
' 0085     13 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Inpu
' 0085     13 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Reca
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Detai
' 0085     13 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  FCPB
' 0085     11 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  SA
' 0085     13 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  MBSD
' 0085     12 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  SSD
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  RawMa
' 0085     11 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  JA
' 0085     10 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, hidden -  D
' 0085     11 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  RE
' 0085     11 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  BO

